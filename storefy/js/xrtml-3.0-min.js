try{delete window.xRTML}catch(e){window.xRTML=undefined}(function(a,b){(function(c,f){var d={bind:function(i,h){if(i.bind){i.bind(h)}else{for(var j in h){if(i.addEventListener){i.addEventListener(j,h[j],false)}else{i.attachEvent?i.attachEvent("on"+j,h[j]):i[j]=h[j]}}}},unbind:function(i,h){if(i.unbind){i.unbind(h)}else{for(var j in h){if(i.removeEventListener){i.removeEventListener(j,h[j],false)}else{if(i.detachEvent){i.detachEvent("on"+j,h[j])}else{if(i[j]){delete i[j]}}}}}}},g={bind:function(h){for(var i in h){if(typeof h[i]==="function"){if(!this.listeners[i]){this.listeners[i]=[]}this.listeners[i].push(h[i])}}},unbind:function(k){for(var m in k){if(this.listeners[m] instanceof Array){var l=this.listeners[m];for(var j=0,h=l.length;j<h;j++){if(l[j]===k[m]){l.splice(j,1);break}}}}},fire:function(k){var n;for(var m in k){n={type:m,target:this};for(var j in k[m]){var o=k[m][j];n[j]=o}if(this.listeners[n.type] instanceof Array){var l=new Array();for(var h=0;h<this.listeners[n.type].length;h++){l.push(this.listeners[n.type][h])}for(var h=0;h<l.length;h++){l[h].call(this,n)}}}}};c.bind=d.bind;c.unbind=d.unbind;c.extend=function(i){if(!i.listeners){i.listeners={}}for(var h in g){i[h]=g[h]}}})(a.Event=a.Event||{})})(window.xRTML=window.xRTML||{});(function(a){(function(b,c){b.Event.extend(b);b.version="3.0.0";b.lastestBuild="08-10-2012 10:06:38";b.domLoaded=function(){return(document.readyState=="loaded"||document.readyState=="complete")};b.isReady=false;b.ready=function(d){!b.isReady?b.bind({ready:d}):d()}})(a.xRTML=a.xRTML||{})})(window);(function(a,b){
/*!
    * Sizzle CSS Selector Engine
    *  Copyright 2012, The Dojo Foundation
    *  Released under the MIT, BSD, and GPL Licenses.
    *  More information: http://sizzlejs.com/
    */
(function(q,x){var g,al,H,w,f,l=a.document,p=l.documentElement,an=("sizcache"+Math.random()).replace(".",""),v=0,C=[].slice,ak=[].push,Q="undefined",r=false,n=true,z="(?:[-\\w]|[^\\x00-\\xa0]|\\\\.)",T="[\\x20\\t\\n\\r\\f]",at="([*^$|!~]?={1})",y="(?:-?[#_a-zA-Z]{1}[-\\w]*|[^\\x00-\\xa0]+|\\\\.+)",ae="\\["+T+"*("+z+"+)"+T+"*(?:"+at+T+"*(?:(['\"])(.*?)\\3|("+y+"+)|)|)"+T+"*\\]",au=":("+z+"+)(?:\\(([\"']?)([^()]*|.*)\\2\\))?",V=":(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^\\-]|$)",u=T+"*([\\x20\\t\\n\\r\\f>+~])"+T+"*",i=new RegExp("^"+T+"*,"+T+"*"),Z=new RegExp("^"+u),aq=new RegExp("("+ae.replace("3","4")+"|"+au.replace("2","8")+"|\\\\[>+~]|[^\\x20\\t\\n\\r\\f>+~]|\\\\.)+|"+u,"g"),B=new RegExp("^"+T),ad=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,ah=/^[\x20\t\n\r\f]*[+~][\x20\t\n\r\f]*$/,ao=/:not\($/,m=/(-?)(\d*)(?:n([+\-]?\d*))?/,A=/\D/,J=/h\d/i,af=/input|select|textarea|button/i,I=/^\+|[\x20\t\n\r\f]*/g,N=/\\(?!\\)/g,M=/([^,\\\[\]]+|\[[^\[]*\]|\([^\(]*\)|\\.)+/g,Y={ID:new RegExp("^#("+z+"+)"),CLASS:new RegExp("^\\.("+z+"+)"),NAME:new RegExp("^\\[name=['\"]?("+z+"+)['\"]?\\]"),TAG:new RegExp("^("+z.replace("[-","[-\\*")+"+)"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+au),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+T+"*(even|odd|(?:[+\\-]?\\d+|(?:[+\\-]?\\d*)?n"+T+"*(?:[+\\-]"+T+"*\\d+)?))"+T+"*\\))?","i"),POS:new RegExp(V,"ig"),globalPOS:new RegExp(V,"i")},aj={},K=[],E={},O=[],ap=function(av){av.sizzleFilter=true;return av},h=function(av){return function(aw){return aw.nodeName.toLowerCase()==="input"&&aw.type===av}},L=function(av){return function(ax){var aw=ax.nodeName.toLowerCase();return(aw==="input"||aw==="button")&&ax.type===av}},ab=function(av){var aw=false,ay=l.createElement("div");try{aw=av(ay)}catch(ax){}ay=null;return aw},G=ab(function(aw){aw.innerHTML="<select></select>";var av=typeof aw.lastChild.getAttribute("multiple");return av!=="boolean"&&av!=="string"}),o,d=ab(function(aw){aw.id=an+0;aw.innerHTML="<a name='"+an+"'/><div name='"+an+"'/>";p.insertBefore(aw,p.firstChild);var av=l.getElementsByName&&l.getElementsByName(an).length===2+l.getElementsByName(an+0).length;o=!l.getElementById(an);p.removeChild(aw);return av}),k=ab(function(av){av.appendChild(l.createComment(""));return av.getElementsByTagName("*").length===0}),X=ab(function(av){av.innerHTML="<a href='#'></a>";return av.firstChild&&typeof av.firstChild.getAttribute!==Q&&av.firstChild.getAttribute("href")==="#"}),W=ab(function(av){av.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!av.getElementsByClassName||av.getElementsByClassName("e").length===0){return false}av.lastChild.className="e";return av.getElementsByClassName("e").length!==1});var ag=function(ay,av,aA,aD){aA=aA||[];av=av||l;var aB,aw,aC,ax,az=av.nodeType;if(az!==1&&az!==9){return[]}if(!ay||typeof ay!=="string"){return aA}aC=D(av);if(!aC&&!aD){if((aB=ad.exec(ay))){if((ax=aB[1])){if(az===9){aw=av.getElementById(ax);if(aw&&aw.parentNode){if(aw.id===ax){aA.push(aw);return aA}}else{return aA}}else{if(av.ownerDocument&&(aw=av.ownerDocument.getElementById(ax))&&U(av,aw)&&aw.id===ax){aA.push(aw);return aA}}}else{if(aB[2]){ak.apply(aA,C.call(av.getElementsByTagName(ay),0));return aA}else{if((ax=aB[3])&&W&&av.getElementsByClassName){ak.apply(aA,C.call(av.getElementsByClassName(ax),0));return aA}}}}}return am(ay,av,aA,aD,aC)};var aa=ag.selectors={cacheLength:50,match:Y,order:["ID","TAG"],attrHandle:{},createPseudo:ap,find:{ID:o?function(ay,ax,aw){if(typeof ax.getElementById!==Q&&!aw){var av=ax.getElementById(ay);return av&&av.parentNode?[av]:[]}}:function(ay,ax,aw){if(typeof ax.getElementById!==Q&&!aw){var av=ax.getElementById(ay);return av?av.id===ay||typeof av.getAttributeNode!==Q&&av.getAttributeNode("id").value===ay?[av]:x:[]}},TAG:k?function(av,aw){if(typeof aw.getElementsByTagName!==Q){return aw.getElementsByTagName(av)}}:function(av,az){var ay=az.getElementsByTagName(av);if(av==="*"){var aA,ax=[],aw=0;for(;(aA=ay[aw]);aw++){if(aA.nodeType===1){ax.push(aA)}}ay=ax}return ay}},relative:{">":{dir:"parentNode",firstMatch:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",firstMatch:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(av){av[1]=av[1].replace(N,"");av[3]=(av[4]||av[5]||"").replace(N,"");if(av[2]==="~="){av[3]=" "+av[3]+" "}return av.slice(0,4)},CHILD:function(av){av[1]=av[1].toLowerCase();if(av[1]==="nth"){if(!av[2]){ag.error(av[0])}av[2]=av[2].replace(I,"");var aw=m.exec(av[2]==="even"&&"2n"||av[2]==="odd"&&"2n+1"||!A.test(av[2])&&"0n+"+av[2]||av[2]);av[2]=+(aw[1]+(aw[2]||1));av[3]=+aw[3]}else{if(av[2]){ag.error(av[0])}}return av},PSEUDO:function(av){return Y.CHILD.test(av[0])?null:av}},filter:{ID:o?function(av){av=av.replace(N,"");return function(aw){return aw.getAttribute("id")===av}}:function(av){av=av.replace(N,"");return function(ax){var aw=typeof ax.getAttributeNode!==Q&&ax.getAttributeNode("id");return aw&&aw.value===av}},TAG:function(av){if(av==="*"){return function(){return true}}av=av.replace(N,"").toLowerCase();return function(aw){return aw.nodeName&&aw.nodeName.toLowerCase()===av}},CLASS:function(av){var aw=aj[av];if(!aw){aw=aj[av]=new RegExp("(^|"+T+")"+av+"("+T+"|$)");K.push(av);if(K.length>aa.cacheLength){delete aj[K.shift()]}}return function(ax){return aw.test(ax.className||ax.getAttribute("class")||"")}},ATTR:function(ax,aw,av){if(!aw){return function(ay){return ag.attr(ay,ax)!=null}}return function(az){var ay=ag.attr(az,ax),aA=ay+"";if(ay==null){return aw==="!="}switch(aw){case"=":return aA===av;case"!=":return aA!==av;case"^=":return av&&aA.indexOf(av)===0;case"*=":return av&&aA.indexOf(av)>-1;case"$=":return av&&aA.substr(aA.length-av.length)===av;case"~=":return(" "+aA+" ").indexOf(av)>-1;case"|=":return aA===av||aA.substr(0,av.length+1)===av+"-"}}},CHILD:function(aw,ay,ax){if(aw==="nth"){var av=v++;return function(aC){var az,aD,aB=0,aA=aC;if(ay===1&&ax===0){return true}az=aC.parentNode;if(az&&(az[an]!==av||!aC.sizset)){for(aA=az.firstChild;aA;aA=aA.nextSibling){if(aA.nodeType===1){aA.sizset=++aB;if(aA===aC){break}}}az[an]=av}aD=aC.sizset-ax;if(ay===0){return aD===0}else{return(aD%ay===0&&aD/ay>=0)}}}return function(aA){var az=aA;switch(aw){case"only":case"first":while((az=az.previousSibling)){if(az.nodeType===1){return false}}if(aw==="first"){return true}az=aA;case"last":while((az=az.nextSibling)){if(az.nodeType===1){return false}}return true}}},PSEUDO:function(az,aA,ay,aw,av){var ax=aa.pseudos[az]||aa.pseudos[az.toLowerCase()];if(!ax){ag.error("unsupported pseudo: "+az)}if(!ax.sizzleFilter){return ax}return ax(ay,aw,av)}},pseudos:{not:ap(function(av,ax,aw){var ay=t(av,ax,aw);return function(az){return !ay(az)}}),enabled:function(av){return av.disabled===false},disabled:function(av){return av.disabled===true},checked:function(av){var aw=av.nodeName.toLowerCase();return(aw==="input"&&!!av.checked)||(aw==="option"&&!!av.selected)},selected:function(av){if(av.parentNode){av.parentNode.selectedIndex}return av.selected===true},parent:function(av){return !!av.firstChild},empty:function(av){return !av.firstChild},contains:ap(function(av){return function(aw){return(aw.textContent||aw.innerText||c(aw)).indexOf(av)>-1}}),has:ap(function(av){return function(aw){return !!ag(av,aw).length}}),header:function(av){return J.test(av.nodeName)},text:function(ax){var av=ax.getAttribute("type"),aw=ax.type;return ax.nodeName.toLowerCase()==="input"&&"text"===aw&&(av===null||av.toLowerCase()===aw)},radio:h("radio"),checkbox:h("checkbox"),file:h("file"),password:h("password"),image:h("image"),submit:L("submit"),reset:L("reset"),button:function(aw){var av=aw.nodeName.toLowerCase();return av==="input"&&"button"===aw.type||av==="button"},input:function(av){return af.test(av.nodeName)},focus:function(av){var aw=av.ownerDocument;return av===aw.activeElement&&(!aw.hasFocus||aw.hasFocus())&&!!(av.type||av.href)},active:function(av){return av===av.ownerDocument.activeElement}},setFilters:{first:function(ax,aw,av){return av?ax.slice(1):[ax[0]]},last:function(ay,ax,aw){var av=ay.pop();return aw?ay:[av]},even:function(aA,az,ay){var ax=[],aw=ay?1:0,av=aA.length;for(;aw<av;aw=aw+2){ax.push(aA[aw])}return ax},odd:function(aA,az,ay){var ax=[],aw=ay?0:1,av=aA.length;for(;aw<av;aw=aw+2){ax.push(aA[aw])}return ax},lt:function(ax,aw,av){return av?ax.slice(+aw):ax.slice(0,+aw)},gt:function(ax,aw,av){return av?ax.slice(0,+aw+1):ax.slice(+aw+1)},eq:function(ay,ax,aw){var av=ay.splice(+ax,1);return aw?ay:av}}};aa.setFilters.nth=aa.setFilters.eq;aa.filters=aa.pseudos;if(!X){aa.attrHandle={href:function(av){return av.getAttribute("href",2)},type:function(av){return av.getAttribute("type")}}}if(d){aa.order.push("NAME");aa.find.NAME=function(av,aw){if(typeof aw.getElementsByName!==Q){return aw.getElementsByName(av)}}}if(W){aa.order.splice(1,0,"CLASS");aa.find.CLASS=function(ax,aw,av){if(typeof aw.getElementsByClassName!==Q&&!av){return aw.getElementsByClassName(ax)}}}try{C.call(p.childNodes,0)[0].nodeType}catch(ar){C=function(aw){var ax,av=[];for(;(ax=this[aw]);aw++){av.push(ax)}return av}}var D=ag.isXML=function(av){var aw=av&&(av.ownerDocument||av).documentElement;return aw?aw.nodeName!=="HTML":false};var U=ag.contains=p.compareDocumentPosition?function(aw,av){return !!(aw.compareDocumentPosition(av)&16)}:p.contains?function(aw,av){var ay=aw.nodeType===9?aw.documentElement:aw,ax=av.parentNode;return aw===ax||!!(ax&&ax.nodeType===1&&ay.contains&&ay.contains(ax))}:function(aw,av){while((av=av.parentNode)){if(av===aw){return true}}return false};var c=ag.getText=function(az){var ay,aw="",ax=0,av=az.nodeType;if(av){if(av===1||av===9||av===11){if(typeof az.textContent==="string"){return az.textContent}else{for(az=az.firstChild;az;az=az.nextSibling){aw+=c(az)}}}else{if(av===3||av===4){return az.nodeValue}}}else{for(;(ay=az[ax]);ax++){aw+=c(ay)}}return aw};ag.attr=function(ay,ax){var aw=D(ay);if(!aw){ax=ax.toLowerCase()}if(aa.attrHandle[ax]){return aa.attrHandle[ax](ay)}if(G||aw){return ay.getAttribute(ax)}var av=(ay.attributes||{})[ax];return av?typeof ay[ax]==="boolean"?ay[ax]?ax:null:av.specified?av.value:null:null};ag.error=function(av){throw new Error("Syntax error, unrecognized expression: "+av)};[0,0].sort(function(){return(n=0)});if(p.compareDocumentPosition){w=function(aw,av){if(aw===av){r=true;return 0}return(!aw.compareDocumentPosition||!av.compareDocumentPosition?aw.compareDocumentPosition:aw.compareDocumentPosition(av)&4)?-1:1}}else{w=function(aD,aC){if(aD===aC){r=true;return 0}else{if(aD.sourceIndex&&aC.sourceIndex){return aD.sourceIndex-aC.sourceIndex}}var aA,aw,ax=[],av=[],az=aD.parentNode,aB=aC.parentNode,aE=az;if(az===aB){return f(aD,aC)}else{if(!az){return -1}else{if(!aB){return 1}}}while(aE){ax.unshift(aE);aE=aE.parentNode}aE=aB;while(aE){av.unshift(aE);aE=aE.parentNode}aA=ax.length;aw=av.length;for(var ay=0;ay<aA&&ay<aw;ay++){if(ax[ay]!==av[ay]){return f(ax[ay],av[ay])}}return ay===aA?f(aD,av[ay],-1):f(ax[ay],aC,1)};f=function(aw,av,ax){if(aw===av){return ax}var ay=aw.nextSibling;while(ay){if(ay===av){return -1}ay=ay.nextSibling}return 1}}ag.uniqueSort=function(aw){var ax,av=1;if(w){r=n;aw.sort(w);if(r){for(;(ax=aw[av]);av++){if(ax===aw[av-1]){aw.splice(av--,1)}}}}return aw};function F(aw,aA,az,ax){for(var ay=0,av=aA.length;ay<av;ay++){ag(aw,aA[ay],az,ax)}}function ac(av,ax,aB,aC,aw,aA){var ay=[],az=aa.setFilters[ax.toLowerCase()];if(!az){ag.error(ax)}if(av){F(av,aC,ay,aw)}else{ay=aw}return ay.length?az(ay,aB,aA):[]}function ai(aF,av,aD,ax){var aA,aw,az,aL,aC,aJ,aE,aI,aK=aF.match(M),aG=0,aH=aK.length,ay=Y.POS,aB=new RegExp("^"+Y.POS.source+"(?!"+T+")","i"),aM=function(){for(var aO=1,aN=arguments.length-2;aO<aN;aO++){if(arguments[aO]===x){aA[aO]=x}}};for(;aG<aH;aG++){ay.exec("");aF=aK[aG].replace(B,"");aL=[];az=0;aC=ax||null;while((aA=ay.exec(aF))){aI=aA.index+aA[0].length;if(aI>az){aE=aF.slice(az,aA.index);if(aA.length>1){aA[0].replace(aB,aM)}az=aI;aJ=[av];if((aw=ao.test(aE))){aE=aE.replace(ao,"").replace(Z,"$&*")}if(Z.test(aE)){aJ=aC||[av];aC=ax}aC=ac(aE,aA[1],aA[2],aJ,aC,aw)}if(ay.lastIndex===aA.index){ay.lastIndex++}}if(aC){aL=aL.concat(aC);if((aE=aF.slice(az))&&aE!==")"){F(aE,aL,aD,ax)}else{ak.apply(aD,aL)}}else{ag(aF,av,aD,ax)}}return aH===1?aD:ag.uniqueSort(aD)}(function(){var av,aw,ay,ax=function(aB,aA,az){if((aw=aB.exec(av))&&(!aA||!aa.preFilter[aA]||(aw=aa.preFilter[aA](aw,az)))){av=av.slice(aw[0].length)}return aw};g=function(aB,aE,aC){av=aB;ay=[];var aF,aA,aD=!aC&&aE!==l,az=[ay];if(aD){av=" "+av}while(av){aA=false;if(ax(i)){az.push(ay=[]);if(aD){av=" "+av}}if(ax(Z)){ay.push({part:aw.pop(),captures:aw});aA=true}for(aF in aa.filter){if(ax(Y[aF],aF,aC)){aw.shift();ay.push({part:aF,captures:aw});aA=true}}if(!aA){ag.error(aB)}}return az}})();function R(aA,az,ay){var aw=az.dir,av=az.firstMatch,ax=v++;if(!aA){aA=function(aB){return aB===ay}}return av?function(aC,aB){while((aC=aC[aw])){if(aC.nodeType===1){return aA(aC,aB)?aC:false}}}:function(aD,aC){var aB,aE=ax+"."+H,aF=aE+"."+al;while((aD=aD[aw])){if(aD.nodeType===1){if((aB=aD[an])===aF){return false}else{if(typeof aB==="string"&&aB.indexOf(aE)===0){if(aD.sizset){return aD}}else{aD[an]=aF;if(aA(aD,aC)){aD.sizset=true;return aD}aD.sizset=false}}}}}}function P(av,aw){return av?function(az,ay){var ax=aw(az,ay);return ax&&av(ax===true?az:ax,ay)}:aw}function S(aA,ay,av){var ax,az,aw=0;for(;(ax=aA[aw]);aw++){if(aa.relative[ax.part]){az=R(az,aa.relative[ax.part],ay)}else{ax.captures.push(ay,av);az=P(az,aa.filter[ax.part].apply(null,ax.captures))}}return az}function j(av){return function(ay,ax){var az,aw=0;for(;(az=av[aw]);aw++){if(az(ay,ax)){return true}}return false}}var t=ag.compile=function(av,ay,aw){var aB,aA,ax,az=E[av];if(az&&az.context===ay){az.dirruns++;return az}aA=g(av,ay,aw);for(ax=0;(aB=aA[ax]);ax++){aA[ax]=S(aB,ay,aw)}az=E[av]=j(aA);az.context=ay;az.runs=az.dirruns=0;O.push(av);if(O.length>aa.cacheLength){delete E[O.shift()]}return az};ag.matches=function(aw,av){return ag(aw,null,null,av)};ag.matchesSelector=function(av,aw){return ag(aw,null,null,[av]).length>0};var am=function(aI,aw,aH,az,ay){var aE,av,aJ,aK,aL,aB,aM,ax,aC,aG,aA,aD=(aC=aI.match(M))&&aC.length===1,aF=aI.match(aq),aN=aw.nodeType;if(Y.POS.test(aI)){return ai(aI,aw,aH,az)}if(!az&&aD&&aF.length>1&&aN===9&&!ay&&(aC=Y.ID.exec(aF[0]))){aw=aa.find.ID(aC[1],aw,ay)[0];aI=aI.slice(aF.shift().length)}if(aw){if(az){aE=C.call(az,0)}else{if(aD){aG=(aF.length>=1&&ah.test(aF[0])&&aw.parentNode)||aw;aA=aF.pop().split(":not");aB=aA[0];for(aJ=0,aK=aa.order.length;aJ<aK;aJ++){ax=aa.order[aJ];if((aC=Y[ax].exec(aB))){aE=aa.find[ax]((aC[1]||"").replace(N,""),aG,ay);if(aE!=null){break}}}if(aE&&!aA[1]){aM=aI.length-aB.length;aI=aI.slice(0,aM)+aI.slice(aM).replace(Y[ax],"");if(!aI){ak.apply(aH,C.call(aE,0));return aH}}}if(!aE){aE=aa.find.TAG("*",aw)}}if(aI&&(av=t(aI,aw,ay))){H=av.dirruns;for(aJ=0;(aL=aE[aJ]);aJ++){al=av.runs++;if(av(aL,aw)){aH.push(aL)}}}}return aH};if(l.querySelectorAll){(function(){var aA,aB=am,aD=/[^\\],/g,ay=/^[\x20\t\n\r\f]*[+~]/,aw=/'/g,az=/\=[\x20\t\n\r\f]*([^'"\]]*)[\x20\t\n\r\f]*\]/g,av=[],aC=[":active"],ax=p.matchesSelector||p.mozMatchesSelector||p.webkitMatchesSelector||p.oMatchesSelector||p.msMatchesSelector;ab(function(aE){aE.innerHTML="<select><option selected></option></select>";if(!aE.querySelectorAll("[selected]").length){av.push("\\["+T+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!aE.querySelectorAll(":checked").length){av.push(":checked")}});ab(function(aE){aE.innerHTML="<p test=''></p>";if(aE.querySelectorAll("[test^='']").length){av.push("[*^$]="+T+"*(?:\"\"|'')")}aE.innerHTML="<input type='hidden'>";if(!aE.querySelectorAll(":enabled").length){av.push(":enabled",":disabled")}});av=av.length&&new RegExp(av.join("|"));am=function(aJ,aF,aL,aN,aM){if(!aN&&!aM&&(!av||!av.test(aJ))){if(aF.nodeType===9){try{ak.apply(aL,C.call(aF.querySelectorAll(aJ),0));return aL}catch(aI){}}else{if(aF.nodeType===1&&aF.nodeName.toLowerCase()!=="object"){var aK,aG=aF,aH=aF.getAttribute("id"),aE=aH||an,aP=aF.parentNode,aO=ay.test(aJ);if(aH){aE=aE.replace(aw,"\\$&")}else{aF.setAttribute("id",aE)}if(aO&&aP){aF=aP}try{if(aF){aE="[id='"+aE+"'] ";aK=aE+aJ.replace(aD,"$&"+aE);ak.apply(aL,C.call(aF.querySelectorAll(aK),0));return aL}}catch(aI){}finally{if(!aH){aG.removeAttribute("id")}}}}}return aB(aJ,aF,aL,aN,aM)};if(ax){ab(function(aF){aA=ax.call(aF,"div");try{ax.call(aF,"[test!='']:sizzle");aC.push(aa.match.PSEUDO)}catch(aE){}});aC=new RegExp(aC.join("|"));ag.matchesSelector=function(aF,aH){aH=aH.replace(az,"='$1']");if(!D(aF)&&!aC.test(aH)&&(!av||!av.test(aH))){try{var aE=ax.call(aF,aH);if(aE||aA||aF.document&&aF.document.nodeType!==11){return aE}}catch(aG){}}return ag(aH,null,null,[aF]).length>0}}})()}q.Sizzle=ag})(a.xRTML=a.xRTML||{})})(window);(function(xRTML,undefined){(function(JSON,undefined){(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}())})(xRTML.JSON=xRTML.JSON||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(k,j){var d="xrtml:",g=function(p){var n=p.getElementsByTagName(d+"connection"),m=[];for(var l=0;l<n.length;++l){if(n[l].getAttribute("version")===a.version){var o=n[l];m.push({name:"Connection",id:o.getAttribute("id"),active:o.getAttribute("active"),sendretries:o.getAttribute("sendretries"),sendinterval:o.getAttribute("sendinterval"),url:o.getAttribute("url"),iscluster:o.getAttribute("iscluster"),servertype:o.getAttribute("servertype"),timeout:o.getAttribute("timeout"),connectattempts:o.getAttribute("connectattempts"),metadata:o.getAttribute("metadata"),appkey:o.getAttribute("appkey"),authtoken:o.getAttribute("authtoken"),announcementsubchannel:o.getAttribute("announcementsubchannel"),channels:(function(){var r=!window.attachEvent?document.getElementsByTagName(d+"channels")[0].children:document.getElementsByTagName(d+"channel"),q=[];for(var u=0;u<r.length;++u){var t=r[u];q.push({name:t.getAttribute("name"),subscribeOnReconnect:t.getAttribute("subscribeonreconnect")?t.getAttribute("subscribeonreconnect"):true,subscribe:t.getAttribute("subscribe")?t.getAttribute("subscribe"):true,onMessage:t.getAttribute("onmessage")?new Function("event","return "+t.getAttribute("onmessage")+"(event);"):null,onSubscribe:t.getAttribute("onsubscribe")?new Function("event","return "+t.getAttribute("onsubscribe")+"(event);"):null,messageAdapter:t.getAttribute("messageadapter")?new Function("message","return "+t.getAttribute("messageadapter")+"(message);"):null})}return q})(),oncreate:o.getAttribute("oncreate")?new Function("event","return "+o.getAttribute("oncreate")+"(event);"):null,onconnect:o.getAttribute("onconnect")?new Function("event","return "+o.getAttribute("onconnect")+"(event);"):null,ondisconnect:o.getAttribute("ondisconnect")?new Function("event","return "+o.getAttribute("ondisconnect")+"(event);"):null,onsubscribe:o.getAttribute("onsubscribe")?new Function("event","channel","return "+o.getAttribute("onsubscribe")+"(event);"):null,onunsubscribe:o.getAttribute("onunsubscribe")?new Function("event","channel","return "+o.getAttribute("onunsubscribe")+"(event);"):null,onexception:o.getAttribute("onexception")?new Function("event","event","return "+o.getAttribute("onexception")+"(event);"):null,onreconnect:o.getAttribute("onreconnect")?new Function("event","return "+o.getAttribute("onreconnect")+"(event);"):null,onreconnecting:o.getAttribute("onreconnecting")?new Function("event","return "+o.getAttribute("onreconnecting")+"(event);"):null,onmessage:o.getAttribute("onmessage")?new Function("event","return "+o.getAttribute("onmessage")+"(event);"):null,messageadapter:o.getAttribute("messageadapter")?new Function("message","return "+o.getAttribute("messageadapter")+"(message);"):null});n[l].parentNode.removeChild(n[l--])}}return m},c=function(q){var o=q.getElementsByTagName(d+"storage"),m=[];for(var n=0,l=o.length;n<l;n++){if(o[n].getAttribute("version")===a.version){var p=o[n];m.push({id:p.getAttribute("id"),baseurl:p.getAttribute("baseurl"),type:p.getAttribute("type"),connectionid:p.getAttribute("connectionid"),sessionid:p.getAttribute("sessionid"),onready:p.getAttribute("onready")?new Function("event","return "+p.getAttribute("onready")+"(event);"):null,onsession:p.getAttribute("onsession")?new Function("event","return "+p.getAttribute("onsession")+"(event);"):null,onexception:p.getAttribute("onexception")?new Function("event","event","return "+p.getAttribute("onexception")+"(event);"):null});document.getElementsByTagName(d+"storages")[0].removeChild(o[n--])}}return m},f=function(){var l=document,m=document.getElementsByTagName(d+"config");if(m.length==0){return null}if(m.length==1){m=m[0];l=window.attachEvent?document:m}else{throw"xRTML requires a configuration tag per page."}return{debug:a.Common.Converter.toBoolean(m.getAttribute("debug")),logLevel:m.getAttribute("loglevel"),xrtmlActive:a.Common.Converter.toBoolean(m.getAttribute("xrtmlactive")),throwErrors:a.Common.Converter.toBoolean(m.getAttribute("throwerrors")),connectionAttempts:a.Common.Converter.toNumber(m.getAttribute("connectionattempts")),connectionTimeout:a.Common.Converter.toNumber(m.getAttribute("connectiontimeout")),remoteTrace:a.Common.Converter.toBoolean(m.getAttribute("remotetrace")),ortcUrl:m.getAttribute("ortcurl"),ortcLibrary:m.getAttribute("ortclibrary"),connections:g(l),storages:c(l)}},i=function(p,n){var o,r;if(p.attributes){for(var m=0;m<p.attributes.length;++m){o=p.attributes[m];if(o.specified){this[o.nodeName.toLowerCase()]=o.nodeValue}}}if(p.children.length!=0){for(var l=0;l<p.children.length;++l){r=p.children[l],childName=window.addEventListener?r.nodeName.split(":")[1].toLowerCase():r.nodeName.toLowerCase();if(childName==="template"){this[childName]="";if(window.addEventListener){for(var q=0;q<r.childNodes.length;++q){if(r.childNodes[q].nodeType==Node.COMMENT_NODE){this[childName]+=r.childNodes[q].nodeValue}}}else{this[childName]=r.childNodes[0].nodeValue}this[childName]=this[childName].trim();continue}if(!n){this[childName]=[];new i(r,this[childName])}else{n.push(new i(r));if(r.children){new i(r,n)}}}}},h=function(){var q,n=[],l=a.TagManager.getClasses();for(var m=0;m<l.length;++m){q=document.getElementsByTagName(d+l[m]);for(var o=0;o<q.length;++o){if(!window.addEventListener&&q[o].scopeName.toLowerCase()!="xrtml"){continue}if(q[o].getAttribute("version")===a.version){var p=new i(q[o]);p.name=l[m];n.push(p);document.body.removeChild(q[o--])}}}return n};a.Event.extend(k);k.read=function(){var m;try{m=f()}catch(n){}if(m){this.fire({configLoad:{config:m}})}var l=h();if(l.length!=0){this.fire({tagsLoad:{tags:l}})}}})(a.DomParser=a.DomParser||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(d,g){var c=false,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;d.extend=function(l){var k=this.prototype;c=true;var j=new this();c=false;for(var i in l){j[i]=typeof l[i]=="function"&&typeof k[i]=="function"&&f.test(l[i])?(function(m,n){return function(){var p=this._super;this._super=k[m];var o=n.apply(this,arguments);this._super=p;return o}})(i,l[i]):l[i]}function h(){if(!c&&this.init){this.init.apply(this,arguments)}}h.prototype=j;h.prototype.constructor=h;h.extend=arguments.callee;return h}})(a.Class=a.Class||function(){})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,f){var d=(function(){if(typeof console!=="undefined"){return console}var g={id:null,buffer:[],style:"width: 100%; height: 40%; position: absolute; bottom:5px; left:5px; background: silver; padding: 5px; overflow: scroll;font-family:consolas,monospace;font-size:12px; ",printObject:function(i){var h="";for(property in i){h+=property+": "+i[property]+"; \n"}return h},newLine:function(i,h){var j=document.createElement("p");j.style.color=h;j.innerHTML=i;g.id?document.getElementById(g.id).appendChild(j):g.buffer.push(j)},log:function(h){g.newLine(h,"black")},warn:function(h){g.newLine(h,"orange")},error:function(h){g.newLine(h,"red")},debug:function(h){g.newLine(h,"green")},init:function(){g.id="xRTML_Console_"+a.Common.Util.idGenerator();var j=document.createElement("div");j.id=g.id;j.style.cssText=g.style;for(var k=0,h=g.buffer.length;k<h;k++){j.appendChild(g.buffer[k])}buffer=[];document.body.appendChild(j);j.style.display=a.Config.debug?"block":"none";if(a.Config.debug){document.body.appendChild(j)}}};return g})();if(!window.addEventListener&&typeof console=="undefined"&&a.Config.debug){c=d.init()}c.log=function(g){d.log(g)},c.warn=function(g){d.warn(g)},c.error=function(g){d.error(g);if(a.Config.remoteTrace===true){this.fire({error:{error:g}})}},c.debug=function(g){if(a.Config.debug===true){d.log(g)}};a.Event.extend(c)})(a.Console=a.Console||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,f){var d="";a.Event.extend(c);c.logLevels={error:0,warn:1,info:2};c.debug=false;c.logLevel=2;c.throwErrors=false;c.connectionAttempts=5;c.connectionTimeout=10000;c.remoteTrace=false;c.ortcLibrary=function(g,h){if(arguments.length!=0){d=g;a.Common.DOM.loadScript({url:g,callback:h})}return d};a.DomParser.bind({configLoad:function(j){var g=j.config;for(var h=0;h<g.connections.length;++h){a.ConnectionManager.create(g.connections[h])}for(var h=0;h<g.storages.length;++h){a.StorageManager.create(g.storages[h])}}})})(a.Config=a.Config||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(d,f){var c={uiEffects:{blind:true,bounce:true,clip:true,drop:true,explode:true,fade:true,fold:true,highlight:true,puff:true,pulsate:true,scale:true,shake:true,size:true,slide:true,transfer:true},cssPropsMapping:{"padding-top":"paddingTop"},checkIfEffectFunctionAvailable:function(h){var i=(jQuery&&jQuery.fn&&((typeof jQuery.fn[h]).toLowerCase()=="function"))||(jQuery&&jQuery.effects&&((typeof jQuery.effects[h]).toLowerCase()=="function"));if(!i){a.Error.raise({code:a.Error.Codes.MISSING_LIBRARY,info:{library:"jQuery",module:h,className:"xRTML.Effect.Manager (internal class, no docs available)",methodName:"checkIfEffectFunctionAvailable (internal method, no docs available)"}})}},callJQueryEffect:function(h){a.Console.debug("jQuery effect: Running "+h.effectName+" on element "+h.element.id+" with options "+a.JSON.stringify(h.effectOptions)+" and properties: "+JSON.stringify(h.effectProperties));this.checkIfEffectFunctionAvailable(h.effectName);try{if(this.uiEffects[h.effectName]){jQuery.fn.effect.call(jQuery(h.element),h.effectName,h.effectOptions,h.effectSpeed,h.effectCallback)}else{jQuery.fn[h.effectName].call(jQuery(h.element),h.effectProperties,h.effectOptions)}}catch(i){a.Error.raise({code:a.Error.Codes.UNEXPECTED,info:{message:i.message,className:"xRTML.Effect.Manager (internal class, no docs available)",methodName:"callJQueryEffect (internal method, no docs available)"}})}},buildReverseEffectProperties:function(i){var h={};for(var k in i.properties){var j=a.Common.Object.insensitiveGetter(i.element.style,k.replace("-",""));if(!j||j==""){j=a.Common.DOM.getStyle({element:i.element,rule:k})}h[k]=j}return h},cloneJQueryOptions:function(h){var i={};for(prop in h){i[prop]=h[prop]}return i}},g={runEffects:function(j){if(this.effects){if(typeof j.stopCurrent=="undefined"||j.stopCurrent){c.checkIfEffectFunctionAvailable("animate");jQuery(j.element).stop(false,true)}for(var l=0;l<this.effects.length;l++){try{var h=c.cloneJQueryOptions(typeof this.effects[l].options=="object"?this.effects[l].options:a.JSON.parse(this.effects[l].options)),k=typeof this.effects[l].properties=="object"?this.effects[l].properties:a.JSON.parse(this.effects[l].properties),n=c.buildReverseEffectProperties({properties:k,element:j.element})}catch(m){a.Error.raise({code:a.Error.Codes.JSON_PARSE,info:{message:m.message,className:"xRTML.Effect.Provider (internal class, no docs available)",methodName:"runEffects"}})}c.callJQueryEffect({element:j.element,effectName:this.effects[l].name,effectOptions:h,effectProperties:k,effectSpeed:this.effects[l].speed,effectCallback:this.effects[l].callback?(typeof this.effects[l].callback=="function"?this.effects[l].callback:new Function("","return "+this.effects[l].callback+"();")):null,revert:this.effects[l].revert});if(this.effects[l].revert){c.callJQueryEffect({element:j.element,effectName:this.effects[l].name,effectOptions:h,effectProperties:n,effectSpeed:this.effects[l].speed,effectCallback:null,revert:false})}}}}};d.extend=function(i){for(var h in g){i[h]=g[h]}}})(a.Effect=a.Effect||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(f,d){a.Event.extend(f);f.raise=function(h){h.arguments=a.Common.Object.clone({source:arguments.callee.caller.arguments,depth:5});var g=new f.XRTMLError(h);if(new window.Error().stack){a.Console.error(g)}else{c(g)}return g};f.XRTMLError=function(g){var h=!!g.code?g.code:a.Error.Codes.UNEXPECTED;this.name=h.type;var i=!!g.info?g.info:{};i.className=!!i.className?i.className:(!!g.target?(!!g.target.name?g.target.name:Object.prototype.toString.call(g.target)):"Unknown");i.id=!!i.id?i.id:(!!g.target?g.target.id:"Unknown");i.message=!!i.message?i.message:g.message;i.arguments=g.arguments;this.message=a.Common.String.template(h.message,i);this.type=h.type;this.target=g.target;this.info=i;f.fire({exception:{error:this}})};f.XRTMLError.prototype=window.Error.prototype;f.XRTMLError.prototype.constructor=f.XRTMLError;f.Codes={MANDATORY_PROPERTY:{type:"ValidationError",message:"The property {property} is required for a {className} with the id {id}."},INVALID_PROPERTY:{type:"ValidationError",message:"The property {property} of a {className} with the id {id} has the wrong type. The appropriate type would be {validType}."},CONNECTION_INACTIVE:{type:"ConnectionError",message:"Tried to perform an operation on Connection {id} which is not active."},CONNECTION_EXCEPTION:{type:"ConnectionError",message:"An unexpected problem occured on the Connection {id}. {message}"},CONNECTION_NOT_FOUND:{type:"ConnectionError",message:"Unable to find a Connection with the specified id: {id}."},CONNECTION_PROCESS:{type:"ConnectionError",message:"An error ocurred while processing the message {xRTMLMessage} arrived at Connection {id}. {message}"},CONNECTION_ADAPT:{type:"ConnectionError",message:"An error ocurred while adapting the message {originalMessage} arrived at Connection {id}. {message}"},ORTC_NOT_FOUND:{type:"ORTCError",message:"Unable to obtain the ORTC library from the address specified."},ORTC_UNAVAILABLE:{type:"ORTCError",message:"Connection {id}: ORTC client is not created yet."},ORTC_DISCONNECTED:{type:"ORTCError",message:"Connection {id}: Disconnect not possible. ORTC client is not connected."},ORTC_EXCEPTION:{type:"ORTCError",message:"An unexpected problem occured on the Connection {id}. {message}"},TAG_NOT_CREATED:{type:"TagError",message:"A problem occured while trying to create a {className} Tag with id {id}. {message}"},TAG_INACTIVE:{type:"TagError",message:"Tried to perform an action on a {className} with {id} which is not active."},TAG_UNREGISTERED:{type:"TagError",message:"The specified Tag does not exist in the registered tags namespace."},TAG_INVALID_CONFIG:{type:"TagError",message:"Unable to register a Tag with the specified configuration. {message}"},TAG_ABSTRACT:{type:"TagError",message:"The specified tag {tag} should not be instantiated."},TAG_ACTION_UNDEFINED:{type:"TagError",message:"Tried to perform an action {action} which is not defined on a {className} with id {id}."},TAG_NOT_FOUND:{type:"TagError",message:"Unable to find a Tag with the specified id: {id}."},TAG_PROCESS:{type:"TagError",message:"An error ocurred while processing the arrived message on a {className} with id {id}. {message}"},INVALID_MESSAGE:{type:"MessageError",message:"Tried to create a message with invalid properties. {message}"},TRIGGER_UNREGISTERED:{type:"MessageError",message:"A message arrived containing a trigger which is not registered by any Tag."},STORAGE_CONNECTION_UNAVAILABLE:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} could not find a connection with connectionId: {connectionId}"},STORAGE_UNAVAILABLE:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} is not available."},STORAGE_SESSION:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} was not able to get a session. {message}"},STORAGE_ACTION_UNDEFINED:{type:"StorageError",message:"Tried to perform an action which is not defined on a {className} with id {id}."},STORAGE_PERMISSIONS:{type:"StorageError",message:"Tried to perform an action for which the {className} with id {id} does not have the necessary permissions. Were the right channel permissions set on the server-side?"},STORAGE_OPERATION_TIMEOUT:{type:"StorageError",message:"The Storage operation with the id: {opId} was not completed whithin the expected timeout: {timeout}"},STORAGE_CALLBACK_FAILURE:{type:"StorageError",message:"The Storage operation with the id: {opId} callback has failed. {message}"},REQUEST_FAILURE:{type:"RequestError",message:"An error occured while calling the specified address. {message}"},REQUEST_UNAVAILABLE:{type:"RequestError",message:"Unable to obtain a response from the specified address."},REQUEST_UNSUPPORTED:{type:"RequestError",message:"This browser does not support XMLHttpRequest neither XDomainRequest."},JSON_PARSE:{type:"ParseError",message:"Unable to parse the specified String according to JSON specification rules. {message}"},DOM_PARSE:{type:"ParseError",message:"Unable to parse an XRTML DOM Node. "},MISSING_ARGUMENT:{type:"MethodError",message:"A method {methodName} was called but the required argument {argument} was undefined."},INVALID_ARGUMENT:{type:"MethodError",message:"The method {methodName} was called but the argument {argument} was of an invalid type. The expected type was {expectedType}"},UNEXPECTED:{type:"UnexpectedError",message:"An unexpected error occured. Cause error message is: {message}"},FATAL:{type:"FatalError",message:"A critical error occured. The error message is: {message}"},INVALID_DOM_ATTRIBUTE:{type:"InvalidDomAttribute",message:"An error occured when trying to retrive an unexisting attribute: {attribute}"},TEMPLATING:{type:"TemplateError",message:"An error occured when trying to apply bindings to a template. The cause is: {message}"},TEMPLATING_EFFECTS:{type:"TemplateError",message:"An error occured when trying to run effects binded in a template. Are the effects configured in the tag? The error cause is: {message}"},UNEXPECTEDMEDIA:{type:"UnexpectedMediaError",message:"An error occurred when trying to operate on media. The cause is: {message}"},UNEXPECTEDEVENT:{type:"UnexpectedEventError",message:'An error occurred when trying to process the "{eventType}" event handler. The cause is: {message}'},MISSING_LIBRARY:{type:"MissingLibrary",message:"A required library {library} {module} is not available. Please import this library."}};var c=function(i){var g=[];g.push(i.name+": "+i.message+"\n");function h(l,o,p,q){var j=[];for(var n=0;n<p;n++){j.push(" ")}var k=j.join("");if(q<9){for(var m in l){if(l.hasOwnProperty(m)&&m!="name"&&m!="message"){if(typeof l[m]==="string"||typeof l[m]==="number"||typeof l[m]==="boolean"){o.push((k+m+": "+l[m])+"\n")}else{if(a.Common.Object.isObject(l[m])){o.push(k+m+": \n");h(l[m],o,p+4,q+1)}else{if(a.Common.Array.isArray(l[m])){o.push(k+m+": \n");for(var n=0;n<l[m].length;n++){h(l[m],o,p+4,q+1)}}}}}}}else{o.push(k+l.toString()+"\n")}}h(i,g,0,1);a.Console.error(g.join(""))}})(a.Error=a.Error||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.forEach=function(j,l){for(var k=0,h=j.length;k<h;k++){l(j[k],k)}};f.indexOf=function(l){var h=l.items;for(var m=(l.start||0),k=h.length;m<k;m++){if(a.Common.Object.equals({o1:h[m],o2:l.obj})){return m}}return -1};f.someIndex=function(l){var h=l.items;for(var m=(l.start||0),k=h.length;m<k;m++){if(m in l.items&&l.fn.call(l.items,l.items[m],m,l.items)){return m}}return -1};f.remove=function(i){var h=i.items,l=i.from,k=i.to,j=h.slice((k||l)+1||h.length);h.length=l<0?h.length+l:l;h.push.apply(h,j);return h};f.contains=function(k){var j=k.items;for(var l=0,h=j.length;l<h;l++){if(a.Common.Object.equals({o1:j[l],o2:k.obj})){return true}}return false};f.some=function(j){var h=j.items.length;for(var k=0;k<h;k++){if(k in j.items&&j.fn.call(j.items,j.items[k],k,j.items)){return true}}return false};f.removeObj=function(i){if(a.Common.Array.contains(i)){var h=a.Common.Array.indexOf(i);i.items.splice(h,1)}return i.items};f.isArray=function(h){return Object.prototype.toString.call(h)==="[object Array]"}})(a.Common.Array=a.Common.Array||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.equals=function(h){return a.JSON.stringify(h.o1)===a.JSON.stringify(h.o2)};f.clone=function(h){var j={};if(typeof(h.source)=="object"&&(!h.depth||typeof(h.currentDepth)=="undefined"||h.currentDepth<h.depth)){for(var i in h.source){if((typeof(h.source[i])=="object")){j[i]=f.clone({source:h.source[i],depth:h.depth,currentDepth:h.currentDepth?(h.currentDepth++):1})}else{j[i]=h.source[i]}}}return j};f.isObject=function(h){return""+h=="[object Object]"};f.insensitiveGetter=function(i,j){for(var h in i){if(i.hasOwnProperty(h)&&j==(h+"").toLowerCase()){return i[h];break}}}})(a.Common.Object=a.Common.Object||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.trim=function(h){if(typeof window.String.prototype.trim=="function"){return h.trim()}return h.replace(/^\s*/,"").replace(/\s*$/,"")};f.regexIndexOf=function(h){var i=h.text.substring(h.startpos||0).search(h.regex);return(i>=0)?(i+(h.startpos||0)):i};f.replaceAll=function(h){while((typeof h.text=="string")&&(h.text.indexOf(h.token)!=-1)){h.text=h.text.replace(h.token,h.newtoken)}return h.text};f.regexReplaceAll=function(h){while((typeof h.text=="string")&&(this.regexIndexOf(h)!=-1)){h.text=h.text.replace(h.regex,h.newtoken)}return h.text};f.template=function(j,h){for(var k in h){var i=new RegExp("\\{"+k+"\\}","gm");j=j.replace(i,h[k])}return j};f.format=function(m,j){for(var k=0,h=j.length;k<h;k++){var l=new RegExp("\\{"+k+"\\}","gm");m=m.replace(l,j[k])}return m}})(a.Common.String=a.Common.String||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.browser=function(){var l=window.navigator.userAgent.toLowerCase();var j=["msie","firefox","chrome","safari","gecko"],m=["ie","mozilla","mozilla","safari","mozilla"],h;for(var k=0;k<j.length;k++){if(l.indexOf(j[k])>=0){h=m[k];break}}return h};f.getText=function(h){if(h){if(h.innerText){return h.innerText}if(h.innerHTML){return h.innerHTML}if(h.nextSibling){return h.nextSibling.data}}return""};f.setText=function(h,i){if(h){h.innerHTML=i;h.innerText=i}};f.loadScript=function(i){var h=document.createElement("script");h.type="text/javascript";if(h.readyState){h.onreadystatechange=function(){if(h.readyState=="loaded"||h.readyState=="complete"){h.onreadystatechange=null;i.callback.apply(this,arguments)}}}else{h.onload=function(){i.callback.apply(this,arguments)}}h.src=i.url;document.getElementsByTagName("head")[0].appendChild(h)};f.getStyle=function(h){if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(h.element,"").getPropertyValue(h.rule)}if(h.element.currentStyle){var i=h.rule.replace(/\-(\w)/g,function(j,k){return k.toUpperCase()});return h.element.currentStyle[i]}return""}})(a.Common.DOM=a.Common.DOM||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(h,k){h.post=function(l){l.method="POST";g(l)};h.get=function(l){l.method="GET";g(l)};var g=function(m){var n=f(m);var l=n.create(m.method.toLowerCase(),m.url,a.Common.Function.proxy(function(o,q,p){if(typeof q!="undefined"&&q!=null){if(!!m.error){m.error(q)}}else{if(!!m.success){m.success(o)}}if(!!m.complete){m.complete(o,q,p)}},this),m.async);l.send(!!m.data?m.data:null)},f=function(l){if(window.XMLHttpRequest&&(!l.crossDomain||"withCredentials" in i().getNativeObject())){return i()}else{if(window.XDomainRequest){return j()}else{a.Error.raise({code:a.Error.Codes.REQUEST_UNSUPPORTED,info:{className:"xRTML.Common.Request",methodName:"getRequestType (internal method, no docs available)"}})}}},i=function(){return{getNativeObject:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(l){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(l){}try{return ActiveXObject("Microsoft.XMLHTTP")}catch(l){}}}a.Error.raise({code:a.Error.Codes.REQUEST_UNSUPPORTED,info:{className:"xRTML.Common.Request.XHR (internal class, no docs available)",methodName:"getNativeObject (internal method, no docs available)"}})},create:function(p,m,o,n){var l=this;l.xhr=this.getNativeObject();l.callback=o;p=p.toUpperCase();l.xhr.onreadystatechange=function(){try{if(this.readyState==4){if(this.status==200){l.callback(this.responseText,null,this.status)}else{if(this.status==0){l.callback(null,"The status code is 0 which likely means that the server is unavailable.",this.status)}else{l.callback(null,this.responseText,this.status)}}}}catch(q){a.Console.error(q)}};l.xhr.open(p,m,!!n?n:true);l.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");l.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");if(p=="POST"){l.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}return l},send:function(l){if(l&&typeof(l)!="string"){l=a.JSON.stringify(l)}a.Console.log("Performing request with payload:"+l);this.xhr.send(l)}}},j=function(){return{create:function(q,m,p,n){var l=this;l.xdr=new XDomainRequest();l.callback=p;q=q.toUpperCase();l.xdr.onload=function(){try{l.callback(l.xdr.responseText)}catch(r){a.Error.raise({code:a.Error.Codes.UNEXPECTED,info:{message:r.message,className:"xRTML.Common.Request.XDR (internal class, no docs available)",methodName:"onload (internal method, no docs available)"}})}};l.xdr.onerror=function(){try{l.callback(null,l.xdr.responseText)}catch(r){a.Error.raise({code:a.Error.Codes.UNEXPECTED,info:{message:r.message,className:"xRTML.Common.Request.XDR (internal class, no docs available)",methodName:"onerror (internal method, no docs available)"}})}};l.xdr.open(q,m,!!n?n:true);try{l.xdr.contentType="text/plain"}catch(o){}return l},send:function(n){var m=this;function l(o){if(o&&typeof(o)!="string"){o=a.JSON.stringify(o)}a.Console.log("Performing request with payload:"+o);m.xdr.send(o);if(m.xdrTimeout){clearTimeout(m.xdrTimeout);m.xdrTimeout=k}}if(m.xdrReady){l(n)}else{m.xdrTimeout=setTimeout(function(){l(n)},500)}}}}})(a.Common.Request=a.Common.Request||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.setCookie=function(h){var i=h.name+"="+escape(h.value);if(h.expires){i+="; expires="+h.expires.toGMTString()}if(h.path){i+="; path="+escape(h.path)}else{i+="; path=/"}if(h.domain){i+="; domain="+escape(h.domain)}if(h.secure){i+="; secure"}document.cookie=i};f.getCookie=function(i){var h=document.cookie.match("(^|;) ?"+i.name+"=([^;]*)(;|$)");if(h){return(unescape(h[2]))}return null};f.deleteCookie=function(h){h.value="";h.expires=new Date("Thu, 01 Jan 1970 00:00:01 GMT");f.setCookie(h)}})(a.Common.Cookie=a.Common.Cookie||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.validateRequired=function(h){if(!h.target[h.prop]&&h.target[h.prop]!=0&&(a.Common.Array.isArray(h.target[h.prop])&&h.target[h.prop].length<=0)){a.Error.raise({code:a.Error.Codes.MANDATORY_PROPERTY,target:h.target,info:{property:h.prop}})}};f.validateType=function(h){if(typeof h.target[prop]!=h.type){a.Error.raise({code:a.Error.Codes.INVALID_PROPERTY,target:h.target,info:{property:h.prop,validType:h.type}})}}})(a.Common.Validator=a.Common.Validator||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.toBoolean=function(h){return typeof h==="undefined"?h:(/^true|1|yes$/i).test(h)};f.toNumber=function(h){if(typeof h==="undefined"){return h}if(typeof h=="number"){return h}if(typeof h=="string"){return a.Common.String.trim(h)==""?0:window.Number(h)}}})(a.Common.Converter=a.Common.Converter||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(h,g){var f=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};h.convertAttributeValueToJSON=function(j){var i;if(j){j=a.Common.String.replaceAll({text:j,token:"'",newtoken:'"'});if(typeof j=="string"){i=a.JSON.parse(j)}else{i=j}}else{a.Error.raise({code:a.Error.Codes.MISSING_ARGUMENT,info:{className:"xRTML.Common.Util",methodName:"convertAttributeValueToJSON",argument:"attributeValue"}})}return i};h.guidGenerator=function(){return(f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f())};h.idGenerator=function(){return(f()+f())}})(a.Common.Util=a.Common.Util||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){(function(f,g){f.proxy=function(i,h){if(typeof i==="function"&&typeof h==="object"){return function(){return i.apply(h,arguments)}}};f.parse=function(l){if(typeof l=="function"){return l}if(typeof l!="string"){return null}var j="",h="return "+l+"(";if(arguments.length!=1){for(var k=1;k<arguments.length;++k){j+=arguments[k]+","}j=j.substring(0,j.length-1)}h+=j+");";return new window.Function(j,h)}})(a.Common.Function=a.Common.Function||{})})(a.Common=a.Common||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,h){var f={},g=function(j){for(var i in f){if(f[i].id===j){return f[i]}}a.Console.debug("Connection with id: "+j+" was not found.");return h},d={add:function(i){var j=i.connection.id;if(!this.bConnections[j]){this.bConnections[j]=[];i.connection.bind({connect:this.send})}this.bConnections[j].push(i.message)},bConnections:{},send:function(l){var k=d.bConnections[l.target.id],m=l.target;for(var j=0;j<k.length;++j){m.send(k[j])}m.unbind({connect:d.send});d.bConnections[l.target.id]=h}};c.create=function(i){return this.add(new this.Connection(i))};c.add=function(i){if(this.getById(i.id)){return}this.Connections.push(i.id);this.fire({connectioncreate:{connection:i}});f[i.internalId]=i;i.bind({xrtmlmessage:function(j){c.fire({xrtmlmessage:{connection:j.target,channel:j.channel,message:j.message}})}});i.bind({dispose:function(o){var k=o.target.internalId,n=f[k];f[k]=null;delete f[k];for(var m=0,l=c.Connections,j=l.length;m<j;m++){if(l[m]===o.target.id){l.splice(m,1);break}}c.fire({connectiondispose:{connection:o.target}})}});return i};c.getById=function(i){return f[i]||g(i)};c.dispose=function(j){var i=this.getById(channel.connectionId);i.dispose()};c.addChannel=function(j){var i=this.getById(j.connectionId);if(typeof i==="undefined"){i=this.getConnectionById(j.connectionId);if(i===null){a.Error.raise({code:a.Error.Codes.CONNECTION_NOT_FOUND,target:this,info:{className:"xRTML.ConnectionManager",methodName:"addChannel"}})}}i.createChannel(j)};c.sendMessage=function(l){var j=null;for(var k=0;k<l.connections.length;++k){j=this.getById(l.connections[k]);if(j){if(j.isConnected()){j.send(l)}else{d.add({connection:j,message:{channel:l.channel,content:l.content,sendOnly:l.sendOnly}});a.Console.debug("ConnectionManager: Connection with id "+l.connections[k]+" is not connected. Buffering message:");a.Console.debug(l)}}else{a.Error.raise({code:a.Error.Codes.CONNECTION_NOT_FOUND,target:this,info:{className:"xRTML.ConnectionManager",methodName:"sendMessage"}})}}};c.Connections=[];a.Event.extend(c)})(a.ConnectionManager=a.ConnectionManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(c,d){c.Connection=function(m){var f=null,h=true;a.Event.extend(this);this.internalId=a.Common.Util.guidGenerator();this.id=m.id||this.internalId;this.appKey=m.appKey;this.authToken=m.authToken;this.sendRetries=parseInt(m.sendRetries)||5;this.sendInterval=parseInt(m.sendInterval)||1000;this.timeout=m.timeout||a.Config.connectionTimeout;this.connectAttempts=m.connectAttempts||a.Config.connectionAttempts;this.connectionAttemptsCounter=0;this.autoConnect=!!m.autoConnect?a.Common.Converter.toBoolean(m.autoConnect):true;this.metadata=m.metadata;this.serverType=m.serverType||"IbtRealTimeSJ";this.url=m.url||a.Console.error("Connection "+(this.id||this.internalId)+": ORTC Server URL must be set.");this.isCluster=!!m.isCluster?a.Common.Converter.toBoolean(m.isCluster):true;this.announcementSubChannel=m.announcementSubChannel;this.channels={};this.messageAdapter=m.messageAdapter;var n=a.Common.Function.parse,l=a.Common.Function.proxy;this.bind({create:n(m.onCreate),connect:n(m.onConnect),disconnect:n(m.onDisconnect),subscribe:n(m.onSubscribe),unsubscribe:n(m.onUnsubscribe),exception:n(m.onException),reconnect:n(m.onReconnect),reconnecting:n(m.onReconnecting),message:n(m.onMessage),dispose:n(m.onDispose)});var o=l(function(i,q,p){this.process({channel:q,message:p})},this),k=function(i){f=i.createClient();f.setId(this.internalId);f.setConnectionTimeout(this.timeout);f.setConnectionMetadata(this.metadata);f.setAnnouncementSubChannel(this.announcementSubChannel);!this.isCluster?f.setUrl(this.url):f.setClusterUrl(this.url);f.onConnected=l(function(q){for(var p in this.channels){var r=this.channels[p];if(r.subscribe){q.subscribe(r.name,r.subscribeOnReconnect,o)}}this.fire({connect:{}})},this);f.onDisconnected=l(function(p){this.fire({disconnect:{}})},this);f.onSubscribed=l(function(p,q){this.fire({subscribe:{channel:q}})},this);f.onUnsubscribed=l(function(p,q){this.fire({unsubscribe:{channel:q}});if(this.channels[q]){delete this.channels[q]}},this);f.onException=l(function(q,p){this.fire({exception:{message:p}});a.Error.raise({code:a.Error.Codes.ORTC_EXCEPTION,info:{className:"ORTCClient",methodName:"onException",message:p}})},this);f.onReconnected=l(function(p){this.connectionAttemptsCounter=0;this.fire({reconnect:{}})},this);f.onReconnecting=l(function(p){if(this.connectionAttemptsCounter>=this.connectAttempts){p.disconnect()}else{this.connectionAttemptsCounter++;this.fire({reconnecting:{}})}},this);this.fire({create:{}});if(this.autoConnect){f.connect(this.appKey,this.authToken)}};var g=function(p,i){if(typeof p.content==="object"){p.content=p.content.stringify()}if(this.isCreated()&&this.isConnected()){f.send(p.channel,p.content)}else{if(++i<=this.sendRetries){setTimeout(l(function(){l(g,this)(p,i)},this),this.sendInterval);a.Console.debug("Message "+p.content+" not sent to channel "+p.channel+". Retry "+i+"/"+this.sendRetries+" in "+this.sendInterval/1000+" seconds.")}else{a.Console.debug("Message "+p.content+" not sent to channel "+p.channel+". Discarding message.")}}};this.active=function(i){if(!i){return h}h=a.Common.Converter.toBoolean(i);return h};this.dispose=function(){if(this.isConnected()){this.disconnect()}this.fire({dispose:{}})};this.createChannel=function(i){i.subscribeOnReconnect=(typeof i.subscribeOnReconnect=="undefined")?true:i.subscribeOnReconnect;i.subscribe=(typeof i.subscribe=="undefined")?true:i.subscribe;a.Event.extend(i);this.channels[i.name]=i;this.channels[i.name].bind({message:i.onMessage});this.fire({channelcreate:{channel:i}});return i};this.process=function(t){var r=t.channel,q=t.message;if(q.substring(0,15)=="_X_SEND_ONLY_X_"){var i=q.substring(15,51);if(this.internalId==i){return}else{q=q.substring(54)}}if(this.active()){try{if(this.messageAdapter){q=this.messageAdapter(q)}if(this.channels[r]&&this.channels[r].messageAdapter){q=this.channels[r].messageAdapter(q)}}catch(p){a.Error.raise({code:a.Error.Codes.CONNECTION_ADAPT,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"process",originalMessage:q,message:p.message}})}var u=q;if(a.MessageManager.isValid(q)){u=a.MessageManager.toJson(q).xrtml;this.fire({xrtmlmessage:{message:u,channel:r}})}this.channels[r].fire({message:{message:u}});this.fire({message:{channel:r,message:u}})}else{a.Console.debug("Connection "+(this.id||this.internalId)+" : Not active. Message received wasn't processed.")}};this.send=function(r){var q=r.channel,p=r.content;if(typeof p==="object"){p=p.stringify()}if(this.isCreated()&&this.isConnected()){if(this.active()){if(r.sendOnly){p="_X_SEND_ONLY_X_"+this.internalId+"_X_"+p}f.send(q,p);var t;try{t=a.JSON.parse(p)}catch(i){t=p}a.Console.debug("Connection "+(this.id||this.internalId)+": Message sent to channel "+q);a.Console.debug(t)}else{a.Console.debug("Connection "+(this.id||this.internalId)+": Not active. Message not sent to channel "+q);a.Console.debug(r.content)}}else{setTimeout(l(function(){l(g,this)(r,0)},this),this.sendInterval);a.Console.debug("Connection "+(this.id||this.internalId)+": Not ready. Message not sent to channel "+q+". Retrying in "+this.sendInterval/1000+" seconds.");a.Console.debug(r.content)}};this.connect=function(i){this.isCreated()?f.connect(i.appKey||this.appKey,i.authToken||this.authToken):a.Error.raise({code:a.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"connect"}})};this.disconnect=function(){this.isConnected()?f.disconnect():a.Error.raise({code:a.Error.Codes.ORTC_DISCONNECTED,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"disconnect"}})};this.subscribe=function(i){i=this.createChannel(i);f.subscribe(i.name,i.subscribeOnReconnect,o)};this.unsubscribe=function(i){f.unsubscribe(i)};this.isCreated=function(){return f!=null};this.isConnected=function(){return this.isCreated()?f.getIsConnected():false};this.isSubscribed=function(i){return this.isConnected()?f.isSubscribed(i):false};this.getMetadata=function(){return this.isCreated()?f.getConnectionMetadata():a.Error.raise({code:a.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"getMetadata"}})};this.setMetadata=function(i){return this.isCreated()?f.setConnectionMetadata(i):a.Error.raise({code:a.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"setMetadata"}})};this.getAnnouncementSubChannel=function(){return this.isCreated()?f.getAnnouncementSubChannel():a.Error.raise({code:a.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"getAnnouncementSubChannel"}})};if(typeof loadOrtcFactory!="undefined"){loadOrtcFactory(this.serverType,l(k,this))}else{a.bind({ready:l(function(){l(loadOrtcFactory,this)(this.serverType,l(k,this))},this)})}if(m.channels){for(var j=0;j<m.channels.length;++j){this.createChannel(m.channels[j])}}}})(a.ConnectionManager=a.ConnectionManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(g,f){var c={},d=function(i){for(var h in c){if(c[h].id===i){return c[h]}}a.Console.warn("Storage with id: "+i+" was not found.");return f};g.create=function(j){try{var k=new g[j.type||"KeyValuePairStorage"](),h=g.Storage.extend(k);h=new h(j);h.bind({dispose:function(n){var m=n.target.internalId,l=c[m];c[m]=null;delete c[m];g.fire({storagedispose:{storage:n.target}})}});c[h.internalId]=h;g.fire({storagecreate:{storage:h}});return h}catch(i){a.Error.raise({code:a.Error.Codes.UNEXPECTED,info:{message:i.message,className:"xRTML.StorageManager",methodName:"create"}})}};g.getById=function(h){return c[h]||d(h)};a.Event.extend(g)})(a.StorageManager=a.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(f,d){var c=function(){this.init=function(g){a.Event.extend(this);this.internalId=a.Common.Util.guidGenerator();this.id=g.id||this.internalId;this.type=g.type||"KeyValuePairStorage";this.isReady=false;this.autoConnect=typeof g.autoConnect!="undefined"?a.Common.Converter.toBoolean(g.autoConnect):true;this.dispose=function(){this.fire({dispose:{}})};this.bind({ready:a.Common.Function.parse(g.onready),exception:a.Common.Function.parse(g.onexception)})}};f.Storage=a.Class.extend(new c())})(a.StorageManager=a.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(f,d){var c=function(){this.init=function(n){this._super(n);this.baseUrl=!!n.baseUrl?(n.baseUrl[n.baseUrl.length-1]=="/"?n.baseUrl.substring(0,(n.baseUrl.length-1)):n.baseUrl):null;a.Common.Validator.validateRequired({target:this,prop:"baseUrl"});this.connectionId=n.connectionId;this.sessionId=n.sessionId;this.operationsTimeout=!!n.operationsTimeout?n.operationsTimeout:2000;this.bind({session:a.Common.Function.parse(n.onsession)});if(this.autoConnect){this.openConnection()}};var m={};var i=[];var l={get:"readRequestChannel",set:"writeRequestChannel",del:"writeRequestChannel",incr:"writeRequestChannel"};var g={readRequestChannel:d,readResponseChannel:d,writeRequestChannel:d,writeResponseChannel:d};var h;this.set=function(n,o){k.call(this,{data:n,action:"set",callback:o})};this.del=function(n,o){k.call(this,{data:n,action:"del",callback:o})};this.incr=function(n,o){k.call(this,{data:n,action:"incr",callback:o})};this.get=function(n,o){k.call(this,{data:n,action:"get",callback:o})};var k=function(p){if(this.isReady){var n=a.Common.Util.guidGenerator();m[n]={callback:p.callback,timeout:setTimeout(a.Common.Function.proxy(function(){a.Error.raise({code:a.Error.Codes.STORAGE_OPERATION_TIMEOUT,target:this,info:{opId:n,timeout:this.operationsTimeout,className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"performRemoteDataOperation (internal method, no docs available)"}})},this),this.operationsTimeout)};var q=p.data;q.namespaceExpire=q.namespaceExpire||31556926;q.opId=n;var o=a.MessageManager.create({action:p.action,data:q,senderId:this.internalId});h.send({channel:g[l[p.action]],content:o})}else{i.push(p);a.Console.warn("Storage operation placed in buffer. Will only be called when the Storage is ready.")}};var j=function(o){var p=o.data;var n=p.opId;p.opId=null;delete p.opId;var q={success:o.success,data:o.success?p:null,error:!o.success?o.data.error:null};if(m[n]&&m[n].callback){m[n].callback(q)}clearTimeout(m[n].timeout);m[n]=null;delete m[n]};this.getSession=function(n){a.Common.Request.post({url:this.baseUrl+"/getStorageSession",data:n,crossDomain:true,success:a.Common.Function.proxy(function(o){var q;try{q=a.JSON.parse(o)}catch(p){a.Error.raise({code:a.Error.Codes.JSON_PARSE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"getSession",message:p.message}})}this.sessionId=q.sessionId;this.fire({session:{sessionId:this.sessionId}});if(n.autoConnect){this.openConnection()}},this),error:a.Common.Function.proxy(function(o){a.Error.raise({code:a.Error.Codes.STORAGE_SESSION,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"getSession",message:o}})},this)})};this.openConnection=function(){if(this.sessionId){a.Common.Request.post({url:this.baseUrl+"/openStorageConnection",data:{sessionId:this.sessionId},crossDomain:true,success:a.Common.Function.proxy(function(p){var u;try{u=a.JSON.parse(p)}catch(t){a.Error.raise({code:a.Error.Codes.JSON_PARSE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection",message:t.message}})}g.readRequestChannel=u.channels.readRequestChannel;g.readResponseChannel=u.channels.readResponseChannel;g.writeRequestChannel=u.channels.writeRequestChannel;g.writeResponseChannel=u.channels.writeResponseChannel;if(!!this.connectionId){h=a.ConnectionManager.getById(this.connectionId)}else{var r={appKey:u.appKey,authToken:u.authToken,url:u.url,isCluster:u.isCluster,serverType:u.serverType};h=a.ConnectionManager.create(r)}function o(w){w.bind({xrtmlmessage:a.Common.Function.proxy(function(z){if(z.channel==g.readResponseChannel||z.channel==g.writeResponseChannel){var y=z.message;j.call(this,{success:y.action=="exception"?false:true,data:y.data})}},this)});var v=false;var x=false;w.bind({subscribe:a.Common.Function.proxy(function(A){if(A.channel==g.readResponseChannel){v=true}if(A.channel==g.writeResponseChannel){x=true}if(v&&x){this.isReady=true;for(var z=0,y=i.length;z<y;z++){k.call(this,i[z])}i=[];this.fire({ready:{}})}},this)});w.subscribe({name:g.readResponseChannel});w.subscribe({name:g.writeResponseChannel})}if(h.isConnected()){o.call(this,h)}else{if(h.autoConnect){h.bind({connect:a.Common.Function.proxy(function(v){o.call(this,v.target)},this)})}else{h.bind({connect:a.Common.Function.proxy(function(v){o.call(this,v.target)},this)});function q(v){v.connect({appKey:!!u.appKey?u.appKey:null,authToken:!!u.authToken?u.authToken:null})}if(h.isCreated()){q.call(this,h)}else{h.bind({create:a.Common.Function.proxy(function(v){q.call(this,v.target)},this)})}}}},this),error:a.Common.Function.proxy(function(o){a.Error.raise({code:a.Error.Codes.REQUEST_FAILURE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection",message:o}})},this)})}else{h=a.ConnectionManager.getById(this.connectionId);if(!!h){var n={appKey:h.appKey,serverUrl:h.url,isCluster:h.isCluster,serverType:h.serverType,timeToLive:900,authenticate:false,autoConnect:true};this.getSession(n)}else{a.Error.raise({code:a.Error.Codes.STORAGE_CONNECTION_UNAVAILABLE,target:this,info:{connectionId:this.connectionId,className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection"}})}}}};f.KeyValuePairStorage=c})(a.StorageManager=a.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(k,g){var j={},m={},i=null,l=function(o){for(var n in j){if(j[n].id===o){return j[n]}}a.Console.log("Tag with id: "+o+" was not found.");return g},h=function(n){if(n.base!="Tag"){var o=h(new m[n.base]());n=o.extend(n)}else{n=i.extend(n)}return n},f=function(o){var p,q=new RegExp(o,"ig");for(var n in this){if(n.match(q)){p=this[n];break}}return p},d=[];if(!a.domLoaded()){function c(){for(var n=0;n<d.length;++n){a.TagManager.create(d[n])}d=[];a.Event.unbind(window,{load:c})}a.Event.bind(window,{load:c})}k.register=function(o){var n=o.name;if(n){if(n!="Tag"){if(!m[n]){if(!o.base){o.base="Tag"}m[n]=o.struct;m[n].prototype.base=o.base;m[n].prototype.name=o.name}}else{i=o.struct}}else{a.Error.raise({code:a.Error.Codes.TAG_INVALID_CONFIG,target:this,info:{message:"Please provide the tag name.",className:"xRTML.TagManager",methodName:"register"}})}};k.create=function(o){try{if((o.target||o.template)&&!a.domLoaded()){d.push(o);a.Console.debug("TagManager: Creating a "+o.name+" tag postponed until HTML page has been fully loaded.");return}o.attribute=f;if(!m[o.name]){throw a.Error.raise({code:a.Error.Codes.TAG_UNREGISTERED,info:{tagName:o.name,className:"xRTML.TagManager",methodName:"create"}})}var n=new m[o.name]();if(!!n["abstract"]){a.Error.raise({code:a.Error.Codes.TAG_ABSTRACT,target:this,info:{tag:n,className:"xRTML.TagManager",methodName:"create"}})}var q=n.base=="Tag"?i.extend(n):h(n);q=new q(o);q.fire({postinit:{}});q.bind({dispose:function(t){var r=t.target.internalId,u=j[r];j[r]=null;delete j[r];k.fire({tagdispose:{tag:t.target}})}});j[q.internalId]=q;k.fire({tagcreate:{tag:q}});return q}catch(p){a.Error.raise({code:a.Error.Codes.TAG_NOT_CREATED,target:this,info:{id:o.id,className:"xRTML.TagManager."+o.name,methodName:"init",message:p.message,tagConfig:o}})}};k.getById=function(n){return j[n]||l(n)};k.getClasses=function(){var n=[];for(var o in m){n.push(o)}return n};a.Event.extend(k);a.DomParser.bind({tagsLoad:function(p){var n=p.tags;for(var o=0;o<n.length;++o){k.create(n[o])}}})})(a.TagManager=a.TagManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(g,d){var j={},l=function(m){if(!j[m.name]){j[m.name]={}}j[m.name][m.tagInternalId]={callback:m.callback,mappings:m.mappings};g.fire({triggerregister:{trigger:m}})},h=function(o){var n=j[o.name];if(n&&n[o.tagInternalId]){var m=n[o.tagInternalId];o.callback=m.callback;o.mappings=m.mappings;delete j[o.name][o.tagInternalId];var p=false;for(var q in n){if(n.hasOwnProperty(q)){p=true}}if(!p){delete j[o.name]}g.fire({triggerunregister:{trigger:o}})}},k=function(o){if(j[o.name]){for(var n in j[o.name]){var m=a.TagManager.getById(n);if(m.active||p.data.action=="activate"){var p=o.message;if(m.receiveOwnMessages||!p.senderId||m.internalId!==p.senderId){var r=p.data;m.fire({preProcess:r});var q=p.action;if(q){m[q]?m[q].call(m,r):a.Error.raise({code:a.Error.Codes.TAG_ACTION_UNDEFINED,target:m,info:{action:q,className:"xRTML.MessageBroker",methodName:"triggerCall (internal method, no docs available)"}})}else{m.process(r)}m.fire({postProcess:r})}}else{a.Error.raise({code:a.Error.Codes.TAG_INACTIVE,target:m,className:"xRTML.MessageBroker",methodName:"triggerCall (internal method, no docs available)"})}}}else{a.Console.debug("Trigger "+o.name+" is not registered with any xRTML Tag.")}},f=function(p){var m=p.tag,n;for(var o=0;o<m.triggers.length;++o){n=m.triggers[o];l({tagId:m.id,tagInternalId:m.internalId,name:n.name,callback:m.preProcess,mappings:n.mappings})}},c=function(p){var m=p.tag,n;for(var o=0;o<m.triggers.length;++o){n=m.triggers[o];h({tagInternalId:m.internalId,name:n.name})}},i=function(n){var o=n.message.trigger;if(typeof o=="string"){k({name:o,message:n.message})}else{if(o instanceof Array){for(var m=0;m<o.length;++m){n.message.trigger=o[m].name;k({name:o[m].name,message:n.message})}}}};a.Event.extend(g);a.TagManager.bind({tagcreate:f,tagdispose:c});a.ConnectionManager.bind({xrtmlmessage:i})})(a.MessageBroker=a.MessageBroker||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(d,c){d.isValid=function(h){try{if(typeof h==="string"){var f=h.substring(h.indexOf('"'),h.indexOf('"',h.indexOf('"')+1)+1);if('"xrtml"'!=a.Common.String.trim(f)){return false}a.JSON.parse(h);return true}if((typeof h==="object")&&h.xrtml){return true}return false}catch(g){a.Error.raise({code:a.Error.Codes.INVALID_MESSAGE,target:this,message:g.message,info:{className:"xRTML.MessageManager",methodName:"isValid"}})}};d.toJson=function(g){if(typeof g==="string"&&d.isValid(g)){var f=a.JSON.parse(g).xrtml;var h={xrtml:{senderId:f.s,trigger:f.t,action:f.a,data:f.d}};return h}return g};d.stringify=function(f){var g={xrtml:{s:f.senderId,t:f.trigger,a:f.action,d:typeof f.data==="object"?f.data:a.JSON.parse(f.data)}};return a.JSON.stringify(g)};d.create=function(f){f.data=typeof f.data==="object"?f.data:a.JSON.parse(f.data);f.stringify=function(){return d.stringify(this)};return f}})(a.MessageManager=a.MessageManager||{})})(window.xRTML=window.xRTML||{});(function(a,b){(function(d,g){var c=function(h,k){if(a.Config.remoteTrace){var i=null;try{i=a.JSON.stringify(k)}catch(j){}var l=a.MessageManager.create({data:{message:h,content:i}});a.ConnectionManager.sendMessage("trace",l)}};a.Console.bind({error:function(h){c("Error",h.error)}});a.ConnectionManager.bind({connectioncreate:function(h){var i=h.connection;c("Connection found: \n AppKey: "+i.appKey+" \n AuthToken: "+i.authToken+" \n Url: "+i.url,i);i.bind({create:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" created. "+(k.target.autoConnect?"Connecting...":"Waiting for explicit connect...");a.Console.debug(j);c(j,k.target)},connect:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" established.";a.Console.debug(j);c(j,k.target)},disconnect:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" closed.";a.Console.debug(j);c(j,k.target)},subscribe:function(k){var j="Connection "+(k.target.id||k.target.internalId)+": Channel "+k.channel+" subscribed.";a.Console.debug(j);c(j,k.target)},unsubscribe:function(k){var j="Connection "+(k.target.id||k.target.internalId)+": Channel "+k.channel+" unsubscribed.";a.Console.debug(j);c(j,k.target)},exception:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" threw an exception: "+k.event;a.Console.debug(j);c(j,k.target)},reconnect:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" is restored.";a.Console.debug(j);c(j,k.target)},reconnecting:function(k){var j="Connection "+(k.target.id||k.target.internalId)+" was lost. ";if(k.target.connectionAttemptsCounter>=k.target.connectAttempts){j+="Maximum number of attempts reached: "+k.target.connectAttempts+" Stop trying to reconnect."}else{j+="Trying to reconnect. Attempt "+k.target.connectionAttemptsCounter+" out of "+k.target.connectAttempts}a.Console.debug(j);c(j,k.target)},message:function(m){var l="Connection "+(m.target.id||m.target.internalId)+": Message received from channel "+m.channel,k;try{k=a.JSON.parse(m.message)}catch(j){k=m.message}a.Console.debug(l);a.Console.debug(k);c(k,m.target)},xrtmlmessage:function(k){var j="Connection "+(k.target.id||k.target.internalId)+": xRTML Message received from channel "+k.channel;a.Console.debug(j);a.Console.debug(k.message);c(k.message,k.target)}})}});var f=function(i){var h="Tag "+(i.target.id||i.target.internalId)+": "+i.type+" message";a.Console.debug(h);a.Console.debug(i.data);c(h,i.data)};a.TagManager.bind({tagcreate:function(i){var h=i.tag;a.Console.debug("Tag of type "+h.name+" created with id "+(h.id||h.internalId));a.Console.debug(h);h.bind({init:function(j){a.Console.debug("")},load:function(j){a.Console.debug("")},active:function(j){a.Console.debug("")},process:f,preprocess:f,postprocess:f})},tagdispose:function(j){var h=j.tag,i="Tag of type "+j.name+" with id "+(h.id||h.internalId)+" disposed.";a.Console.debug(i);c(i,j.tag)}});a.MessageBroker.bind({triggerregister:function(i){var h="Tag "+(i.trigger.tagId||i.trigger.tagInternalId)+" registered trigger: "+i.trigger.name;a.Console.debug(h);c(h,i.target)},triggerunregister:function(i){var h="Tag "+(i.trigger.tagId||i.trigger.tagInternalId)+" unregistered trigger: "+i.trigger.name;a.Console.debug(h);c(h,i.target)}});a.DomParser.bind({configLoad:function(h){a.Console.debug("DOM Parser: the following connections were read from DOM: ");a.Console.debug(h.config.connections);a.Console.debug("DOM Parser: the following storages were read from DOM: ");a.Console.debug(h.config.storages)},tagsLoad:function(h){a.Console.debug("DOM Parser: the following tags were read from DOM: ");a.Console.debug(h.tags)}})})(a.TraceMonitor=a.TraceMonitor||{})})(window.xRTML=window.xRTML||{});(function(){var a=function(){xRTML.isReady=true;xRTML.fire({ready:{}})};(typeof loadOrtcFactory=="undefined")?xRTML.Config.ortcLibrary(((document.location.protocol=="file:")?"http:":document.location.protocol)+"//dfdbz2tdq3k01.cloudfront.net/js/2.1.0/ortc.js",a):a();xRTML.domLoaded()?xRTML.DomParser.read():xRTML.Event.bind(window,{load:xRTML.DomParser.read})})();(function(a){(function(b,c){b[xRTML.version]?xRTML=b[xRTML.version]:b[xRTML.version]=xRTML;b.current=b.current||xRTML.version;xRTML=b[b.current]})(a.xRTMLVersions=a.xRTMLVersions||{})})(window);(function(a,b){(function(c,f){var d=f;(function(j,g,h,k){var i=true;!function(l){l(d={})}(function(n){var v=typeof n!=="undefined"?n:{};v.exportSymbol=function(z,x){var B=z.split(".");var A=v;for(var y=0;y<B.length-1;y++){A=A[B[y]]}A[B[B.length-1]]=x};v.exportProperty=function(y,x,z){y[x]=z};v.version="2.1.0";v.exportSymbol("version",v.version);v.utils=new (function(){var I=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;var H={},B={};var A=/Firefox\/2/i.test(h.userAgent)?"KeyboardEvent":"UIEvents";H[A]=["keyup","keydown","keypress"];H.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"];for(var x in H){var C=H[x];if(C.length){for(var F=0,D=C.length;F<D;F++){B[C[F]]=x}}}var J={propertychange:true};var E=(function(){var K=3,M=g.createElement("div"),L=M.getElementsByTagName("i");while(M.innerHTML="<!--[if gt IE "+(++K)+"]><i></i><![endif]-->",L[0]){}return K>4?K:k}());var z=E===6,y=E===7;function G(L,K){if((v.utils.tagNameLower(L)!=="input")||!L.type){return false}if(K.toLowerCase()!="click"){return false}var M=L.type;return(M=="checkbox")||(M=="radio")}return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(N,M){for(var L=0,K=N.length;L<K;L++){M(N[L])}},arrayIndexOf:function(N,M){if(typeof Array.prototype.indexOf=="function"){return Array.prototype.indexOf.call(N,M)}for(var L=0,K=N.length;L<K;L++){if(N[L]===M){return L}}return -1},arrayFirst:function(O,K,N){for(var M=0,L=O.length;M<L;M++){if(K.call(N,O[M])){return O[M]}}return null},arrayRemoveItem:function(M,L){var K=v.utils.arrayIndexOf(M,L);if(K>=0){M.splice(K,1)}},arrayGetDistinctValues:function(N){N=N||[];var K=[];for(var M=0,L=N.length;M<L;M++){if(v.utils.arrayIndexOf(K,N[M])<0){K.push(N[M])}}return K},arrayMap:function(O,M){O=O||[];var K=[];for(var N=0,L=O.length;N<L;N++){K.push(M(O[N]))}return K},arrayFilter:function(O,L){O=O||[];var K=[];for(var N=0,M=O.length;N<M;N++){if(L(O[N])){K.push(O[N])}}return K},arrayPushAll:function(N,M){if(M instanceof Array){N.push.apply(N,M)}else{for(var L=0,K=M.length;L<K;L++){N.push(M[L])}}return N},extend:function(L,K){if(K){for(var M in K){if(K.hasOwnProperty(M)){L[M]=K[M]}}}return L},emptyDomNode:function(K){while(K.firstChild){v.removeNode(K.firstChild)}},moveCleanedNodesToContainerElement:function(L){var O=v.utils.makeArray(L);var K=g.createElement("div");for(var N=0,M=O.length;N<M;N++){v.cleanNode(O[N]);K.appendChild(O[N])}return K},setDomNodeChildren:function(M,N){v.utils.emptyDomNode(M);if(N){for(var L=0,K=N.length;L<K;L++){M.appendChild(N[L])}}},replaceDomNodes:function(O,Q){var P=O.nodeType?[O]:O;if(P.length>0){var M=P[0];var N=M.parentNode;for(var L=0,K=Q.length;L<K;L++){N.insertBefore(Q[L],M)}for(var L=0,K=P.length;L<K;L++){v.removeNode(P[L])}}},setOptionNodeSelectionState:function(L,K){if(h.userAgent.indexOf("MSIE 6")>=0){L.setAttribute("selected",K)}else{L.selected=K}},stringTrim:function(K){return(K||"").replace(I,"")},stringTokenize:function(N,L){var K=[];var Q=(N||"").split(L);for(var O=0,M=Q.length;O<M;O++){var P=v.utils.stringTrim(Q[O]);if(P!==""){K.push(P)}}return K},stringStartsWith:function(K,L){K=K||"";if(L.length>K.length){return false}return K.substring(0,L.length)===L},buildEvalWithinScopeFunction:function(N,M){var L="return ("+N+")";for(var K=0;K<M;K++){L="with(sc["+K+"]) { "+L+" } "}return new Function("sc",L)},domNodeIsContainedBy:function(L,K){if(K.compareDocumentPosition){return(K.compareDocumentPosition(L)&16)==16}while(L!=null){if(L==K){return true}L=L.parentNode}return false},domNodeIsAttachedToDocument:function(K){return v.utils.domNodeIsContainedBy(K,K.ownerDocument)},tagNameLower:function(K){return K&&K.tagName&&K.tagName.toLowerCase()},registerEventHandler:function(N,M,O){var L=E&&J[M];if(!L&&typeof jQuery!="undefined"){if(G(N,M)){var K=O;O=function(R,Q){var P=this.checked;if(Q){this.checked=Q.checkedStateBeforeEvent!==true}K.call(this,R);this.checked=P}}jQuery(N)["bind"](M,O)}else{if(!L&&typeof N.addEventListener=="function"){N.addEventListener(M,O,false)}else{if(typeof N.attachEvent!="undefined"){N.attachEvent("on"+M,function(P){O.call(N,P)})}else{throw new Error("Browser doesn't support addEventListener or attachEvent")}}}},triggerEvent:function(M,L){if(!(M&&M.nodeType)){throw new Error("element must be a DOM node when calling triggerEvent")}if(typeof jQuery!="undefined"){var O=[];if(G(M,L)){O.push({checkedStateBeforeEvent:M.checked})}jQuery(M)["trigger"](L,O)}else{if(typeof g.createEvent=="function"){if(typeof M.dispatchEvent=="function"){var K=B[L]||"HTMLEvents";var N=g.createEvent(K);N.initEvent(L,true,true,j,0,0,0,0,0,false,false,false,false,0,M);M.dispatchEvent(N)}else{throw new Error("The supplied element doesn't support dispatchEvent")}}else{if(typeof M.fireEvent!="undefined"){if(G(M,L)){M.checked=M.checked!==true}M.fireEvent("on"+L)}else{throw new Error("Browser doesn't support triggering events")}}}},unwrapObservable:function(K){return v.isObservable(K)?K():K},toggleDomNodeCssClass:function(Q,P,O){var K=(Q.className||"").split(/\s+/);var N=v.utils.arrayIndexOf(K,P)>=0;if(O&&!N){Q.className+=(K[0]?" ":"")+P}else{if(N&&!O){var L="";for(var M=0;M<K.length;M++){if(K[M]!=P){L+=K[M]+" "}}Q.className=v.utils.stringTrim(L)}}},setTextContent:function(K,L){var M=v.utils.unwrapObservable(L);if((M===null)||(M===k)){M=""}"innerText" in K?K.innerText=M:K.textContent=M;if(E>=9){K.style.display=K.style.display}},ensureSelectElementIsRenderedCorrectly:function(K){if(E>=9){var L=K.style.width;K.style.width=0;K.style.width=L}},range:function(N,L){N=v.utils.unwrapObservable(N);L=v.utils.unwrapObservable(L);var K=[];for(var M=N;M<=L;M++){K.push(M)}return K},makeArray:function(N){var K=[];for(var M=0,L=N.length;M<L;M++){K.push(N[M])}return K},isIe6:z,isIe7:y,ieVersion:E,getFormFields:function(M,P){var K=v.utils.makeArray(M.getElementsByTagName("input")).concat(v.utils.makeArray(M.getElementsByTagName("textarea")));var O=(typeof P=="string")?function(Q){return Q.name===P}:function(Q){return P.test(Q.name)};var N=[];for(var L=K.length-1;L>=0;L--){if(O(K[L])){N.push(K[L])}}return N},parseJson:function(K){if(typeof K=="string"){K=v.utils.stringTrim(K);if(K){if(j.JSON&&j.JSON.parse){return j.JSON.parse(K)}return(new Function("return "+K))()}}return null},stringifyJson:function(M,K,L){if((typeof JSON=="undefined")||(typeof JSON.stringify=="undefined")){throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js")}return JSON.stringify(v.utils.unwrapObservable(M),K,L)},postJson:function(P,Q,W){W=W||{};var N=W.params||{};var M=W.includeFields||this.fieldsIncludedWithJsonPost;var K=P;if((typeof P=="object")&&(v.utils.tagNameLower(P)==="form")){var T=P;K=T.action;for(var R=M.length-1;R>=0;R--){var S=v.utils.getFormFields(T,M[R]);for(var O=S.length-1;O>=0;O--){N[S[O].name]=S[O].value}}}Q=v.utils.unwrapObservable(Q);var L=g.createElement("form");L.style.display="none";L.action=K;L.method="post";for(var V in Q){var U=g.createElement("input");U.name=V;U.value=v.utils.stringifyJson(v.utils.unwrapObservable(Q[V]));L.appendChild(U)}for(var V in N){var U=g.createElement("input");U.name=V;U.value=N[V];L.appendChild(U)}g.body.appendChild(L);W.submitter?W.submitter(L):L.submit();setTimeout(function(){L.parentNode.removeChild(L)},0)}}})();v.exportSymbol("utils",v.utils);v.exportSymbol("utils.arrayForEach",v.utils.arrayForEach);v.exportSymbol("utils.arrayFirst",v.utils.arrayFirst);v.exportSymbol("utils.arrayFilter",v.utils.arrayFilter);v.exportSymbol("utils.arrayGetDistinctValues",v.utils.arrayGetDistinctValues);v.exportSymbol("utils.arrayIndexOf",v.utils.arrayIndexOf);v.exportSymbol("utils.arrayMap",v.utils.arrayMap);v.exportSymbol("utils.arrayPushAll",v.utils.arrayPushAll);v.exportSymbol("utils.arrayRemoveItem",v.utils.arrayRemoveItem);v.exportSymbol("utils.extend",v.utils.extend);v.exportSymbol("utils.fieldsIncludedWithJsonPost",v.utils.fieldsIncludedWithJsonPost);v.exportSymbol("utils.getFormFields",v.utils.getFormFields);v.exportSymbol("utils.postJson",v.utils.postJson);v.exportSymbol("utils.parseJson",v.utils.parseJson);v.exportSymbol("utils.registerEventHandler",v.utils.registerEventHandler);v.exportSymbol("utils.stringifyJson",v.utils.stringifyJson);v.exportSymbol("utils.range",v.utils.range);v.exportSymbol("utils.toggleDomNodeCssClass",v.utils.toggleDomNodeCssClass);v.exportSymbol("utils.triggerEvent",v.utils.triggerEvent);v.exportSymbol("utils.unwrapObservable",v.utils.unwrapObservable);if(!Function.prototype.bind){Function.prototype.bind=function(y){var z=this,x=Array.prototype.slice.call(arguments),y=x.shift();return function(){return z.apply(y,x.concat(Array.prototype.slice.call(arguments)))}}}v.utils.domData=new (function(){var z=0;var x="__ko__"+(new Date).getTime();var y={};return{get:function(C,B){var A=v.utils.domData.getAll(C,false);return A===k?k:A[B]},set:function(C,B,D){if(D===k){if(v.utils.domData.getAll(C,false)===k){return}}var A=v.utils.domData.getAll(C,true);A[B]=D},getAll:function(D,C){var B=D[x];var A=B&&(B!=="null");if(!A){if(!C){return k}B=D[x]="ko"+z++;y[B]={}}return y[B]},clear:function(B){var A=B[x];if(A){delete y[A];B[x]=null}}}})();v.exportSymbol("utils.domData",v.utils.domData);v.exportSymbol("utils.domData.clear",v.utils.domData.clear);v.utils.domNodeDisposal=new (function(){var A="__ko_domNodeDisposal__"+(new Date).getTime();var C={1:true,8:true,9:true};var x={1:true,9:true};function D(F,E){var G=v.utils.domData.get(F,A);if((G===k)&&E){G=[];v.utils.domData.set(F,A,G)}return G}function B(E){v.utils.domData.set(E,A,k)}function z(G){var F=D(G,false);if(F){F=F.slice(0);for(var E=0;E<F.length;E++){F[E](G)}}v.utils.domData.clear(G);if((typeof jQuery=="function")&&(typeof jQuery.cleanData=="function")){jQuery.cleanData([G])}if(x[G.nodeType]){y(G)}}function y(E){var G,F=E.firstChild;while(G=F){F=G.nextSibling;if(G.nodeType===8){z(G)}}}return{addDisposeCallback:function(E,F){if(typeof F!="function"){throw new Error("Callback must be a function")}D(E,true).push(F)},removeDisposeCallback:function(F,G){var E=D(F,false);if(E){v.utils.arrayRemoveItem(E,G);if(E.length==0){B(F)}}},cleanNode:function(G){if(C[G.nodeType]){z(G);if(x[G.nodeType]){var H=[];v.utils.arrayPushAll(H,G.getElementsByTagName("*"));for(var F=0,E=H.length;F<E;F++){z(H[F])}}}},removeNode:function(E){v.cleanNode(E);if(E.parentNode){E.parentNode.removeChild(E)}}}})();v.cleanNode=v.utils.domNodeDisposal.cleanNode;v.removeNode=v.utils.domNodeDisposal.removeNode;v.exportSymbol("cleanNode",v.cleanNode);v.exportSymbol("removeNode",v.removeNode);v.exportSymbol("utils.domNodeDisposal",v.utils.domNodeDisposal);v.exportSymbol("utils.domNodeDisposal.addDisposeCallback",v.utils.domNodeDisposal.addDisposeCallback);v.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",v.utils.domNodeDisposal.removeDisposeCallback);(function(){var z=/^(\s*)<!--(.*?)-->/;function x(C){var B=v.utils.stringTrim(C).toLowerCase(),E=g.createElement("div");var D=B.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!B.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!B.indexOf("<td")||!B.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];var A="ignored<div>"+D[1]+C+D[2]+"</div>";if(typeof j.innerShiv=="function"){E.appendChild(j.innerShiv(A))}else{E.innerHTML=A}while(D[0]--){E=E.lastChild}return v.utils.makeArray(E.lastChild.childNodes)}function y(B){var A=jQuery.clean([B]);if(A&&A[0]){var C=A[0];while(C.parentNode&&C.parentNode.nodeType!==11){C=C.parentNode}if(C.parentNode){C.parentNode.removeChild(C)}}return A}v.utils.parseHtmlFragment=function(A){return typeof jQuery!="undefined"?y(A):x(A)};v.utils.setHtml=function(C,B){v.utils.emptyDomNode(C);if((B!==null)&&(B!==k)){if(typeof B!="string"){B=B.toString()}if(typeof jQuery!="undefined"){jQuery(C)["html"](B)}else{var D=v.utils.parseHtmlFragment(B);for(var A=0;A<D.length;A++){C.appendChild(D[A])}}}}})();v.exportSymbol("utils.parseHtmlFragment",v.utils.parseHtmlFragment);v.exportSymbol("utils.setHtml",v.utils.setHtml);v.memoization=(function(){var A={};function y(){return(((1+Math.random())*4294967296)|0).toString(16).substring(1)}function x(){return y()+y()}function z(B,F){if(!B){return}if(B.nodeType==8){var E=v.memoization.parseMemoText(B.nodeValue);if(E!=null){F.push({domNode:B,memoId:E})}}else{if(B.nodeType==1){for(var D=0,G=B.childNodes,C=G.length;D<C;D++){z(G[D],F)}}}}return{memoize:function(C){if(typeof C!="function"){throw new Error("You can only pass a function to ko.memoization.memoize()")}var B=x();A[B]=C;return"<!--[ko_memo:"+B+"]-->"},unmemoize:function(C,B){var D=A[C];if(D===k){throw new Error("Couldn't find any memo with ID "+C+". Perhaps it's already been unmemoized.")}try{D.apply(null,B||[]);return true}finally{delete A[C]}},unmemoizeDomNodeAndDescendants:function(E,H){var G=[];z(E,G);for(var D=0,C=G.length;D<C;D++){var F=G[D].domNode;var B=[F];if(H){v.utils.arrayPushAll(B,H)}v.memoization.unmemoize(G[D].memoId,B);F.nodeValue="";if(F.parentNode){F.parentNode.removeChild(F)}}},parseMemoText:function(C){var B=C.match(/^\[ko_memo\:(.*?)\]$/);return B?B[1]:null}}})();v.exportSymbol("memoization",v.memoization);v.exportSymbol("memoization.memoize",v.memoization.memoize);v.exportSymbol("memoization.unmemoize",v.memoization.unmemoize);v.exportSymbol("memoization.parseMemoText",v.memoization.parseMemoText);v.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",v.memoization.unmemoizeDomNodeAndDescendants);v.extenders={throttle:function(y,x){y.throttleEvaluation=x;var z=null;return v.dependentObservable({read:y,write:function(A){clearTimeout(z);z=setTimeout(function(){y(A)},x)}})},notify:function(x,y){x.equalityComparer=y=="always"?function(){return false}:v.observable.fn["equalityComparer"];return x}};function u(A){var z=this;if(A){for(var y in A){var x=v.extenders[y];if(typeof x=="function"){z=x(z,A[y])}}}return z}v.exportSymbol("extenders",v.extenders);v.subscription=function(y,z,x){this.target=y;this.callback=z;this.disposeCallback=x;v.exportProperty(this,"dispose",this.dispose)};v.subscription.prototype.dispose=function(){this.isDisposed=true;this.disposeCallback()};v.subscribable=function(){this._subscriptions={};v.utils.extend(this,v.subscribable.fn);v.exportProperty(this,"subscribe",this.subscribe);v.exportProperty(this,"extend",this.extend);v.exportProperty(this,"getSubscriptionsCount",this.getSubscriptionsCount)};var w="change";v.subscribable.fn={subscribe:function(B,y,A){A=A||w;var x=y?B.bind(y):B;var z=new v.subscription(this,x,function(){v.utils.arrayRemoveItem(this._subscriptions[A],z)}.bind(this));if(!this._subscriptions[A]){this._subscriptions[A]=[]}this._subscriptions[A].push(z);return z},notifySubscribers:function(x,y){y=y||w;if(this._subscriptions[y]){v.utils.arrayForEach(this._subscriptions[y].slice(0),function(z){if(z&&(z.isDisposed!==true)){z.callback(x)}})}},getSubscriptionsCount:function(){var y=0;for(var x in this._subscriptions){if(this._subscriptions.hasOwnProperty(x)){y+=this._subscriptions[x].length}}return y},extend:u};v.isSubscribable=function(x){return typeof x.subscribe=="function"&&typeof x.notifySubscribers=="function"};v.exportSymbol("subscribable",v.subscribable);v.exportSymbol("isSubscribable",v.isSubscribable);v.dependencyDetection=(function(){var x=[];return{begin:function(y){x.push({callback:y,distinctDependencies:[]})},end:function(){x.pop()},registerDependency:function(z){if(!v.isSubscribable(z)){throw new Error("Only subscribable things can act as dependencies")}if(x.length>0){var y=x[x.length-1];if(v.utils.arrayIndexOf(y.distinctDependencies,z)>=0){return}y.distinctDependencies.push(z);y.callback(z)}}}})();var o={"undefined":true,"boolean":true,number:true,string:true};v.observable=function(x){var y=x;function z(){if(arguments.length>0){if((!z.equalityComparer)||!z.equalityComparer(y,arguments[0])){z.valueWillMutate();y=arguments[0];if(i){z._latestValue=y}z.valueHasMutated()}return this}else{v.dependencyDetection.registerDependency(z);return y}}if(i){z._latestValue=y}v.subscribable.call(z);z.valueHasMutated=function(){z.notifySubscribers(y)};z.valueWillMutate=function(){z.notifySubscribers(y,"beforeChange")};v.utils.extend(z,v.observable.fn);v.exportProperty(z,"valueHasMutated",z.valueHasMutated);v.exportProperty(z,"valueWillMutate",z.valueWillMutate);return z};v.observable.fn={equalityComparer:function t(z,x){var y=(z===null)||(typeof(z) in o);return y?(z===x):false}};var r=v.observable.protoProperty="__ko_proto__";v.observable.fn[r]=v.observable;v.hasPrototype=function(x,y){if((x===null)||(x===k)||(x[r]===k)){return false}if(x[r]===y){return true}return v.hasPrototype(x[r],y)};v.isObservable=function(x){return v.hasPrototype(x,v.observable)};v.isWriteableObservable=function(x){if((typeof x=="function")&&x[r]===v.observable){return true}if((typeof x=="function")&&(x[r]===v.dependentObservable)&&(x.hasWriteFunction)){return true}return false};v.exportSymbol("observable",v.observable);v.exportSymbol("isObservable",v.isObservable);v.exportSymbol("isWriteableObservable",v.isWriteableObservable);v.observableArray=function(y){if(arguments.length==0){y=[]}if((y!==null)&&(y!==k)&&!("length" in y)){throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")}var x=v.observable(y);v.utils.extend(x,v.observableArray.fn);return x};v.observableArray.fn={remove:function(z){var C=this();var B=[];var x=typeof z=="function"?z:function(D){return D===z};for(var y=0;y<C.length;y++){var A=C[y];if(x(A)){if(B.length===0){this.valueWillMutate()}B.push(A);C.splice(y,1);y--}}if(B.length){this.valueHasMutated()}return B},removeAll:function(y){if(y===k){var z=this();var x=z.slice(0);this.valueWillMutate();z.splice(0,z.length);this.valueHasMutated();return x}if(!y){return[]}return this["remove"](function(A){return v.utils.arrayIndexOf(y,A)>=0})},destroy:function(z){var B=this();var x=typeof z=="function"?z:function(C){return C===z};this.valueWillMutate();for(var y=B.length-1;y>=0;y--){var A=B[y];if(x(A)){B[y]["_destroy"]=true}}this.valueHasMutated()},destroyAll:function(x){if(x===k){return this["destroy"](function(){return true})}if(!x){return[]}return this["destroy"](function(y){return v.utils.arrayIndexOf(x,y)>=0})},indexOf:function(x){var y=this();return v.utils.arrayIndexOf(y,x)},replace:function(z,y){var x=this["indexOf"](z);if(x>=0){this.valueWillMutate();this()[x]=y;this.valueHasMutated()}}};v.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(x){v.observableArray.fn[x]=function(){var z=this();this.valueWillMutate();var y=z[x].apply(z,arguments);this.valueHasMutated();return y}});v.utils.arrayForEach(["slice"],function(x){v.observableArray.fn[x]=function(){var y=this();return y[x].apply(y,arguments)}});v.exportSymbol("observableArray",v.observableArray);v.dependentObservable=function(A,G,y){var L,M=false,C=false,H=A;if(H&&typeof H=="object"){y=H;H=y.read}else{y=y||{};if(!H){H=y.read}}if(typeof H!="function"){throw new Error("Pass a function that returns the value of the ko.computed")}var z=y.write;if(!G){G=y.owner}var F=[];function J(){v.utils.arrayForEach(F,function(R){R.dispose()});F=[]}var Q=J;var I=(typeof y.disposeWhenNodeIsRemoved=="object")?y.disposeWhenNodeIsRemoved:null;var B=y.disposeWhen||function(){return false};if(I){Q=function(){v.utils.domNodeDisposal.removeDisposeCallback(I,arguments.callee);J()};v.utils.domNodeDisposal.addDisposeCallback(I,Q);var K=B;B=function(){return !v.utils.domNodeIsAttachedToDocument(I)||K()}}var D=null;function P(){var R=x.throttleEvaluation;if(R&&R>=0){clearTimeout(D);D=setTimeout(O,R)}else{O()}}function O(){if(C){return}if(M&&B()){Q();return}C=true;try{var T=v.utils.arrayMap(F,function(U){return U.target});v.dependencyDetection.begin(function(V){var U;if((U=v.utils.arrayIndexOf(T,V))>=0){T[U]=k}else{F.push(V.subscribe(P))}});var S=H.call(G);for(var R=T.length-1;R>=0;R--){if(T[R]){F.splice(R,1)[0].dispose()}}M=true;x.notifySubscribers(L,"beforeChange");L=S;if(i){x._latestValue=L}}finally{v.dependencyDetection.end()}x.notifySubscribers(L);C=false}function x(){if(arguments.length>0){E.apply(x,arguments)}else{return N()}}function E(){if(typeof z==="function"){z.apply(G,arguments)}else{throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")}}function N(){if(!M){O()}v.dependencyDetection.registerDependency(x);return L}x.getDependenciesCount=function(){return F.length};x.hasWriteFunction=typeof y.write==="function";x.dispose=function(){Q()};v.subscribable.call(x);v.utils.extend(x,v.dependentObservable.fn);if(y.deferEvaluation!==true){O()}v.exportProperty(x,"dispose",x.dispose);v.exportProperty(x,"getDependenciesCount",x.getDependenciesCount);return x};v.isComputed=function(x){return v.hasPrototype(x,v.dependentObservable)};var p=v.observable.protoProperty;v.dependentObservable[p]=v.observable;v.dependentObservable.fn={};v.dependentObservable.fn[p]=v.dependentObservable;v.exportSymbol("dependentObservable",v.dependentObservable);v.exportSymbol("computed",v.dependentObservable);v.exportSymbol("isComputed",v.isComputed);(function(){var y=10;v.toJS=function(B){if(arguments.length==0){throw new Error("When calling ko.toJS, pass the object you want to convert.")}return z(B,function(D){for(var C=0;v.isObservable(D)&&(C<y);C++){D=D()}return D})};v.toJSON=function(E,B,D){var C=v.toJS(E);return v.utils.stringifyJson(C,B,D)};function z(F,B,D){D=D||new A();F=B(F);var E=(typeof F=="object")&&(F!==null)&&(F!==k)&&(!(F instanceof Date));if(!E){return F}var C=F instanceof Array?[]:{};D.save(F,C);x(F,function(H){var G=B(F[H]);switch(typeof G){case"boolean":case"number":case"string":case"function":C[H]=G;break;case"object":case"undefined":var I=D.get(G);C[H]=(I!==k)?I:z(G,B,D);break}});return C}function x(D,E){if(D instanceof Array){for(var C=0;C<D.length;C++){E(C)}if(typeof D.toJSON=="function"){E("toJSON")}}else{for(var B in D){E(B)}}}function A(){var C=[];var B=[];this.save=function(E,F){var D=v.utils.arrayIndexOf(C,E);if(D>=0){B[D]=F}else{C.push(E);B.push(F)}};this.get=function(E){var D=v.utils.arrayIndexOf(C,E);return(D>=0)?B[D]:k}}})();v.exportSymbol("toJS",v.toJS);v.exportSymbol("toJSON",v.toJSON);(function(){var x="__ko__hasDomDataOptionValue__";v.selectExtensions={readValue:function(y){switch(v.utils.tagNameLower(y)){case"option":if(y[x]===true){return v.utils.domData.get(y,v.bindingHandlers.options.optionValueDomDataKey)}return y.getAttribute("value");case"select":return y.selectedIndex>=0?v.selectExtensions.readValue(y.options[y.selectedIndex]):k;default:return y.value}},writeValue:function(z,A){switch(v.utils.tagNameLower(z)){case"option":switch(typeof A){case"string":v.utils.domData.set(z,v.bindingHandlers.options.optionValueDomDataKey,k);if(x in z){delete z[x]}z.value=A;break;default:v.utils.domData.set(z,v.bindingHandlers.options.optionValueDomDataKey,A);z[x]=true;z.value=typeof A==="number"?A:"";break}break;case"select":for(var y=z.options.length-1;y>=0;y--){if(v.selectExtensions.readValue(z.options[y])==A){z.selectedIndex=y;break}}break;default:if((A===null)||(A===k)){A=""}z.value=A;break}}}})();v.exportSymbol("selectExtensions",v.selectExtensions);v.exportSymbol("selectExtensions.readValue",v.selectExtensions.readValue);v.exportSymbol("selectExtensions.writeValue",v.selectExtensions.writeValue);v.jsonExpressionRewriting=(function(){var C=/\@ko_token_(\d+)\@/g;var B=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i;var y=["true","false"];function x(D,F){var E=null;while(D!=E){E=D;D=D.replace(C,function(H,G){return F[G]})}return D}function A(D){if(v.utils.arrayIndexOf(y,v.utils.stringTrim(D).toLowerCase())>=0){return false}return D.match(B)!==null}function z(E){var D=v.utils.stringTrim(E);switch(D.length&&D.charAt(0)){case"'":case'"':return E;default:return"'"+D+"'"}}return{bindingRewriteValidators:[],parseObjectLiteral:function(Q){var N=v.utils.stringTrim(Q);if(N.length<3){return[]}if(N.charAt(0)==="{"){N=N.substring(1,N.length-1)}var K=[];var D=null,F;for(var U=0;U<N.length;U++){var S=N.charAt(U);if(D===null){switch(S){case'"':case"'":case"/":D=U;F=S;break}}else{if((S==F)&&(N.charAt(U-1)!=="\\")){var G=N.substring(D,U+1);K.push(G);var O="@ko_token_"+(K.length-1)+"@";N=N.substring(0,D)+O+N.substring(U+1);U-=(G.length-O.length);D=null}}}D=null;F=null;var T=0,J=null;for(var U=0;U<N.length;U++){var S=N.charAt(U);if(D===null){switch(S){case"{":D=U;J=S;F="}";break;case"(":D=U;J=S;F=")";break;case"[":D=U;J=S;F="]";break}}if(S===J){T++}else{if(S===F){T--;if(T===0){var G=N.substring(D,U+1);K.push(G);var O="@ko_token_"+(K.length-1)+"@";N=N.substring(0,D)+O+N.substring(U+1);U-=(G.length-O.length);D=null}}}}var H=[];var E=N.split(",");for(var R=0,P=E.length;R<P;R++){var L=E[R];var I=L.indexOf(":");if((I>0)&&(I<L.length-1)){var V=L.substring(0,I);var M=L.substring(I+1);H.push({key:x(V,K),value:x(M,K)})}else{H.push({unknown:x(L,K)})}}return H},insertPropertyAccessorsIntoJson:function(G){var M=typeof G==="string"?v.jsonExpressionRewriting.parseObjectLiteral(G):G;var D=[],L=[];var E;for(var I=0;E=M[I];I++){if(D.length>0){D.push(",")}if(E.key){var K=z(E.key),F=E.value;D.push(K);D.push(":");D.push(F);if(A(v.utils.stringTrim(F))){if(L.length>0){L.push(", ")}L.push(K+" : function(__ko_value) { "+F+" = __ko_value; }")}}else{if(E.unknown){D.push(E.unknown)}}}var H=D.join("");if(L.length>0){var J=L.join("");H=H+", '_ko_property_writers' : { "+J+" } "}return H},keyValueArrayContainsKey:function(D,F){for(var E=0;E<D.length;E++){if(v.utils.stringTrim(D[E]["key"])==F){return true}}return false},writeValueToProperty:function(G,H,D,F,E){if(!G||!v.isWriteableObservable(G)){var I=H()["_ko_property_writers"];if(I&&I[D]){I[D](F)}}else{if(!E||G()!==F){G(F)}}}}})();v.exportSymbol("jsonExpressionRewriting",v.jsonExpressionRewriting);v.exportSymbol("jsonExpressionRewriting.bindingRewriteValidators",v.jsonExpressionRewriting.bindingRewriteValidators);v.exportSymbol("jsonExpressionRewriting.parseObjectLiteral",v.jsonExpressionRewriting.parseObjectLiteral);v.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",v.jsonExpressionRewriting.insertPropertyAccessorsIntoJson);(function(){var z=g.createComment("test").text==="<!--test-->";var C=z?/^<!--\s*ko\s+(.*\:.*)\s*-->$/:/^\s*ko\s+(.*\:.*)\s*$/;var y=z?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/;var B={ul:true,ol:true};function x(G){return(G.nodeType==8)&&(z?G.text:G.nodeValue).match(C)}function D(G){return(G.nodeType==8)&&(z?G.text:G.nodeValue).match(y)}function A(G,J){var I=G;var K=1;var H=[];while(I=I.nextSibling){if(D(I)){K--;if(K===0){return H}}H.push(I);if(x(I)){K++}}if(!J){throw new Error("Cannot find closing comment tag to match: "+G.nodeValue)}return null}function E(G,H){var I=A(G,H);if(I){if(I.length>0){return I[I.length-1].nextSibling}return G.nextSibling}else{return null}}function F(J){var H=J.firstChild,I=null;if(H){do{if(I){I.push(H)}else{if(x(H)){var G=E(H,true);if(G){H=G}else{I=[H]}}else{if(D(H)){I=[H]}}}}while(H=H.nextSibling)}return I}v.virtualElements={allowedBindings:{},childNodes:function(G){return x(G)?A(G):G.childNodes},emptyNode:function(J){if(!x(J)){v.utils.emptyDomNode(J)}else{var I=v.virtualElements.childNodes(J);for(var H=0,G=I.length;H<G;H++){v.removeNode(I[H])}}},setDomNodeChildren:function(J,K){if(!x(J)){v.utils.setDomNodeChildren(J,K)}else{v.virtualElements.emptyNode(J);var G=J.nextSibling;for(var I=0,H=K.length;I<H;I++){G.parentNode.insertBefore(K[I],G)}}},prepend:function(G,H){if(!x(G)){if(G.firstChild){G.insertBefore(H,G.firstChild)}else{G.appendChild(H)}}else{G.parentNode.insertBefore(H,G.nextSibling)}},insertAfter:function(H,G,I){if(!x(H)){if(I.nextSibling){H.insertBefore(G,I.nextSibling)}else{H.appendChild(G)}}else{H.parentNode.insertBefore(G,I.nextSibling)}},firstChild:function(G){if(!x(G)){return G.firstChild}if(!G.nextSibling||D(G.nextSibling)){return null}return G.nextSibling},nextSibling:function(G){if(x(G)){G=E(G)}if(G.nextSibling&&D(G.nextSibling)){return null}return G.nextSibling},virtualNodeBindingValue:function(G){var H=x(G);return H?H[1]:null},normaliseVirtualElementDomStructure:function(K){if(!B[v.utils.tagNameLower(K)]){return}var I=K.firstChild;if(I){do{if(I.nodeType===1){var J=F(I);if(J){var G=I.nextSibling;for(var H=0;H<J.length;H++){if(G){K.insertBefore(J[H],G)}else{K.appendChild(J[H])}}}}}while(I=I.nextSibling)}}}})();v.exportSymbol("virtualElements",v.virtualElements);v.exportSymbol("virtualElements.allowedBindings",v.virtualElements.allowedBindings);v.exportSymbol("virtualElements.emptyNode",v.virtualElements.emptyNode);v.exportSymbol("virtualElements.insertAfter",v.virtualElements.insertAfter);v.exportSymbol("virtualElements.prepend",v.virtualElements.prepend);v.exportSymbol("virtualElements.setDomNodeChildren",v.virtualElements.setDomNodeChildren);(function(){var y="data-bind";v.bindingProvider=function(){this.bindingCache={}};v.utils.extend(v.bindingProvider.prototype,{nodeHasBindings:function(A){switch(A.nodeType){case 1:return A.getAttribute(y)!=null;case 8:return v.virtualElements.virtualNodeBindingValue(A)!=null;default:return false}},getBindings:function(C,A){var B=this["getBindingsString"](C,A);return B?this["parseBindingsString"](B,A):null},getBindingsString:function(B,A){switch(B.nodeType){case 1:return B.getAttribute(y);case 8:return v.virtualElements.virtualNodeBindingValue(B);default:return null}},parseBindingsString:function(E,A){try{var B=A["$data"],D=(typeof B=="object"&&B!=null)?[B,A]:[A],F=x(E,D.length,this.bindingCache);return F(D)}catch(C){throw new Error("Unable to parse bindings.\nMessage: "+C+";\nBindings value: "+E)}}});v.bindingProvider.instance=new v.bindingProvider();function x(C,B,A){var D=B+"_"+C;return A[D]||(A[D]=z(C,B))}function z(C,B){var A=" { "+v.jsonExpressionRewriting.insertPropertyAccessorsIntoJson(C)+" } ";return v.utils.buildEvalWithinScopeFunction(A,B)}})();v.exportSymbol("bindingProvider",v.bindingProvider);(function(){v.bindingHandlers={};v.bindingContext=function(D,C){if(C){v.utils.extend(this,C);this["$parentContext"]=C;this["$parent"]=C["$data"];this["$parents"]=(C["$parents"]||[]).slice(0);this["$parents"].unshift(this["$parent"])}else{this["$parents"]=[];this["$root"]=D}this["$data"]=D};v.bindingContext.prototype.createChildContext=function(C){return new v.bindingContext(C,this)};v.bindingContext.prototype.extend=function(C){var D=v.utils.extend(new v.bindingContext(),this);return v.utils.extend(D,C)};function B(D){var C=v.virtualElements.allowedBindings[D];if(!C){throw new Error("The binding '"+D+"' cannot be used with virtual elements")}}function z(D,G,C){var E,F=v.virtualElements.firstChild(G);while(E=F){F=v.virtualElements.nextSibling(E);y(D,E,C)}}function y(D,C,G){var H=true;var F=(C.nodeType===1);if(F){v.virtualElements.normaliseVirtualElementDomStructure(C)}var E=(F&&G)||v.bindingProvider.instance["nodeHasBindings"](C);if(E){H=x(C,null,D,G).shouldBindDescendants}if(H){z(D,C,!F)}}function x(F,D,H,C){var J=0;var G;function E(L){return function(){return G[L]}}function K(){return G}var I;v.dependentObservable(function(){var S=H&&(H instanceof v.bindingContext)?H:new v.bindingContext(v.utils.unwrapObservable(H));var P=S["$data"];if(C){v.storedBindingContextForNode(F,S)}var O=(typeof D=="function")?D():D;G=O||v.bindingProvider.instance["getBindings"](F,S);if(G){if(J===0){J=1;for(var N in G){var R=v.bindingHandlers[N];if(R&&F.nodeType===8){B(N)}if(R&&typeof R.init=="function"){var L=R.init;var M=L(F,E(N),K,P,S);if(M&&M.controlsDescendantBindings){if(I!==k){throw new Error("Multiple bindings ("+I+" and "+N+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")}I=N}}}J=2}if(J===2){for(var N in G){var R=v.bindingHandlers[N];if(R&&typeof R.update=="function"){var Q=R.update;Q(F,E(N),K,P,S)}}}}},null,{disposeWhenNodeIsRemoved:F});return{shouldBindDescendants:I===k}}var A="__ko_bindingContext__";v.storedBindingContextForNode=function(D,C){if(arguments.length==2){v.utils.domData.set(D,A,C)}else{return v.utils.domData.get(D,A)}};v.applyBindingsToNode=function(D,E,C){if(D.nodeType===1){v.virtualElements.normaliseVirtualElementDomStructure(D)}return x(D,E,C,true)};v.applyBindingsToDescendants=function(D,C){if(C.nodeType===1||C.nodeType===8){z(D,C,true)}};v.applyBindings=function(D,C){if(C&&(C.nodeType!==1)&&(C.nodeType!==8)){throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node")}C=C||j.document.body;y(D,C,true)};v.contextFor=function(D){switch(D.nodeType){case 1:case 8:var C=v.storedBindingContextForNode(D);if(C){return C}if(D.parentNode){return v.contextFor(D.parentNode)}break}return k};v.dataFor=function(D){var C=v.contextFor(D);return C?C["$data"]:k};v.exportSymbol("bindingHandlers",v.bindingHandlers);v.exportSymbol("applyBindings",v.applyBindings);v.exportSymbol("applyBindingsToDescendants",v.applyBindingsToDescendants);v.exportSymbol("applyBindingsToNode",v.applyBindingsToNode);v.exportSymbol("contextFor",v.contextFor);v.exportSymbol("dataFor",v.dataFor)})();var q=["click"];v.utils.arrayForEach(q,function(x){v.bindingHandlers[x]={init:function(A,B,C,z){var y=function(){var D={};D[x]=B();return D};return v.bindingHandlers.event["init"].call(this,A,y,C,z)}}});v.bindingHandlers.event={init:function(y,B,C,x){var z=B()||{};for(var A in z){(function(){var D=A;if(typeof D=="string"){v.utils.registerEventHandler(y,D,function(G){var J;var I=B()[D];if(!I){return}var H=C();try{var F=v.utils.makeArray(arguments);F.unshift(x);J=I.apply(x,F)}finally{if(J!==true){if(G.preventDefault){G.preventDefault()}else{G.returnValue=false}}}var E=H[D+"Bubble"]!==false;if(!E){G.cancelBubble=true;if(G.stopPropagation){G.stopPropagation()}}})}})()}}};v.bindingHandlers.submit={init:function(y,z,A,x){if(typeof z()!="function"){throw new Error("The value for a submit binding must be a function")}v.utils.registerEventHandler(y,"submit",function(B){var D;var C=z();try{D=C.call(x,y)}finally{if(D!==true){if(B.preventDefault){B.preventDefault()}else{B.returnValue=false}}}})}};v.bindingHandlers.visible={update:function(y,z){var A=v.utils.unwrapObservable(z());var x=!(y.style.display=="none");if(A&&!x){y.style.display=""}else{if((!A)&&x){y.style.display="none"}}}};v.bindingHandlers.enable={update:function(x,y){var z=v.utils.unwrapObservable(y());if(z&&x.disabled){x.removeAttribute("disabled")}else{if((!z)&&(!x.disabled)){x.disabled=true}}}};v.bindingHandlers.disable={update:function(x,y){v.bindingHandlers.enable["update"](x,function(){return !v.utils.unwrapObservable(y())})}};function l(z,y,x){if(x){if(y!==v.selectExtensions.readValue(z)){v.selectExtensions.writeValue(z,y)}}if(y!==v.selectExtensions.readValue(z)){v.utils.triggerEvent(z,"change")}}v.bindingHandlers.value={init:function(z,B,D){var A=["change"];var y=D()["valueUpdate"];if(y){if(typeof y=="string"){y=[y]}v.utils.arrayPushAll(A,y);A=v.utils.arrayGetDistinctValues(A)}var x=function(){var F=B();var G=v.selectExtensions.readValue(z);v.jsonExpressionRewriting.writeValueToProperty(F,D,"value",G,true)};var E=v.utils.ieVersion&&z.tagName.toLowerCase()=="input"&&z.type=="text"&&z.autocomplete!="off"&&(!z.form||z.form.autocomplete!="off");if(E&&v.utils.arrayIndexOf(A,"propertychange")==-1){var C=false;v.utils.registerEventHandler(z,"propertychange",function(){C=true});v.utils.registerEventHandler(z,"blur",function(){if(C){C=false;x()}})}v.utils.arrayForEach(A,function(F){var G=x;if(v.utils.stringStartsWith(F,"after")){G=function(){setTimeout(x,0)};F=F.substring("after".length)}v.utils.registerEventHandler(z,F,G)})},update:function(z,B){var y=v.utils.tagNameLower(z)==="select";var C=v.utils.unwrapObservable(B());var E=v.selectExtensions.readValue(z);var A=(C!=E);if((C===0)&&(E!==0)&&(E!=="0")){A=true}if(A){var D=function(){v.selectExtensions.writeValue(z,C)};D();var x=y;if(x){setTimeout(D,0)}}if(y&&(z.length>0)){l(z,C,false)}}};v.bindingHandlers.options={update:function(E,J,C){if(v.utils.tagNameLower(E)!=="select"){throw new Error("options binding applies only to SELECT elements")}var z=E.length==0;var K=v.utils.arrayMap(v.utils.arrayFilter(E.childNodes,function(O){return O.tagName&&(v.utils.tagNameLower(O)==="option")&&O.selected}),function(O){return v.selectExtensions.readValue(O)||O.innerText||O.textContent});var A=E.scrollTop;var M=v.utils.unwrapObservable(J());var I=E.value;while(E.length>0){v.cleanNode(E.options[0]);E.remove(0)}if(M){var H=C();if(typeof M.length!="number"){M=[M]}if(H.optionsCaption){var G=g.createElement("option");v.utils.setHtml(G,H.optionsCaption);v.selectExtensions.writeValue(G,k);E.appendChild(G)}for(var D=0,B=M.length;D<B;D++){var G=g.createElement("option");var L=typeof H.optionsValue=="string"?M[D][H.optionsValue]:M[D];L=v.utils.unwrapObservable(L);v.selectExtensions.writeValue(G,L);var x=H.optionsText;var N;if(typeof x=="function"){N=x(M[D])}else{if(typeof x=="string"){N=M[D][x]}else{N=L}}if((N===null)||(N===k)){N=""}v.utils.setTextContent(G,N);E.appendChild(G)}var y=E.getElementsByTagName("option");var F=0;for(var D=0,B=y.length;D<B;D++){if(v.utils.arrayIndexOf(K,v.selectExtensions.readValue(y[D]))>=0){v.utils.setOptionNodeSelectionState(y[D],true);F++}}E.scrollTop=A;if(z&&("value" in H)){l(E,v.utils.unwrapObservable(H.value),true)}v.utils.ensureSelectElementIsRenderedCorrectly(E)}}};v.bindingHandlers.options.optionValueDomDataKey="__ko.optionValueDomData__";v.bindingHandlers.selectedOptions={getSelectedValuesFromSelectNode:function(A){var x=[];var y=A.childNodes;for(var C=0,z=y.length;C<z;C++){var D=y[C],B=v.utils.tagNameLower(D);if(B=="option"&&D.selected){x.push(v.selectExtensions.readValue(D))}else{if(B=="optgroup"){var E=v.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(D);Array.prototype.splice.apply(x,[x.length,0].concat(E))}}}return x},init:function(x,y,z){v.utils.registerEventHandler(x,"change",function(){var B=y();var A=v.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this);v.jsonExpressionRewriting.writeValueToProperty(B,z,"value",A)})},update:function(A,C){if(v.utils.tagNameLower(A)!="select"){throw new Error("values binding applies only to SELECT elements")}var D=v.utils.unwrapObservable(C());if(D&&typeof D.length=="number"){var x=A.childNodes;for(var z=0,y=x.length;z<y;z++){var B=x[z];if(v.utils.tagNameLower(B)==="option"){v.utils.setOptionNodeSelectionState(B,v.utils.arrayIndexOf(D,v.selectExtensions.readValue(B))>=0)}}}}};v.bindingHandlers.text={update:function(x,y){v.utils.setTextContent(x,y())}};v.bindingHandlers.html={init:function(){return{controlsDescendantBindings:true}},update:function(x,y){var z=v.utils.unwrapObservable(y());v.utils.setHtml(x,z)}};v.bindingHandlers.css={update:function(y,A){var B=v.utils.unwrapObservable(A()||{});for(var z in B){if(typeof z=="string"){var x=v.utils.unwrapObservable(B[z]);v.utils.toggleDomNodeCssClass(y,z,x)}}}};v.bindingHandlers.style={update:function(z,A){var B=v.utils.unwrapObservable(A()||{});for(var y in B){if(typeof y=="string"){var x=v.utils.unwrapObservable(B[y]);z.style[y]=x||""}}}};v.bindingHandlers.uniqueName={init:function(x,y){if(y()){x.name="ko_unique_"+(++v.bindingHandlers.uniqueName.currentIndex);if(v.utils.isIe6||v.utils.isIe7){x.mergeAttributes(g.createElement("<input name='"+x.name+"'/>"),false)}}}};v.bindingHandlers.uniqueName.currentIndex=0;v.bindingHandlers.checked={init:function(x,z,A){var y=function(){var D;if(x.type=="checkbox"){D=x.checked}else{if((x.type=="radio")&&(x.checked)){D=x.value}else{return}}var B=z();if((x.type=="checkbox")&&(v.utils.unwrapObservable(B) instanceof Array)){var C=v.utils.arrayIndexOf(v.utils.unwrapObservable(B),x.value);if(x.checked&&(C<0)){B.push(x.value)}else{if((!x.checked)&&(C>=0)){B.splice(C,1)}}}else{v.jsonExpressionRewriting.writeValueToProperty(B,A,"checked",D,true)}};v.utils.registerEventHandler(x,"click",y);if((x.type=="radio")&&!x.name){v.bindingHandlers.uniqueName["init"](x,function(){return true})}},update:function(x,y){var z=v.utils.unwrapObservable(y());if(x.type=="checkbox"){if(z instanceof Array){x.checked=v.utils.arrayIndexOf(z,x.value)>=0}else{x.checked=z}}else{if(x.type=="radio"){x.checked=(x.value==z)}}}};var m={"class":"className","for":"htmlFor"};v.bindingHandlers.attr={update:function(y,A,D){var B=v.utils.unwrapObservable(A())||{};for(var x in B){if(typeof x=="string"){var C=v.utils.unwrapObservable(B[x]);var z=(C===false)||(C===null)||(C===k);if(z){y.removeAttribute(x)}if(v.utils.ieVersion<=8&&x in m){x=m[x];if(z){y.removeAttribute(x)}else{y[x]=C}}else{if(!z){y.setAttribute(x,C.toString())}}}}}};v.bindingHandlers.hasfocus={init:function(y,z,A){var x=function(C){var B=z();v.jsonExpressionRewriting.writeValueToProperty(B,A,"hasfocus",C,true)};v.utils.registerEventHandler(y,"focus",function(){x(true)});v.utils.registerEventHandler(y,"focusin",function(){x(true)});v.utils.registerEventHandler(y,"blur",function(){x(false)});v.utils.registerEventHandler(y,"focusout",function(){x(false)})},update:function(x,y){var z=v.utils.unwrapObservable(y());z?x.focus():x.blur();v.utils.triggerEvent(x,z?"focusin":"focusout")}};v.bindingHandlers["with"]={makeTemplateValueAccessor:function(x){return function(){var y=x();return{"if":y,data:y,templateEngine:v.nativeTemplateEngine.instance}}},init:function(z,A,B,y,x){return v.bindingHandlers.template["init"](z,v.bindingHandlers["with"].makeTemplateValueAccessor(A))},update:function(z,A,B,y,x){return v.bindingHandlers.template["update"](z,v.bindingHandlers["with"].makeTemplateValueAccessor(A),B,y,x)}};v.jsonExpressionRewriting.bindingRewriteValidators["with"]=false;v.virtualElements.allowedBindings["with"]=true;v.bindingHandlers["if"]={makeTemplateValueAccessor:function(x){return function(){return{"if":x(),templateEngine:v.nativeTemplateEngine.instance}}},init:function(z,A,B,y,x){return v.bindingHandlers.template["init"](z,v.bindingHandlers["if"].makeTemplateValueAccessor(A))},update:function(z,A,B,y,x){return v.bindingHandlers.template["update"](z,v.bindingHandlers["if"].makeTemplateValueAccessor(A),B,y,x)}};v.jsonExpressionRewriting.bindingRewriteValidators["if"]=false;v.virtualElements.allowedBindings["if"]=true;v.bindingHandlers.ifnot={makeTemplateValueAccessor:function(x){return function(){return{ifnot:x(),templateEngine:v.nativeTemplateEngine.instance}}},init:function(z,A,B,y,x){return v.bindingHandlers.template["init"](z,v.bindingHandlers.ifnot.makeTemplateValueAccessor(A))},update:function(z,A,B,y,x){return v.bindingHandlers.template["update"](z,v.bindingHandlers.ifnot.makeTemplateValueAccessor(A),B,y,x)}};v.jsonExpressionRewriting.bindingRewriteValidators.ifnot=false;v.virtualElements.allowedBindings.ifnot=true;v.bindingHandlers.foreach={makeTemplateValueAccessor:function(x){return function(){var y=v.utils.unwrapObservable(x());if((!y)||typeof y.length=="number"){return{foreach:y,templateEngine:v.nativeTemplateEngine.instance}}return{foreach:y.data,includeDestroyed:y.includeDestroyed,afterAdd:y.afterAdd,beforeRemove:y.beforeRemove,afterRender:y.afterRender,templateEngine:v.nativeTemplateEngine.instance}}},init:function(z,A,B,y,x){return v.bindingHandlers.template["init"](z,v.bindingHandlers.foreach.makeTemplateValueAccessor(A))},update:function(z,A,B,y,x){return v.bindingHandlers.template["update"](z,v.bindingHandlers.foreach.makeTemplateValueAccessor(A),B,y,x)}};v.jsonExpressionRewriting.bindingRewriteValidators.foreach=false;v.virtualElements.allowedBindings.foreach=true;v.templateEngine=function(){};v.templateEngine.prototype.renderTemplateSource=function(x,y,z){throw new Error("Override renderTemplateSource")};v.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(x){throw new Error("Override createJavaScriptEvaluatorBlock")};v.templateEngine.prototype.makeTemplateSource=function(y,x){if(typeof y=="string"){x=x||g;var z=x.getElementById(y);if(!z){throw new Error("Cannot find template with ID "+y)}return new v.templateSources.domElement(z)}else{if((y.nodeType==1)||(y.nodeType==8)){return new v.templateSources.anonymousTemplate(y)}else{throw new Error("Unknown template type: "+y)}}};v.templateEngine.prototype.renderTemplate=function(B,y,z,A){var x=this["makeTemplateSource"](B,A);return this["renderTemplateSource"](x,y,z)};v.templateEngine.prototype.isTemplateRewritten=function(y,x){if(this["allowTemplateRewriting"]===false){return true}var z=x&&x!=g;if(!z&&this.knownRewrittenTemplates&&this.knownRewrittenTemplates[y]){return true}return this["makeTemplateSource"](y,x)["data"]("isRewritten")};v.templateEngine.prototype.rewriteTemplate=function(A,y,z){var x=this["makeTemplateSource"](A,z);var B=y(x.text());x.text(B);x.data("isRewritten",true);var C=z&&z!=g;if(!C&&typeof A=="string"){this.knownRewrittenTemplates=this.knownRewrittenTemplates||{};this.knownRewrittenTemplates[A]=true}};v.exportSymbol("templateEngine",v.templateEngine);v.templateRewriting=(function(){var x=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi;var A=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;function z(B){var C=v.jsonExpressionRewriting.bindingRewriteValidators;for(var F=0;F<B.length;F++){var E=B[F]["key"];if(C.hasOwnProperty(E)){var D=C[E];if(typeof D==="function"){var G=D(B[F]["value"]);if(G){throw new Error(G)}}else{if(!D){throw new Error("This template engine does not support the '"+E+"' binding within its templates")}}}}}function y(D,C,E){var B=v.jsonExpressionRewriting.parseObjectLiteral(D);z(B);var G=v.jsonExpressionRewriting.insertPropertyAccessorsIntoJson(B);var F="ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {             return (function() { return { "+G+" } })()         })";return E.createJavaScriptEvaluatorBlock(F)+C}return{ensureTemplateIsRewritten:function(C,D,B){if(!D.isTemplateRewritten(C,B)){D.rewriteTemplate(C,function(E){return v.templateRewriting.memoizeBindingAttributeSyntax(E,D)},B)}},memoizeBindingAttributeSyntax:function(B,C){return B.replace(x,function(){return y(arguments[6],arguments[1],C)}).replace(A,function(){return y(arguments[1],"<!-- ko -->",C)})},applyMemoizedBindingsToNextSibling:function(B){return v.memoization.memoize(function(D,C){if(D.nextSibling){v.applyBindingsToNode(D.nextSibling,B,C)}})}}})();v.exportSymbol("templateRewriting",v.templateRewriting);v.exportSymbol("templateRewriting.applyMemoizedBindingsToNextSibling",v.templateRewriting.applyMemoizedBindingsToNextSibling);(function(){v.templateSources={};v.templateSources.domElement=function(y){this.domElement=y};v.templateSources.domElement.prototype.text=function(){var y=v.utils.tagNameLower(this.domElement),A=y==="script"?"text":y==="textarea"?"value":"innerHTML";if(arguments.length==0){return this.domElement[A]}else{var z=arguments[0];if(A==="innerHTML"){v.utils.setHtml(this.domElement,z)}else{this.domElement[A]=z}}};v.templateSources.domElement.prototype.data=function(y){if(arguments.length===1){return v.utils.domData.get(this.domElement,"templateSourceData_"+y)}else{v.utils.domData.set(this.domElement,"templateSourceData_"+y,arguments[1])}};var x="__ko_anon_template__";v.templateSources.anonymousTemplate=function(y){this.domElement=y};v.templateSources.anonymousTemplate.prototype=new v.templateSources.domElement();v.templateSources.anonymousTemplate.prototype.text=function(){if(arguments.length==0){var z=v.utils.domData.get(this.domElement,x)||{};if(z.textData===k&&z.containerData){z.textData=z.containerData.innerHTML}return z.textData}else{var y=arguments[0];v.utils.domData.set(this.domElement,x,{textData:y})}};v.templateSources.domElement.prototype.nodes=function(){if(arguments.length==0){var z=v.utils.domData.get(this.domElement,x)||{};return z.containerData}else{var y=arguments[0];v.utils.domData.set(this.domElement,x,{containerData:y})}};v.exportSymbol("templateSources",v.templateSources);v.exportSymbol("templateSources.domElement",v.templateSources.domElement);v.exportSymbol("templateSources.anonymousTemplate",v.templateSources.anonymousTemplate)})();(function(){var C;v.setTemplateEngine=function(E){if((E!=k)&&!(E instanceof v.templateEngine)){throw new Error("templateEngine must inherit from ko.templateEngine")}C=E};function z(H,F,G){var E,I=H,J=v.virtualElements.nextSibling(F);while(I&&((E=I)!==J)){I=v.virtualElements.nextSibling(E);if(E.nodeType===1||E.nodeType===8){G(E)}}}function A(F,E){if(F.length){var H=F[0],G=F[F.length-1];z(H,G,function(I){v.applyBindings(E,I)});z(H,G,function(I){v.memoization.unmemoizeDomNodeAndDescendants(I,[E])})}}function y(E){return E.nodeType?E:E.length>0?E[0]:null}function D(E,M,L,H,N){N=N||{};var J=E&&y(E);var F=J&&J.ownerDocument;var I=(N.templateEngine||C);v.templateRewriting.ensureTemplateIsRewritten(L,I,F);var K=I.renderTemplate(L,H,N,F);if((typeof K.length!="number")||(K.length>0&&typeof K[0].nodeType!="number")){throw new Error("Template engine must return an array of DOM nodes")}var G=false;switch(M){case"replaceChildren":v.virtualElements.setDomNodeChildren(E,K);G=true;break;case"replaceNode":v.utils.replaceDomNodes(E,K);G=true;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+M)}if(G){A(K,H);if(N.afterRender){N.afterRender(K,H["$data"])}}return K}v.renderTemplate=function(I,K,G,J,L){G=G||{};if((G.templateEngine||C)==k){throw new Error("Set a template engine before calling renderTemplate")}L=L||"replaceChildren";if(J){var H=y(J);var F=function(){return(!H)||!v.utils.domNodeIsAttachedToDocument(H)};var E=(H&&L=="replaceNode")?H.parentNode:H;return v.dependentObservable(function(){var N=(K&&(K instanceof v.bindingContext))?K:new v.bindingContext(v.utils.unwrapObservable(K));var M=typeof(I)=="function"?I(N["$data"]):I;var O=D(J,L,M,N,G);if(L=="replaceNode"){J=O;H=y(J)}},null,{disposeWhen:F,disposeWhenNodeIsRemoved:E})}else{return v.memoization.memoize(function(M){v.renderTemplate(I,K,G,M,"replaceNode")})}};v.renderTemplateForEach=function(J,K,H,L,F){var I;var G=function(O,N){var M=typeof(J)=="function"?J(O):J;I=F.createChildContext(v.utils.unwrapObservable(O));I["$index"]=N;return D(null,"ignoreTargetNode",M,I,H)};var E=function(N,O,M){A(O,I);if(H.afterRender){H.afterRender(O,N)}};return v.dependentObservable(function(){var M=v.utils.unwrapObservable(K)||[];if(typeof M.length=="undefined"){M=[M]}var N=v.utils.arrayFilter(M,function(O){return H.includeDestroyed||O===k||O===null||!v.utils.unwrapObservable(O._destroy)});v.utils.setDomNodeChildrenFromArrayMapping(L,N,G,H,E)},null,{disposeWhenNodeIsRemoved:L})};var x="__ko__templateSubscriptionDomDataKey__";function B(F,E){var G=v.utils.domData.get(F,x);if(G&&(typeof(G.dispose)=="function")){G.dispose()}v.utils.domData.set(F,x,E)}v.bindingHandlers.template={init:function(G,I){var E=v.utils.unwrapObservable(I());if((typeof E!="string")&&(!E.name)&&(G.nodeType==1||G.nodeType==8)){var H=G.nodeType==1?G.childNodes:v.virtualElements.childNodes(G),F=v.utils.moveCleanedNodesToContainerElement(H);new v.templateSources.anonymousTemplate(G)["nodes"](F)}return{controlsDescendantBindings:true}},update:function(G,I,F,M,H){var K=v.utils.unwrapObservable(I());var O;var E=true;if(typeof K=="string"){O=K}else{O=K.name;if("if" in K){E=E&&v.utils.unwrapObservable(K["if"])}if("ifnot" in K){E=E&&!v.utils.unwrapObservable(K.ifnot)}}var N=null;if((typeof K==="object")&&("foreach" in K)){var L=(E&&K.foreach)||[];N=v.renderTemplateForEach(O||G,L,K,G,H)}else{if(E){var J=(typeof K=="object")&&("data" in K)?H.createChildContext(v.utils.unwrapObservable(K.data)):H;N=v.renderTemplate(O||G,J,K,G)}else{v.virtualElements.emptyNode(G)}}B(G,N)}};v.jsonExpressionRewriting.bindingRewriteValidators.template=function(E){var F=v.jsonExpressionRewriting.parseObjectLiteral(E);if((F.length==1)&&F[0]["unknown"]){return null}if(v.jsonExpressionRewriting.keyValueArrayContainsKey(F,"name")){return null}return"This template engine does not support anonymous templates nested within its templates"};v.virtualElements.allowedBindings.template=true})();v.exportSymbol("setTemplateEngine",v.setTemplateEngine);v.exportSymbol("renderTemplate",v.renderTemplate);(function(){function x(M,O,B){var K=[];for(var E=0;E<=O.length;E++){K[E]=[]}for(var E=0,C=Math.min(M.length,B);E<=C;E++){K[0][E]=E}for(var E=1,C=Math.min(O.length,B);E<=C;E++){K[E][0]=E}var L,J=M.length,N,A=O.length;var I,D;for(L=1;L<=J;L++){var G=Math.max(1,L-B);var F=Math.min(A,L+B);for(N=G;N<=F;N++){if(M[L-1]===O[N-1]){K[N][L]=K[N-1][L-1]}else{var H=K[N-1][L]===k?Number.MAX_VALUE:K[N-1][L]+1;var z=K[N][L-1]===k?Number.MAX_VALUE:K[N][L-1]+1;K[N][L]=Math.min(H,z)}}}return K}function y(B,G,J){var F=G.length;var H=J.length;var D=[];var z=B[H][F];if(z===k){return null}while((F>0)||(H>0)){var E=B[H][F];var A=(H>0)?B[H-1][F]:z+1;var I=(F>0)?B[H][F-1]:z+1;var C=(H>0)&&(F>0)?B[H-1][F-1]:z+1;if((A===k)||(A<E-1)){A=z+1}if((I===k)||(I<E-1)){I=z+1}if(C<E-1){C=z+1}if((A<=I)&&(A<C)){D.push({status:"added",value:J[H-1]});H--}else{if((I<A)&&(I<C)){D.push({status:"deleted",value:G[F-1]});F--}else{D.push({status:"retained",value:G[F-1]});H--;F--}}}return D.reverse()}v.utils.compareArrays=function(C,z,A){if(A===k){return v.utils.compareArrays(C,z,1)||v.utils.compareArrays(C,z,10)||v.utils.compareArrays(C,z,Number.MAX_VALUE)}else{C=C||[];z=z||[];var B=x(C,z,A);return y(B,C,z)}}})();v.exportSymbol("utils.compareArrays",v.utils.compareArrays);(function(){function y(C){if(C.length>2){var D=C[0],A=C[C.length-1],B=[D];while(D!==A){D=D.nextSibling;if(!D){return}B.push(D)}Array.prototype.splice.apply(C,[0,C.length].concat(B))}}function z(A,D,G,F,C){var B=[];var E=v.dependentObservable(function(){var H=D(G,C)||[];if(B.length>0){y(B);v.utils.replaceDomNodes(B,H);if(F){F(G,H)}}B.splice(0,B.length);v.utils.arrayPushAll(B,H)},null,{disposeWhenNodeIsRemoved:A,disposeWhen:function(){return(B.length==0)||!v.utils.domNodeIsAttachedToDocument(B[0])}});return{mappedNodes:B,dependentObservable:E}}var x="setDomNodeChildrenFromArrayMapping_lastMappingResult";v.utils.setDomNodeChildrenFromArrayMapping=function(Y,F,G,B,K){F=F||[];B=B||{};var V=v.utils.domData.get(Y,x)===k;var J=v.utils.domData.get(Y,x)||[];var W=v.utils.arrayMap(J,function(ab){return ab.arrayEntry});var D=v.utils.compareArrays(W,F);var P=[];var Z=0;var N=[];var I=0;var M=[];var C=null;for(var T=0,S=D.length;T<S;T++){switch(D[T].status){case"retained":var aa=J[Z];aa.indexObservable(I);I=P.push(aa);if(aa.domNodes.length>0){C=aa.domNodes[aa.domNodes.length-1]}Z++;break;case"deleted":J[Z].dependentObservable.dispose();y(J[Z].domNodes);v.utils.arrayForEach(J[Z].domNodes,function(ab){N.push({element:ab,index:T,value:D[T].value});C=ab});Z++;break;case"added":var E=D[T].value;var X=v.observable(I);var O=z(Y,G,E,K,X);var L=O.mappedNodes;I=P.push({arrayEntry:D[T].value,domNodes:L,dependentObservable:O.dependentObservable,indexObservable:X});for(var U=0,H=L.length;U<H;U++){var R=L[U];M.push({element:R,index:T,value:D[T].value});if(C==null){v.virtualElements.prepend(Y,R)}else{v.virtualElements.insertAfter(Y,R,C)}C=R}if(K){K(E,L,X)}break}}v.utils.arrayForEach(N,function(ab){v.cleanNode(ab.element)});var Q=false;if(!V){if(B.afterAdd){for(var T=0;T<M.length;T++){B.afterAdd(M[T].element,M[T].index,M[T].value)}}if(B.beforeRemove){for(var T=0;T<N.length;T++){B.beforeRemove(N[T].element,N[T].index,N[T].value)}Q=true}}if(!Q&&N.length){for(var T=0;T<N.length;T++){var A=N[T].element;if(A.parentNode){A.parentNode.removeChild(A)}}}v.utils.domData.set(Y,x,P)}})();v.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",v.utils.setDomNodeChildrenFromArrayMapping);v.nativeTemplateEngine=function(){this["allowTemplateRewriting"]=false};v.nativeTemplateEngine.prototype=new v.templateEngine();v.nativeTemplateEngine.prototype.renderTemplateSource=function(x,y,z){var C=!(v.utils.ieVersion<9),D=C?x.nodes:null,A=D?x.nodes():null;if(A){return v.utils.makeArray(A.cloneNode(true).childNodes)}else{var B=x.text();return v.utils.parseHtmlFragment(B)}};v.nativeTemplateEngine.instance=new v.nativeTemplateEngine();v.setTemplateEngine(v.nativeTemplateEngine.instance);v.exportSymbol("nativeTemplateEngine",v.nativeTemplateEngine);(function(){v.jqueryTmplTemplateEngine=function(){var z=this.jQueryTmplVersion=(function(){if((typeof(jQuery)=="undefined")||!(jQuery.tmpl)){return 0}try{if(jQuery.tmpl["tag"]["tmpl"]["open"].toString().indexOf("__")>=0){return 2}}catch(B){}return 1})();function y(){if(z<2){throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}}function A(C,D,B){return jQuery.tmpl(C,D,B)}this["renderTemplateSource"]=function(C,D,E){E=E||{};y();var H=C.data("precompiled");if(!H){var G=C.text()||"";G="{{ko_with $item.koBindingContext}}"+G+"{{/ko_with}}";H=jQuery.template(null,G);C.data("precompiled",H)}var F=[D["$data"]];var B=jQuery.extend({koBindingContext:D},E.templateOptions);var I=A(H,F,B);I.appendTo(g.createElement("div"));jQuery.fragments={};return I};this["createJavaScriptEvaluatorBlock"]=function(B){return"{{ko_code ((function() { return "+B+" })()) }}"};this["addTemplate"]=function(B,C){g.write("<script type='text/html' id='"+B+"'>"+C+"<\/script>")};if(z>0){jQuery.tmpl["tag"]["ko_code"]={open:"__.push($1 || '');"};jQuery.tmpl["tag"]["ko_with"]={open:"with($1) {",close:"} "}}};v.jqueryTmplTemplateEngine.prototype=new v.templateEngine();var x=new v.jqueryTmplTemplateEngine();if(x.jQueryTmplVersion>0){v.setTemplateEngine(x)}v.exportSymbol("jqueryTmplTemplateEngine",v.jqueryTmplTemplateEngine)})()})})(window,document,navigator);c.observable=function(g){if(typeof(g)==="object"&&g.constructor==Array){return d.observableArray(g)}if(typeof(g)==="function"){return d.computed(g)}return d.observable(g)};c.applyBindings=function(g){if(!g.node){g.node=window.document.body}if(g.binding){d.applyBindingsToNode(g.node,g.binding,g.viewModel)}else{d.applyBindings(g.viewModel,g.node)}};c.inject=function(h){var i='<script id="'+h.id+'" type="text/html">';i+=h.content;i+="<\/script>";if(typeof h.target=="undefined"||h.target.toLowerCase()=="body"){var g=document.createElement("div");g.setAttribute("style","display:none;");document.body.appendChild(g);d.utils.setHtml(g,i)}else{var j=a.Sizzle(h.target)[0];d.utils.setHtml(j,i)}};c.clearNode=function(g){d.cleanNode(g)};c.bindingHandlers=d.bindingHandlers})(a.Templating=a.Templating||{})})(window.xRTML=window.xRTML||{});function guidGenerator(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())}(function(a,b){(function(j,g){var i=function(v){var y=this;var A=v.name||"";var w=v.namespace||"";var z=v.description||"";var B=v.properties||g;var r=v.methods||g;var x=v.events||g;var u=v.classes||g;var t=v.modules||g;this.Name=(function(){return A})();this.Namespace=(function(){return w})();this.Description=(function(){return z})();this.Properties=(function(){return B})();this.Methods=(function(){return r})();this.Events=(function(){return x})();this.Classes=(function(){return u})();this.Modules=(function(){return t})()};var d=function(u){var x=this;var A=u.name||"";var v=u.namespace||"";var B=u.base||g;var y=u.subclasses||g;var t=u.constructors||g;var z=u.description||"";var C=u.properties||g;var r=u.methods||g;var w=u.events||g;this.Name=(function(){return A})();this.Namespace=(function(){return v})();this.Base=(function(){return B})();this.Subclasses=(function(){return y})();this.Constructors=(function(){return t})();this.Description=(function(){return z})();this.Properties=(function(){return C})();this.Methods=(function(){return r})();this.Events=(function(){return w})();this.toString=function(){return(this.Namespace.length>0)?this.Namespace+"."+this.Name:this.Name};this.typeOf=u.typeOf||function(){return x.toString()}};var k=function(v){var t=v.name||"";var r=v.description||"";var w=v.mandatory||false;var u=v.type||g;this.Name=(function(){return t})();this.Description=(function(){return r})();this.Mandatory=(function(){return w})();this.Type=(function(){return u})()};var h=function(v){var u=v.name||"";var t=v.description||"";var w=v.arguments||"";var x=v["return"]||g;var r=v.exceptions||"";this.Name=(function(){return u})();this.Description=(function(){return t})();this.Arguments=(function(){return w})();this.Return=(function(){return x})();this.Exceptions=(function(){return r})()};var p=function(v){var t=v.name||"";var r=v.description||"";var w=v.mandatory||false;var u=v.type||g;this.Name=(function(){return t})();this.Description=(function(){return r})();this.Mandatory=(function(){return w})();this.Type=(function(){return u})()};var q=function(u){var r=u.name||"";var t=u.handler||g;this.Name=(function(){return r})();this.Handler=(function(){return t})()};var l=function(u){var t=u.name||"";var v=u.namespace||"";var r=u.description||"";var w=u.arguments||g;this.Name=(function(){return t})();this.Namespace=(function(){return v})();this.Description=(function(){return r})();this.Arguments=(function(){return w})()};var o={root:new i({name:"root",classes:{String:new d({name:"String",typeOf:function(){return"String"}}),Number:new d({name:"String",typeOf:function(){return"Number"}}),Boolean:new d({name:"String",typeOf:function(){return"Boolean"}}),Function:new d({name:"String",typeOf:function(){return"Function"}}),Array:new d({name:"String",typeOf:function(){return"Array"}}),Function:new d({name:"String",typeOf:function(){return"Function"}}),Date:new d({name:"String",typeOf:function(){return"Date"}}),Object:new d({name:"String",typeOf:function(){return"Object"}}),RegExp:new d({name:"String",typeOf:function(){return"RegExp"}}),Error:new d({name:"String",typeOf:function(){return"Error"}})},modules:{xRTML:new i({name:"xRTML",modules:{Tags:new i({name:"Tags",classes:new Object()})}}),Anonymous:new i({name:"Anonymous"})}})};var f={};var c=function(u,r,t){if(!f[u]){f[u]=new Array()}f[u].push({reference:r,propertyName:t})};j.fixUnresolvedTypes=function(){for(var u in f){var r=n(u);if(r){for(var t=0;t<f[u].length;t++){f[u][t].reference[f[u][t].propertyName]=r}delete f[u]}}for(var u in f){console.warn(u+" -> "+f[u].length)}};var m=function(u){if(u==g||u.length==0){return o.root}var t,v,w=u.lastIndexOf(".");if(w===-1){v=u}else{t=u.substring(0,w);v=u.substring(w+1)}var r=o.root;if(t!=g){r=m(t)}return r.Modules[v]};var n=function(u){var t,r,w=u.lastIndexOf(".");if(w===-1){r=u}else{t=u.substring(0,w);r=u.substring(w+1)}var v=o.root;if(t!=g){v=m(t)}return(v)?v.Classes[r]:g};j.registerModule=function(K){var I,y,r=K.name.lastIndexOf(".");if(r!=-1){K.namespace=K.name.substring(0,r);K.name=K.name.substring(r+1)}var H=new i({name:K.name,namespace:K.namespace,description:K.description});var y=m(K.namespace);if(!y.Modules){y.Modules={}}y.Modules[K.name]=H;for(var E=0;E<K.classes.length;E++){this.registerClass(K.classes[E])}var B={};for(var D in K.properties){var J=g;if(K.properties[D].type instanceof String||typeof(K.properties[D].type)=="string"){J=n(K.properties[D].type)}else{J=this.registerClass(K.properties[D].type)}B[D]=new k({name:D,description:K.properties[D].description,mandatory:K.properties[D].mandatory,type:J});if(!B[D].Type){c(K.properties[D],B[D],"Type")}}var v={};for(var G in K.methods){var w={};for(var L in K.methods[G].arguments){var u=g;if(K.methods[G].arguments[L].type instanceof String||typeof(K.methods[G].arguments[L].type)=="string"){u=n(K.methods[G].arguments[L].type)}else{u=this.registerClass(K.methods[G].arguments[L].type)}w[L]=new p({name:L,description:K.methods[G].arguments[L].description,mandatory:K.methods[G].arguments[L].mandatory,type:u});if(!w[L].Type){c(K.methods[G].arguments[L],w[L],"Type")}}var C={};for(var E=0;E<K.methods[G].exceptions.length;E++){if(K.methods[G].exceptions[E] instanceof String||typeof(K.methods[G].exceptions[E])=="string"){var F=n(K.methods[G].exceptions[E]);if(F!=g){C[F.toString()]=F}else{throw"Type "+K.methods[G].exceptions[E]+" is not defined"}}else{var F=this.registerClass(K.methods[G].exceptions[E]);C[F.toString()]=F}}var z={name:G,description:K.methods[G].description,arguments:w,exceptions:C};if(K.methods[G]["return"]){if(K.methods[G]["return"] instanceof String||typeof(K.methods[G]["return"])=="string"){z["return"]=n(K.methods[G]["return"])}else{z["return"]=this.registerClass(K.methods[G]["return"])}}v[G]=new h(z);if(K.methods[G]["return"]&&!v[G].Return){c(K.methods[G]["return"],v[G],"Return")}}var x={};for(var A in K.events){var t=g;if(K.events[A].type instanceof String||typeof(K.events[A].type)=="string"){t=n(K.events[A].handler)}else{t=this.registerHandler(K.events[A].handler)}x[A]=new q({name:A,description:K.events[A].description,handler:t})}H.Properties=B;H.Methods=v;H.Events=x;return H};j.registerClass=function(L){if(L.name==g){L.name=guidGenerator()}if(L.namespace==g){L.namespace="Anonymous"}var J=g;if(L["extends"]){J=n(L["extends"])}var C=function(P){var N={};for(var O in P){N[O]=P[O]}return N};var B=(J)?C(J.Properties):{};for(var E in L.properties){var K=g;if(L.properties[E].type instanceof String||typeof(L.properties[E].type)=="string"){K=n(L.properties[E].type)}else{K=this.registerClass(L.properties[E].type)}B[E]=new k({name:E,description:L.properties[E].description,mandatory:L.properties[E].mandatory,type:K});if(!B[E].Type){c(L.properties[E].type,B[E],"Type")}}var z=(J)?C(J.constructors):{};for(var H in L.constructors){var v={};for(var M in L.constructors[H].arguments){var t=g;if(L.constructors[H].arguments[M].type instanceof String||typeof(L.constructors[H].arguments[M].type)=="string"){t=n(L.constructors[H].arguments[M].type)}else{t=this.registerClass(L.constructors[H].arguments[M].type)}v[M]=new p({name:M,description:L.constructors[H].arguments[M].description,mandatory:L.constructors[H].arguments[M].mandatory,type:t});if(!v[M].Type){c(L.constructors[H].arguments[M].type,v[M],"Type")}}var D={};for(var F=0;F<L.constructors[H].exceptions.length;F++){if(L.constructors[H].exceptions[F] instanceof String||typeof(L.constructors[H].exceptions[F])=="string"){var G=n(L.constructors[H].exceptions[F]);D[G.toString()]=G;if(!D[G.toString()]){c(L.constructors[H].exceptions[F],D,G.toString())}}else{var G=this.registerClass(L.constructors[H].exceptions[F]);D[G.toString()]=G}}var y={name:H,description:L.constructors[H].description,arguments:v,exceptions:D};if(L.constructors[H]["return"]){if(L.constructors[H]["return"] instanceof String||typeof(L.constructors[H]["return"])=="string"){y["return"]=n(L.constructors[H]["return"])}else{y["return"]=this.registerClass(L.constructors[H]["return"])}}z[H]=new h(y);if(L.constructors[H]["return"]&&!z[H].Return){c(L.constructors[H]["return"],z[H],"Return")}}var u=(J)?C(J.Methods):{};for(var H in L.methods){var v={};for(var M in L.methods[H].arguments){var t=g;if(L.methods[H].arguments[M].type instanceof String||typeof(L.methods[H].arguments[M].type)=="string"){t=n(L.methods[H].arguments[M].type)}else{t=this.registerClass(L.methods[H].arguments[M].type)}v[M]=new p({name:M,description:L.methods[H].arguments[M].description,mandatory:L.methods[H].arguments[M].mandatory,type:t});if(!v[M].Type){c(L.methods[H].arguments[M].type,v[M],"Type")}}var D={};for(var F=0;F<L.methods[H].exceptions.length;F++){if(L.methods[H].exceptions[F] instanceof String||typeof(L.methods[H].exceptions[F])=="string"){var G=n(L.methods[H].exceptions[F]);D[G.toString()]=G;if(!D[G.toString()]){c(L.methods[H].exceptions[F],D,G.toString())}}else{var G=this.registerClass(L.methods[H].exceptions[F]);D[G.toString()]=G}}var y={name:H,description:L.methods[H].description,arguments:v,exceptions:D};if(L.methods[H]["return"]){if(L.methods[H]["return"] instanceof String||typeof(L.methods[H]["return"])=="string"){y["return"]=n(L.methods[H]["return"])}else{y["return"]=this.registerClass(L.methods[H]["return"])}}u[H]=new h(y);if(L.methods[H]["return"]&&!u[H].Return){c(L.methods[H]["return"],u[H],"Return")}}var x=(J)?C(J.Events):{};for(var A in L.events){var r=g;if(L.events[A].type instanceof String||typeof(L.events[A].type)=="string"){r=n(L.events[A].handler)}else{r=this.registerHandler(L.events[A].handler)}x[A]=new q({name:A,description:L.events[A].description,handler:r})}var I=new d({name:L.name,namespace:L.namespace,base:J,description:L.description,properties:B,constructors:z,methods:u,events:x});if(L["extends"]&&!I.Base){c(L["extends"],I,"Base")}var w=m(L.namespace);if(!w.Classes){w.Classes={}}w.Classes[L.name]=I;if(J){if(typeof J.Subclasses=="undefined"){J.Subclasses=new Object()}J.Subclasses[I.toString()]=I}return I};j.registerHandler=function(t){if(t.name==g){t.name=guidGenerator()}if(t.namespace==g){t.namespace="Anonymous"}var v={};for(var u in t.arguments){var x=g;if(t.arguments[u].type instanceof String||typeof(t.arguments[u].type)=="string"){x=n(t.arguments[u].type)}else{x=this.registerClass(t.arguments[u].type)}v[u]=new p({name:u,description:t.arguments[u].description,mandatory:t.arguments[u].mandatory,type:x});if(!v[u].Type){c(t.arguments[u].type,v[u],"Type")}}var r=new l({name:t.name,namespace:t.namespace,description:t.description,arguments:v});var w=m(t.namespace);if(!w.Classes){w.Classes={}}w.Classes[t.name]=r;return r};j.getClass=function(r){return n(r)};j.getModule=function(r){return(r)?m(r):o.root};j.validateProperties=function(t,u){var r=(t instanceof String||typeof(t)=="string")?n(t):t;for(var v in r.Properties){if(r.Properties[v].Mandatory==true&&u[v]===g){return false}if(r.Properties[v].Mandatory==false&&u[v]===g){continue}if(r.Properties[v].Type==j.get("Object")&&typeof(u[v])=="object"){continue}if(r.Properties[v].Type==j.get("String")){if(u[v] instanceof String||typeof(u[v])=="string"){continue}else{return false}}if(r.Properties[v].Type==j.get("Number")){if(!isNaN(parseFloat(u[v]))&&isFinite(u[v])){continue}else{return false}}if(r.Properties[v].Type==j.get("Boolean")){if(u[v] instanceof Boolean||typeof(u[v])=="boolean"){continue}else{return false}}if(r.Properties[v].Type==j.get("Array")){if(typeof(u[v])==="object"&&u[v].constructor==Array){continue}else{return false}}if(r.Properties[v].Type==j.get("Function")){if(u[v] instanceof Function){continue}else{return false}}if(j.validateProperties(r.Properties[v].Type,u[v])){continue}return false}return true}})(a.Metadata=a.Metadata||{})})(window.xRTML=window.xRTML||{});xRTML.TagManager.register({name:"Tag","abstract":true,struct:xRTML.Class.extend(new function(){this.init=function(a){xRTML.Event.extend(this);var b=xRTML.Common.Function.parse;this.bind({preInit:b(a.attribute("onPreInit")),postInit:b(a.attribute("onPostInit")),active:b(a.attribute("onActive")),preProcess:b(a.attribute("onPreProcess")),postProcess:b(a.attribute("onPostProcess")),dispose:b(a.attribute("onDispose"))});this.fire({preInit:{}});this.internalId=xRTML.Common.Util.guidGenerator();this.id=a.attribute("id")||this.internalId;this.connections=a.attribute("connections")||[];this.channelId=a.attribute("channelId");this.triggers=a.attribute("triggers")||[];this.receiveOwnMessages=!!a.attribute("receiveOwnMessages");this.target=(function(){var c=xRTML.Sizzle(a.attribute("target"));if(c.length==0){c.push(document.body)}return c})();this.active=a.attribute("active")?xRTML.Common.Converter.toBoolean(a.attribute("active")):true};this.activate=function(a){this.active=xRTML.Common.Converter.toBoolean(a.active);this.fire({active:{value:this.active}})};this.process=function(a){};this.sendMessage=function(a){xRTML.ConnectionManager.sendMessage({connections:a.connectionId?[a.connectionId]:this.connections,channel:a.channel||this.channelId,content:xRTML.MessageManager.create({trigger:this.triggers,action:a.action,data:a.data,senderId:this.internalId})})};this.dispose=function(){this.target=null;this.fire({dispose:{}})}})});xRTML.TagManager.register({name:"Media","abstract":true,struct:function(){var b=xRTML.Common.Function.proxy(function(){if(this.autoPlay&&this.sources.next()){this.play(this.sources.current())}},this);var a=xRTML.Common.Function.proxy(function(){if(this.autoPlay&&this.sources.current()){this.player.play(this.sources.current())}this.bind({ended:a});this.bind({ended:b})},this);this.init=function(c){this._super(c);xRTML.Common.Validator.validateRequired({target:this,prop:"channelId"});this.target=this.target[0];this.width=xRTML.Common.Converter.toNumber(c.attribute("width"))||null;this.height=xRTML.Common.Converter.toNumber(c.attribute("height"))||null;this.autoPlay=typeof c.attribute("autoPlay")=="undefined"?true:xRTML.Common.Converter.toBoolean(c.attribute("autoPlay"));this.loop=typeof c.attribute("loop")=="undefined"?true:xRTML.Common.Converter.toBoolean(c.attribute("loop"));this.controlsBar=xRTML.Common.Converter.toBoolean(c.attribute("controlsBar"))||false;this.muted=xRTML.Common.Converter.toBoolean(c.attribute("muted"))||false;this.loadStatus=0;this.sources=(function(){var h=[],i=-1;return{current:function(){return(h.length&&i!=-1)!=0?h[i]:null},currentIndex:function(){return i},next:function(){i=(++i)<h.length?i:0;return h.length!=0?h[i]:null},previous:function(){i=--i<0?(h.length-1):i;return h.length!=0?h[i]:null},insert:function(k,j){if(k&&j>0&&j<(h.length+1)){if(!(k instanceof Array)){k=[k]}for(var l=k.length-1;l>=0;--l){h.splice(j,0,k[l])}if(i!=-1&&j<i){i+=k.length}}},push:function(j){if(j){if(!(j instanceof Array)){j=[j]}h.push.apply(h,j)}},removeAt:function(j){var k=null;if(j>=0&&j<h.length){k=h.splice(j,1);if(i>h.length||j<i){--i}}return k},remove:function(n){for(var l=0;l<h.length;++l){var k=h[l],m=true;for(var j in n){if(!xRTML.Common.Object.equals(n[j],k[j])){m=false;break}}if(m){return this.removeAt(l)}}return null},pop:function(){return this.removeAt(h.length-1)},purge:function(){h=[];i=-1},length:function(){return h.length}}})();var f=this;this.players={};this.players.swf=function(h){xRTML.Event.extend(this);xRTML.Common.DOM.loadScript({url:"http://code.xrtml.org/plugins/swfobject.js",callback:xRTML.Common.Function.proxy(function(){this.isReady=true;this.fire({ready:{}})},this)});this.isReady=false;this.id=xRTML.Common.Util.idGenerator();this.target=h.target;this.width=h.width;this.height=h.height;this.supportedMedia={swf:this.canPlayType("swf")};function i(j){f.fire({loadedmetadata:{event:j,target:f}})}this.bind({loadedmetadata:i})};this.players.swf.prototype={play:function(m){if(!this.isReady){this.bind({ready:xRTML.Common.Function.proxy(function(){this.play(m)},this)});return}var j=m.files.swf;if(j){if(xRTML.Sizzle(this.id+" object").length>0){this.stop()}var l=document.createElement("span");l.id=this.id;this.target.appendChild(l);var h={},n={allowScriptAccess:"always",play:"true",loop:"true"},i={id:"FLVplayer_"+this.id,name:"FLVplayer_"+this.id,align:"middle"},k=xRTML.Common.Function.proxy(function(o){this.fire({loadedmetadata:o})},this);swfobject.embedSWF(j,this.id,this.width,this.height,"9.0.0",null,h,n,i,k);this.restart=function(){this.stop();this.play(m)}}},isPlaying:function(){return xRTML.Sizzle("#FLVplayer_"+this.id).length>0},stop:function(){if(typeof swfobject!="undefined"){swfobject.removeSWF("FLVplayer_"+this.id)}},pause:function(){},restart:function(){},skip:function(){},mute:function(){},volume:function(){},canPlayExtension:function(i){var h=this.supportedMedia[i];if(typeof h==="undefined"){return false}return this.canPlayType(h)},canPlayType:function(h){return h==="swf"},time:function(){return{current:0,duration:0}}};var d=function(j){this.id=xRTML.Common.Util.idGenerator();var p=document.createElement(j.type);p.id=this.id;p.width=j.width;p.height=j.height;p.poster=j.poster;p.autoplay=j.autoPlay;p.loop=j.loop;p.muted=j.muted;p.controls=j.controls;this.addPlayerDOM=function(){f.target.appendChild(p);xRTML.Event.bind(p,{progress:n});xRTML.Event.bind(p,{loadedmetadata:q});xRTML.Event.bind(p,{timeupdate:r});xRTML.Event.bind(p,{play:t});xRTML.Event.bind(p,{playing:k});xRTML.Event.bind(p,{pause:i});xRTML.Event.bind(p,{ended:h})};this.fallback=typeof f.players.swf==="function"?new f.players.swf(j):f.players.swf;this.supportedMedia={};for(var m in j.formats){this.supportedMedia[m]=p.canPlayType(j.formats[m])=="maybe"||p.canPlayType(j.formats[m])=="probably"}var o=this;function n(v){var u=v.target.buffered.length!=0?v.target.buffered.end(0):0;o.loadStatus=parseInt(((u/v.target.duration)*100))}xRTML.Event.bind(p,{progress:n});function q(u){f.duration=u.target.duration;f.currentTime=u.target.currentTime;if(j.keepRatio){u.target.height=u.target.videoHeight;u.target.width=u.target.videoWidth}if(u.target.paused){f.pause()}f.fire({loadedmetadata:{event:u,target:f}})}xRTML.Event.bind(p,{loadedmetadata:q});function r(u){f.currentTime=u.target.currentTime}xRTML.Event.bind(p,{timeupdate:r});function t(u){}xRTML.Event.bind(p,{play:t});function k(u){}xRTML.Event.bind(p,{playing:k});function i(u){}xRTML.Event.bind(p,{pause:i});function h(u){f.fire("ended",{file:u})}xRTML.Event.bind(p,{ended:h});function l(v){if(v.target.error!==null){var u="";switch(v.target.error.code){case v.target.error.MEDIA_ERR_ABORTED:u="You aborted the media playback.";break;case v.target.error.MEDIA_ERR_NETWORK:u="A network error caused the media download to fail part-way.";break;case v.target.error.MEDIA_ERR_DECODE:u="The media playback was aborted due to a corruption problem or because the media used features your browser did not support.";break;case v.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:u="The media could not be loaded, either because the server or network failed or because the format is not supported.";break;default:u="An unknown error occurred.";break}xRTML.Error.raise({code:xRTML.Error.Codes.UNEXPECTEDMEDIA,target:f,message:u,info:{className:"xRTML.TagManager.Media",methodName:"errorHandler (internal method, no docs available)"}})}}xRTML.Event.bind(p,{error:l});this.isReady=true};d.prototype={loadStatus:0,play:function(j){for(var i in j.files){if(this.supportedMedia[i]===true){var h=document.getElementById(this.id);if(!h){this.addPlayerDOM();h=document.getElementById(this.id)}h.autoplay=j.autoPlay===h.autoplay?h.autoplay:j.autoPlay;h.loop=j.loop===h.loop?h.loop:j.loop;h.src=j.files[i];h.load();h.play();xRTML.Console.debug("Playing file: "+j.files[i]);if(j.offset){this.offset(j.offset.start,j.offset.end)}return}}if(this.fallback&&j.files.swf){this.fallback.play(j)}else{document.getElementById(this.id).innerHTML="Your browser cannot play these movie types."}},stop:function(){var h=document.getElementById(this.id);h.currentTime=h.duration},pause:function(){var h=document.getElementById(this.id);h.paused?h.play():h.pause()},restart:function(){var h=document.getElementById(this.id);h.currentTime=0},skip:function(i){var h=document.getElementById(this.id);if(h.readyState>=h.HAVE_METADATA){h.currentTime=i}else{xRTML.Event.bind(h,{loadedmetadata:function(j){j.target.currentTime=i}})}},mute:function(){var h=document.getElementById(this.id);h.muted=!h.muted},volume:function(h){var i=document.getElementById(this.id);i.volume=h/100},isPlaying:function(){return document.getElementById(this.id).currentTime!=0},canPlayExtension:function(i){var h=this.supportedMedia[i];if(typeof h==="undefined"){return false}return this.canPlayType(h)},canPlayType:function(i){var j=document.getElementById(this.id),h=j.canPlayType(i);return((h=="maybe")||(h=="probably"))},time:function(){var h=document.getElementById(this.id);return{current:h.currentTime,duration:h.duration}},offset:function(k,h){var i=document.getElementById(this.id),j=function(m){i.currentTime=k;var l=function(){if(i.currentTime>=h){i.pause();xRTML.Event.unbind(i,{timeupdate:l})}};xRTML.Event.unbind(i,{timeupdate:l})};if(i.readyState>=i.HAVE_METADATA){j()}else{xRTML.Event.bind(i,{loadedmetadata:j})}}};this.bind({ended:b});var g={type:c.attribute("type")||{},formats:c.attribute("formats")||{},target:this.target,width:this.width,height:this.height,poster:this.poster,autoPlay:this.autoPlay,loop:this.loop,controls:this.controlsBar,muted:this.muted,keepRatio:this.keepRatio};xRTML.Common.Function.proxy(function(){if(document.createElement(g.type).canPlayType){var h=document.createElement(g.type),i;for(var j in g.formats){i=h.canPlayType(g.formats[j]);if((i=="maybe")||(i=="probably")){this.players[j]=d}}}},this)();this.players.get=function(h){for(var i in h){if(this[i]){if(typeof this[i]==="function"){this[i]=new this[i](g)}return this[i]}}}};this.play=function(d){if(this.target.hasChildNodes()){if(this.player){if(this.player.supportedMedia.swf){swfobject.removeSWF("FLVplayer_"+this.player.id)}else{if(this.player.supportedMedia.yt){swfobject.removeSWF("xrtml-video-ytplayer")}else{this.target.removeChild(this.target.lastChild)}}}}var c=null;if(d){c=d;if(d.playNow){this.player=this.players.get(d.files);this.player.play(d);this.unbind({ended:b});this.bind({ended:a})}else{this.sources.insert(d,this.sources.currentIndex()+1)}}else{if(this.sources.current()==null&&this.sources.length()!=0){c=this.sources.next()}else{this.sources.current().autoPlay=true;c=this.sources.current()}this.player=this.players.get(c.files);this.player.play(c)}this.fire({play:{source:c}})};this.stop=function(){this.player.stop();this.fire({stop:{}})};this.pause=function(){this.player.pause();this.fire({pause:{}})};this.restart=function(){this.player.restart();this.fire({restart:{}})};this.mute=function(){this.player.mute();this.fire({mute:{}})};this.volume=function(d){if(d&&d.volume){var c=typeof d.volume==="string"?parseInt(d.volume):d.volume;if(c>100){c=100}else{if(c<0){c=0}}this.player.volume(c);this.fire({volume:{volume:c}})}};this.skip=function(d){if(d&&d.skip){var c=typeof d.skip==="string"?parseInt(d.skip):d.skip;this.player.skip(c);this.fire({skip:{skip:c}})}};this.queue=function(c){if(c){this.sources.push(c);this.fire({queue:{sources:c}});if(this.autoPlay&&!this.isPlaying()){this.play()}}};this.unqueue=function(c){if(c){this.sources.remove(c);this.fire({unqueue:{source:c}})}};this.next=function(){this.play(this.sources.next())};this.previous=function(){this.play(this.sources.previous())};this.time=function(){return{duration:this.duration,currentTime:this.currentTime}};this.isPlaying=function(){return !!this.player&&this.player.isPlaying()}}});xRTML.TagManager.register({name:"Audio",base:"Media",struct:function(){this.init=function(a){a.type="audio";a.muted=false;a.formats={mp3:"audio/mpeg",ogg:"audio/ogg",aac:"audio/mp4",wav:"audio/wav",pcm:"audio/webm"};this._super(a);xRTML.Common.Validator.validateRequired({target:this,prop:"type"});xRTML.Common.Validator.validateRequired({target:this,prop:"formats"})}}});xRTML.TagManager.register({name:"Broadcast",struct:function(){var a=function(c){xRTML.Event.extend(this);var h,f=0;this.senderId=c.attribute("senderId");this.target=xRTML.Sizzle(c.attribute("target"));this.event=c.attribute("event");this.xrtmlmessage=c.attribute("xrtmlmessage");this.callback=xRTML.Common.Function.parse(c.attribute("callback"));this.interval=c.attribute("interval");this.limit=c.attribute("limit")||0;this.messageSource=xRTML.Sizzle(c.attribute("messageSource"));this.messageAttribute=c.attribute("messageAttribute");var g=c.attribute("onMessage");if(g){this.bind({message:g})}this.dispatchMessage=function(){var l=[];if(this.messageSource.length>0){var m={};if(typeof this.messageAttribute!="undefined"){m[this.messageAttribute]=xRTML.Common.String.trim(this.messageSource[0][this.messageAttribute])}else{m.content=xRTML.Common.String.trim(this.messageSource[0].value)}var n={trigger:"",action:"",data:m,senderId:this.senderId};l.push(xRTML.MessageManager.create(n))}else{if(this.callback!=null){var n=this.callback();n.senderId=typeof n.senderId=="undefined"?this.senderId:n.senderId;l.push(n)}if(this.xrtmlmessage){try{var n=xRTML.JSON.parse(this.xrtmlmessage).xrtml;l.push(xRTML.MessageManager.create({trigger:n.trigger,action:n.action,data:n.data,senderId:this.id}))}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.JSON_PARSE,target:thisxRTML.Error.raise({code:xRTML.Error.Codes.INVALID_DOM_ATTRIBUTE,target:this,info:{className:"xRTML.Tags."+this.name,methodName:"dispatchMessage"}})})}}}for(var j=0;j<l.length;++j){if(f==this.limit&&this.limit>0){clearInterval(h);return}this.fire({message:l[j]});f++}};if(this.target&&this.event){try{var b={};b[this.event]=xRTML.Common.Function.proxy(this.dispatchMessage,this);xRTML.Event.bind(this.target[0],b)}catch(d){xRTML.Error.raise({code:xRTML.Error.Codes.NON_EXISTING_ELEMENT,target:thisxRTML.Error.raise({code:xRTML.Error.Codes.INVALID_DOM_ATTRIBUTE,target:this,info:{className:"xRTML.Tags."+this.name,methodName:"dispatchMessage"}})})}}else{if(this.interval>0){h=setInterval(xRTML.Common.Function.proxy(this.dispatchMessage,this),this.interval)}else{this.dispatchMessage()}}};this.init=function(b){this._super(b);xRTML.Common.Validator.validateRequired({target:this,prop:"channelId"});xRTML.Common.Validator.validateRequired({target:this,prop:"connections"});xRTML.Common.Validator.validateRequired({target:this,prop:"triggers"});this.receiveOwnMessages=false;var d=b.attribute("dispatchers");for(var c=0;c<d.length;++c){d[c].attribute=b.attribute;d[c].senderId=this.id;d[c].onMessage=xRTML.Common.Function.proxy(this.sendMessage,this);new a(d[c])}}}});xRTML.TagManager.register({name:"Chart",struct:function(){var h=function(j){try{xRTML.Event.extend(this);this.title=j.title?j.title.text:null;this.subTitle=j.subTitle?j.subTitle.text:null;this.series=xRTML.Templating.observable(new Array());this.dataValuesTotal=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){var l=0;for(var m=0;m<this.series().length;m++){l+=(this.series()[m].value()||this.series()[m].value()[0])}return l},this));this.updateSerie=function(l,m){this.series()[l].value(m);this.fire({serieUpdate:{serie:this.series()[l],index:l}})};this.updateSeries=function(m){this.series(new Array());for(var l=0;l<m.length;l++){this.series.push(new c({name:m[l].name,value:m[l].data[0]||m[l].data,type:m[l].type},this.dataValuesTotal))}this.fire({seriesUpdate:{series:this.series()}})};this.incrementSerie=function(l,m){this.series()[l].value(this.series()[l].value()+m);this.fire({serieUpdate:{serie:this.series()[l],index:l}})};if(j.series){this.updateSeries(j.series)}}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.UNEXPECTED,info:{className:"xRTML.Tags.Chart",methodName:"init",message:k.message}})}},c=function(j,k){this.name=j.name;this.value=xRTML.Templating.observable(j.value);this.type=j.type;this.percentage=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){return this.value()/k()*100},this))},b,g={column:{update:function(j){a.series[j.index].data[0].update(parseInt(j.value()))},add:function(j){a.series.push(j.serie)}},pie:{update:function(j){a.series[0].data[j.index].update([j.name,j.value()])},add:function(j){a.series.push(j.serie)}}},a,d=function(){b=new h(this.settings);if(this.chartingPlatform=="highcharts"){if(Highcharts){if(!this.settings.chart.events){this.settings.chart.events={}}this.settings.chart.events.load=xRTML.Common.Function.proxy(function(){this.fire({rendered:{}})},this);a=new Highcharts.Chart(this.settings);var m=xRTML.Sizzle('svg text tspan:contains("Highcharts") , svg text tspan:contains("Highstock")');if(m){for(var k=0,j=m.length;k<j;k++){m[k].style.display="none"}}this.bind({serieUpdate:xRTML.Common.Function.proxy(function(n){g[this.type].update({index:n.index,name:n.serie.name,value:n.serie.value})},this),seriesUpdate:xRTML.Common.Function.proxy(function(p){var o=[];for(var n=0;n<p.series.length;n++){o.push({type:p.series[n].type,name:p.series[n].name,data:[p.series[n].value()]})}this.settings.series=o;a=new Highcharts.Chart(this.settings)},this)})}else{xRTML.Error.raise({code:xRTML.Error.Codes.TAG_INVALID_CONFIG,target:this,info:{message:"The chartingPlatform highcharts requires that the relevant libraries are imported.",className:"xRTML.Tags."+this.name,methodName:"init"}})}}else{if(typeof this.template=="undefined"){var l='<div class="xrtml-chart">';l+='<h1 data-bind="text:title"></h1>';l+='<h2 data-bind="text:subTitle"></h2>';l+='<div class="values">';l+='    <ul class="graph" data-bind="foreach: series">';l+="        <li><span data-bind=\"text:value, style:{ paddingTop: (percentage()*2)+'px' }\"></span></li>";l+="    </ul>";l+="</div>";l+='<div class="items">';l+="    <strong>Items</strong>";l+='    <ul data-bind="foreach: series">';l+='        <li><span data-bind="text:name"></span></li>';l+="    </ul>";l+='    <ul data-bind="foreach: series">';l+="        <li><span data-bind=\"text:Math.round( percentage() * Math.pow(10,0))/Math.pow(10,0)+'%'\"></span></li>";l+="    </ul>";l+="</div>";l+="</div>";this.template="xRTML-Chart-Template";xRTML.Templating.inject({id:this.template,content:l})}xRTML.Templating.applyBindings({node:this.targetElement,binding:{template:{name:this.template,data:b,afterRender:xRTML.Common.Function.proxy(function(o,n){this.fire({rendered:{}})},this)}}});this.bind({serieUpdate:xRTML.Common.Function.proxy(function(n){this.runEffects({element:xRTML.Sizzle(this.valuesTarget)[n.index]})},this)})}},f=function(j){b.bind({serieUpdate:xRTML.Common.Function.proxy(function(k){this.fire({serieUpdate:k})},this),seriesUpdate:xRTML.Common.Function.proxy(function(k){this.fire({seriesUpdate:k})},this)});b.bind({serieUpdate:xRTML.Common.Function.parse(j.onSerieUpdate),seriesUpdate:xRTML.Common.Function.parse(j.onSeriesUpdate),rendered:xRTML.Common.Function.parse(j.onRendered)})},i;this.init=function(j){this._super(j);this.effects=j.attribute("effects");xRTML.Effect.extend(this);this.settings=j.attribute("settings");this.targetElement=(this.settings&&this.settings.chart&&this.settings.chart.renderTo)?xRTML.Sizzle("#"+this.settings.chart.renderTo)[0]:(!!j.attribute("target")?this.target[0]:xRTML.Sizzle("#"+args.template)[0].parentNode.insertBefore(document.createElement("div"),xRTML.Sizzle("#"+args.template)[0]));this.valuesTarget=j.attribute("valuesTarget")||".values li span";this.type=j.attribute("type")?j.attribute("type"):((this.settings&&this.settings.chart&&this.settings.chart.type)?this.settings.chart.type:((this.settings&&this.settings.series&&this.settings.series[0].type)?this.settings.series[0].type:null));this.chartingPlatform=typeof j.attribute("chartingPlatform")!="undefined"?j.attribute("chartingPlatform"):"htmlchart";this.template=j.attribute("template");this.storageId=j.attribute("storageId");this.storageKey=j.attribute("storageKey");if(this.storageId){i=xRTML.StorageManager.getById(this.storageId)}var k={onSerieUpdate:j.attribute("onSerieUpdate"),onSeriesUpdate:j.attribute("onSeriesUpdate"),onRendered:j.attribute("onRendered")};if(i){i.get({namespace:"Charts",k:this.storageKey+"#settings"},xRTML.Common.Function.proxy(function(l){if(l.success){this.settings=xRTML.JSON.parse(l.data.resultData);d.call(this);f.call(this,k)}},this))}else{d.call(this);f.call(this,k)}};this.increment=function(j){b.incrementSerie(j.index,j.incrementBy)};this.update=function(j){b.updateSerie(j.index,j.value)};this.updateSeries=function(j){b.updateSeries(j.series)}}});xRTML.TagManager.register({name:"Execute",struct:function(){this.init=function(a){this._super(a);this.callback=xRTML.Common.Function.parse(a.attribute("callback"),"message")};this.process=function(a){var b=a.callback?xRTML.Common.Function.parse(a.callback,"data"):this.callback;(typeof b=="function")?b(a):xRTML.Error.raise({code:xRTML.Error.Codes.TAG_PROCESS,target:this,info:{message:'The property "callback" is not defined in the Tag nor in the message.',className:"xRTML.Tags."+this.name,methodName:"process"}})}}});xRTML.TagManager.register({name:"Placeholder",struct:function(){this.init=function(a){this._super(a);this.template=a.attribute("template");if(!this.template){xRTML.Console.error("Placeholder tag requires one and only one xrtml:template tag.")}};this.insert=function(b){try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,data:b}}})}catch(a){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:a.message,className:"xRTML.Tags."+this.name,methodName:"insert"}})}}}});xRTML.TagManager.register({name:"Poll",struct:function(){var l=function(o){var m=o.userId,q=o.storageKey,p=o.id?xRTML.StorageManager.getById(o.id):null,n="Polls";this.saveVote=function(r,t){p.incr({namespace:n,pair:{k:q+"#items#"+r+"#data",v:1}},function(u){if(!u.success){xRTML.Console.error("There was an error while trying to increment the vote in the Storage.")}});p.incr({namespace:n,pair:{k:q+"#user#"+m,v:1}},function(u){if(!u.success){xRTML.Console.error("There was an error while trying to increment the vote in the Storage.")}});a(m,k(m)+1)};this.getUserVotes=function(r){p.get({namespace:n,k:q+"#user#"+m},function(t){if(t.success){r(t.data.resultData?parseInt(t.data.resultData):0)}})};this.saveVoteItems=function(r){p.set({namespace:n,pair:{k:q+"#itemCount",v:r.length}},function(t){if(t.success){var v=[];for(var u=0;u<r.length;++u){v.push({k:q+"#items#"+u+"#id",v:r[u].id||u});v.push({k:q+"#items#"+u+"#name",v:r[u].name});v.push({k:q+"#items#"+u+"#data",v:r[u].data})}p.set({namespace:n,pairs:v},function(w){if(!w.success){xRTML.Console.error("There was an error while trying to save the votes in the Storage.")}})}})};this.getVoteItems=function(r){p.get({namespace:n,k:q+"#itemCount"},function(t){var v=[];if(t.success){if(t.data.resultData!=null){var x=parseInt(t.data.resultData),w=[];for(var u=0;u<x;u++){w.push(q+"#items#"+u+"#id");w.push(q+"#items#"+u+"#name");w.push(q+"#items#"+u+"#data")}p.get({namespace:n,ks:w},function(y){if(y.success&&y.data.resultData!=null){if(y.data.resultData[0]!=null){for(var z=0;z<y.data.resultData.length;z=z+3){v.push({id:y.data.resultData[z],name:y.data.resultData[z+1],data:parseInt(y.data.resultData[z+2])})}}r(v)}})}else{r(v)}}})}},g,j=function(m){this.id=m.id||0;this.name=m.name||"";this.data=xRTML.Templating.observable(m.data||0);this.target=m.target||""},i,b=function(m){xRTML.Event.extend(this);votesAllowed=m.votesAllowed?xRTML.Common.Converter.toNumber(m.votesAllowed):1;userVotes=xRTML.Templating.observable(!!m.userVotes?Number(m.userVotes):0);this.canVote=xRTML.Templating.observable(function(){return votesAllowed>userVotes()});this.voteClick=xRTML.Common.Function.proxy(function(p){if(this.canVote()){userVotes(userVotes()+1);p.data(p.data()+1);i({action:"vote",data:{i:p.id}});if(g){g.saveVote(p.id)}if(h){h.incrementSingleDataItem({i:p.id,d:0,v:1})}this.fire({ownervote:{item:p,allowed:this.canVote(),index:p.id}})}},this);this.voteItems=new Array();for(var n=0;n<m.voteItems.length;++n){var o=m.voteItems[n];o.id=parseInt(n);if(typeof o.data==="undefined"||isNaN(o.data)){o.data=0}this.voteItems.push(new j(m.voteItems[n]))}this.vote=function(p){this.voteItems[p].data(this.voteItems[p].data()+1);if(h){h.incrementSingleDataItem({i:p,d:0,v:1})}this.fire({vote:{item:this.voteItems[p],allowed:true,index:p}})}},f,d=function(m){xRTML.Templating.applyBindings({node:m.targetNode,binding:{template:{name:m.template,data:m.model,afterRender:xRTML.Common.Function.proxy(function(){this.fire({rendered:{}})},this)}}});f.bind({vote:xRTML.Common.Function.parse(m.onVote),ownervote:xRTML.Common.Function.parse(m.onOwnerVote),rendered:xRTML.Common.Function.parse(m.onRendered)});f.bind({vote:xRTML.Common.Function.proxy(function(n){this.fire({vote:n})},this),ownervote:xRTML.Common.Function.proxy(function(n){this.fire({ownervote:n})},this)})},c=function(n){var m;if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){m=localStorage.getItem("d734h89nU_"+n)||(localStorage.setItem("d734h89nU_"+n,xRTML.Common.Util.idGenerator(),localStorage.getItem("d734h89nU_"+n)))}else{m=xRTML.Common.Cookie.getCookie({name:"d734h89nU_"+n})||(xRTML.Common.Cookie.setCookie({name:"d734h89nU_"+n,expiry:new Date(new Date().getTime()+315576000000)}),xRTML.Common.Cookie.getCookie({name:"d734h89nU_"+n}))}return m},k=function(m){var n;if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){n=localStorage.getItem("d734h89nV_"+m)||0}else{n=xRTML.Common.Cookie.getCookie({name:"d734h89nV_"+m})||0}return n},a=function(m,n){if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){localStorage.setItem("d734h89nV_"+m,n)}else{xRTML.Common.Cookie.setCookie({name:"d734h89nV_"+m,value:n})}},h;this.init=function(m){this._super(m);this.storageId=m.attribute("storageId");this.storageKey=m.attribute("storageKey");if(this.storageId){g=new l({id:this.storageId,storageKey:this.storageKey||this.id,userId:(m.attribute("userId")||c(this.id))})}var q=m.attribute("template"),t=this.target[0];if(!t){if(typeof q!="undefined"){var p=xRTML.Sizzle("#"+q)[0];t=p.parentNode.insertBefore(document.createElement("div"),p)}else{}}if(typeof q=="undefined"){var o='<div class="poll" id="poll1">';o+='    <div class="hgroup">';o+="        <h2>Poll</h2>";o+="       <h6>Powered by IBT's xRTML</h6>";o+="    </div>";o+='    <div class="bars">';o+='        <div class="graph" data-bind="foreach: voteItems">';o+='            <span data-bind="text: data"></span>';o+="        </div>";o+="    </div>";o+='    <div class="labels" data-bind="foreach: voteItems">';o+='        <label data-bind="text: name"></label>';o+="    </div>";o+='    <div class="vote" data-bind="foreach: voteItems, visible: canVote()">';o+='        <a href="javascript:return false;" data-bind="click: $parent.voteClick">Vote</a>';o+="    </div>";o+='    <div class="vote" data-bind="visible: !canVote()">';o+="        <span>Cannot vote again.</span>";o+="    </div>";o+="</div>";q="xRTML-Poll-Template";xRTML.Templating.inject({id:q,content:o})}this.votesAllowed=m.attribute("votesAllowed")||1;var n=m.attribute("voteItems");if(g){g.getUserVotes(xRTML.Common.Function.proxy(function(u){g.getVoteItems(xRTML.Common.Function.proxy(function(v){f=new b({voteItems:(v&&v.length>0)?v:(g.saveVoteItems(n),n),votesAllowed:this.votesAllowed,userVotes:u});d.call(this,{targetNode:t,model:f,template:q,onVote:m.attribute("onVote"),onOwnerVote:m.attribute("onOwnerVote"),onRendered:m.attribute("onRendered")})},this))},this))}else{f=new b({voteItems:n,votesAllowed:this.votesAllowed,userVotes:k(m.attribute("userId")||c(this.id))});d.call(this,{targetNode:t,model:f,template:q,onVote:m.attribute("onVote"),onOwnerVote:m.attribute("onOwnerVote"),onRendered:m.attribute("onRendered")})}var r=m.attribute("chartSettings");if(r){h=xRTML.TagManager.create({name:"Chart",settings:r,chartingplatform:"highcharts"})}i=xRTML.Common.Function.proxy(function(u){this.sendMessage(u)},this)};this.vote=function(m){f.vote(m.i)}}});xRTML.TagManager.register({name:"Repeater",struct:function(){var c=function(g){this.MaxItems=g;this.Items=xRTML.Templating.observable(new Array());this.add=function(j,h,i){if(this.Items().length==this.MaxItems){this.remove((!i)?this.Items().length-1:i)}if(h===-1){this.Items.push(j)}else{this.Items.splice(h,0,j)}};this.update=function(i,h){if(h<this.Items().length){this.remove(h);this.add(i,h,-1)}};this.remove=function(h){if(h==-1||h>this.Items().length){h=this.Items().length-1}this.Items.splice(h,1)}};var d=undefined;var a=function(g){if((!isNaN(parseInt(g)))&&isFinite(g)&&g>=0){return g}return undefined};var f=function(h,g){if((!isNaN(parseFloat(h)))&&isFinite(h)&&h>=0){return parseInt(h)}return g};var b=function(g,h){var i=f(g,undefined);if(i){return i}var j={begin:0,end:-1};return j.hasOwnProperty(g)?j[g]:h};this.init=function(g){this._super(g);this.template=g.attribute("template");xRTML.Common.Validator.validateRequired({target:this,prop:"template"});this.effects=g.attribute("effects");xRTML.Effect.extend(this);this.index=b(g.attribute("index"),0);this.removeIndex=b(g.attribute("removeIndex"),-1);this.maxItems=f(g.attribute("maxItems"),Number.POSITIVE_INFINITY);d=new c(this.maxItems);try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,foreach:d.Items,afterRender:xRTML.Common.Function.proxy(function(l,k){for(var j=0;j<l.length;j++){if(l[j].nodeName!="#text"){this.runEffects({element:l[j]})}}},this)}}})}catch(h){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:h.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.insert=function(h){try{d.add(h.content,b(h.index,this.index),b(h.removeIndex,this.removeIndex))}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.update=function(h){try{this.effectManager.stopAllEffectsAndClearQueue();d.update(h.content,b(h.index,this.index));this.effectManager.runAllEffects()}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.remove=function(h){try{d.remove(b(h.removeIndex,this.removeIndex))}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}}}});xRTML.TagManager.register({name:"Shoutbox",struct:function(){var i=function(j){if(typeof j!="undefined"){this.id=j.id?j.id:xRTML.Common.Util.guidGenerator();this.name=typeof j.name!="undefined"&&j.name!=""?xRTML.Templating.observable(j.name):xRTML.Templating.observable("Write a username...");this.logged=typeof j.logged!="undefined"?xRTML.Templating.observable(j.logged):xRTML.Templating.observable(false)}else{this.id=xRTML.Common.Util.guidGenerator();this.name=xRTML.Templating.observable("Write a username...");this.logged=xRTML.Templating.observable(false)}this.isTyping=xRTML.Templating.observable(false)},c=function(j){this.content=j.content;this.name=j.name;this.date=j.date?new Date(j.date):new Date().toString()},f=function(j){xRTML.Event.extend(this);this.shoutboxContainer=j.shoutboxContainer;var l=xRTML.Common.DOM.getStyle({element:this.shoutboxContainer,rule:"display"});this.owner=new i();this.messages=xRTML.Templating.observable([]);this.users=xRTML.Templating.observable([]);if(j.userData){this.owner.id=j.userData.id;this.owner.name(j.userData.name);this.owner.logged(true);this.users.push(this.owner);this.fire({sendMessage:{action:"userLogin",data:{id:this.owner.id,name:this.owner.name(),logged:true}}})}this.messageContent=xRTML.Templating.observable("");this.logIn=function(){if(this.owner.name()!=""&&this.owner.name()!="Write a username..."){var m=xRTML.Common.Util.guidGenerator();this.owner.id=m;this.owner.logged(true);this.users.push(this.owner);xRTML.Common.Cookie.setCookie({name:g,value:xRTML.JSON.stringify({id:this.owner.id,name:this.owner.name()})});if(a){a.fire({userLogin:{user:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}})}this.fire({sendMessage:{action:"userLogin",data:{id:this.owner.id,name:this.owner.name(),logged:true}}})}return true};this.logOut=function(m){this.owner.logged(false);xRTML.Common.Cookie.deleteCookie({name:g});if(a){a.fire({userLogout:{user:this.owner}})}this.fire({sendMessage:{action:"userLogout",data:{id:this.owner.id}}});this.owner.name("Write a username...");return true};this.getUserById=function(o){var n=this.users();for(var m=0;m<n.length;++m){if(n[m].id==o){return n[m]}}return null};this.newUser=function(n){var m=this.getUserById(n.id);if(m!=null){m=new i(n)}else{this.users.push(new i(n))}};this.removeUser=function(m){this.users.remove(function(n){return n.id==m})};this.usersTyping=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){var o="";var p=this.users();if(p.length==0){return""}for(var n=0;n<p.length;n++){var m=p[n];if(m.id!=this.owner.id&&m.isTyping()){o+=m.name()+", "}}return o!=""?o.slice(0,o.length-2):""},this));this.newMessage=function(n){this.messages.push(n);if(xRTML.Common.DOM.getStyle({element:this.shoutboxContainer,rule:"display"})=="none"){this.show()}};this.sendMessage=function(m){if(this.messageContent().length>0){var n=new c({name:m.name||this.owner.name(),content:m.content||this.messageContent()});this.newMessage(n);this.fire({sendMessage:{action:"post",data:n}});if(a){a.fire({messagePost:{message:{user:this.owner,content:n}}})}this.messageContent("")}};var k=false;this.sendTypingMessage=function(){if(k!=this.owner.isTyping()){k=!k;this.fire({sendMessage:{action:"typing",data:{id:this.owner.id,name:this.owner.name(),logged:true,typing:this.owner.isTyping()}}})}};this.getUserIndexById=function(o){var n=this.users();for(var m=0;m<n.length;++m){if(n[m].id==o){return m}}};this.setUserTyping=function(n){var m=this.getUserById(n.id);if(m){m.isTyping(n.typing)}};this.close=function(){this.shoutboxContainer.style.display="none";this.fire({close:{}});return true};this.show=function(){this.shoutboxContainer.style.display=l;this.fire({show:{}})}},h=function(){var j;var m;var k=null;var l;return{init:function(p,q,r,o,n){m=parseInt(q());j=o.owner;l=o;xRTML.Event.bind(p,{keypress:function(w){var t=w?w:event;var v=t.srcElement?t.srcElement:t.target;var u=t.keyCode?t.keyCode:t.which?t.which:t.charCode;if(u==13){l.sendMessage({name:j.name(),content:l.messageContent()});j.isTyping(false);clearTimeout(k);l.sendTypingMessage();return true}j.isTyping(true);if(k!=null){clearTimeout(k)}k=setTimeout(function(){j.isTyping(false);k=null;l.sendTypingMessage()},m);return true},keydown:function(w){var t=w?w:event;var u=t.keyCode?t.keyCode:t.which?t.which:t.charCode;var v=t.srcElement?t.srcElement:t.target;if(u==8||u==46){j.isTyping(l.messageContent().length>0);if(k!=null){clearTimeout(k)}k=setTimeout(function(){j.isTyping(false);k=null},m)}return true},keyup:function(w){var t=w?w:event;var u=t.keyCode?t.keyCode:t.which?t.which:t.charCode;var v=t.srcElement?t.srcElement:t.target;l.messageContent(v.value.replace(/[\n\r\t]/g,""));if(u==8||u==46){j.isTyping(l.messageContent().length>0);if(k!=null){clearTimeout(k);k=null}k=setTimeout(function(){j.isTyping(false);k=null},m)}l.sendTypingMessage();return true}})}}},d=function(j){xRTML.Event.extend(this);var l=xRTML.StorageManager.getById(j.id),k=j.key;this.getAndUpdateUsers=function(){l.get({namespace:"Shoutbox",k:k+"#usersCount"},function(m){if(Number(m.data.resultData)){var o=[];for(var n=1;n<=Number(m.data.resultData);n++){o.push(k+"#users#"+n)}l.get({namespace:"Shoutbox",ks:o},function(q){if(q.data.resultData){for(var r=0,p=q.data.resultData.length;r<p;r++){if(q.data.resultData[r]!=null){b.newUser(xRTML.JSON.parse(q.data.resultData[r]))}}}})}})};this.getAndUpdateMessages=function(){l.get({namespace:"Shoutbox",k:k+"#messagesCount"},function(m){if(m.data.resultData){var o=[];for(var n=1;n<=Number(m.data.resultData);n++){o.push(k+"#messages#"+n)}l.get({namespace:"Shoutbox",ks:o},function(q){if(q.data.resultData){for(var r=0,p=q.data.resultData.length;r<p;r++){b.newMessage(new c(xRTML.JSON.parse(q.data.resultData[r]).content))}}})}})};this.addUser=function(m){l.incr({namespace:"Shoutbox",pair:{k:k+"#usersCount",v:1}},function(n){l.set({namespace:"Shoutbox",pair:{k:k+"#users#"+n.data.resultData,v:xRTML.JSON.stringify(m)}},function(o){})})};this.removeUser=function(m){l.get({namespace:"Shoutbox",k:k+"#usersCount"},function(n){l.del({namespace:"Shoutbox",k:k+"#users#"+(b.getUserIndexById(m)+1)},function(o){})})};this.addMessage=function(m){l.incr({namespace:"Shoutbox",pair:{k:k+"#messagesCount",v:1}},function(n){l.set({namespace:"Shoutbox",pair:{k:k+"#messages#"+n.data.resultData,v:xRTML.JSON.stringify(m)}},function(o){})})}},b,g,a;this.init=function(j){this._super(j);xRTML.Templating.bindingHandlers.userTypingBinding=new h();this.template=j.attribute("template");if(!this.template){var m=' <div class="xRTML-Shoutbox">';m+='        <div class="xRTML-Shoutbox-Close" data-bind="click: close">X</div>';m+='        <div class="xRTML-Shoutbox-NotificationContainer" data-bind="visible: usersTyping().length > 0">';m+='            <span class="xRTML-Shoutbox-NotificationContainer-UsersTypingLabel">Users typing: </span>';m+='            <span class="xRTML-Shoutbox-NotificationContainer-UsersTyping" data-bind="text: usersTyping()"></span>';m+="        </div>";m+='        <div class="xRTML-Shoutbox-ShoutsContainer" data-bind="template: { name: \'xrtml-shouts-template\', foreach: messages }"></div>';m+='        <div class="xRTML-Shoutbox-LogInForm" data-bind="visible: !owner.logged()">';m+='            <input class="xRTML-Shoutbox-LogInForm-UserName" type="text" data-bind="value: owner.name"></input>';m+='            <input class="xRTML-Shoutbox-LogInForm-LogIn" type="button" value="Log In" data-bind="click: logIn"></input>';m+="        </div>";m+='        <div class="xRTML-Shoutbox-ShoutForm" data-bind="visible: owner.logged()">';m+='            <label class="xRTML-Shoutbox-ShoutForm-UserNameLabel" data-bind="text: owner.name()"></label>';m+='            <textarea class="xRTML-Shoutbox-ShoutForm-ShoutContent" data-bind="value: messageContent, userTypingBinding: 3000 " rows="1" cols="50"></textarea>';m+='            <input class="xRTML-Shoutbox-ShoutForm-Send" type="button" value="Send" data-bind="click: sendMessage"></input>';m+='            <input class="xRTML-Shoutbox-ShoutForm-LogOut" type="button" value="Log Out" data-bind="click: logOut"></input>';m+="        </div>";m+="    </div>";var o='   <p class="xRTML-Shoutbox-Shout">';o+='          <strong class="xRTML-Shoutbox-Shout-UserName" data-bind="text: name"></strong>';o+='          <span class="xRTML-Shoutbox-Shout-Message" data-bind="text: content"></span>';o+="      <p>";xRTML.Templating.inject({id:"xrtml-shoutbox-template",content:m});xRTML.Templating.inject({id:"xrtml-shouts-template",content:o});this.template="xrtml-shoutbox-template"}this.storageId=j.attribute("storageid");this.storageKey=j.attribute("storagekey");if(this.storageId&&this.storageKey){a=new d({id:this.storageId,key:this.storageKey});a.bind({requestData:function(){a.getAndUpdateUsers();a.getAndUpdateMessages()},messagePost:xRTML.Common.Function.proxy(function(q){a.addMessage(q.message);this.fire({sendMessage:{action:"post",data:q.message}});this.fire({messagePost:{message:q.message.content}})},this),userLogin:function(q){a.addUser(q.user)},userLogout:function(q){a.removeUser(q.user.id)}});this.bind({postinit:function(){a.fire({requestData:{}})}})}else{xRTML.Console.warn("Tag "+this.name+" "+this.id+": Storage was not configured. The data will not be persistent.")}var p=xRTML.Common.Function.parse;this.bind({message:p(j.attribute("onMessage")),messagePost:p(j.attribute("onMessagePost")),userLogin:p(j.attribute("onUserLogin")),userLogout:p(j.attribute("onUserLogout")),userTyping:p(j.attribute("onUserTyping")),close:p(j.attribute("onClose")),show:p(j.attribute("onShow"))});g=(function(q){for(var r=0;r<this.triggers.length;++r){q+="_"+this.triggers[r].name}return q}).call(this,"xRTMLShoutBox");var l=xRTML.Common.Cookie.getCookie({name:g});var k={shoutboxContainer:this.target[0]};if(l){k.userData=xRTML.JSON.parse(l)}b=new f(k);b.bind({close:xRTML.Common.Function.proxy(function(){this.fire({close:{}})},this),show:xRTML.Common.Function.proxy(function(){this.fire({show:{}})},this),sendMessage:xRTML.Common.Function.proxy(function(q){this.sendMessage(q)},this)});try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,data:b}}})}catch(n){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:n.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.post=function(k){try{b.newMessage(new c(k))}catch(j){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:j.message,className:"xRTML.Tags."+this.name,methodName:"post"}})}this.fire({message:k})};this.userLogin=function(l){var j=new i(l);try{b.newUser(j)}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:k.message,className:"xRTML.Tags."+this.name,methodName:"login"}})}this.fire({userLogin:{user:{id:j.id,isTyping:j.isTyping(),logged:j.logged(),name:j.name()}}})};this.userLogout=function(l){var j=b.getUserById(l.id);try{b.removeUser(l.id)}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:k.message,className:"xRTML.Tags."+this.name,methodName:"logout"}})}this.fire({userLogout:{user:{id:j.id,isTyping:j.isTyping(),logged:j.logged(),name:j.name()}}})};this.typing=function(l){var j=b.getUserById(l.id);if(j==null){b.newUser({id:l.id,name:l.name,logged:true})}try{b.setUserTyping(l)}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:k.message,className:"xRTML.Tags."+this.name,methodName:"typing"}})}var j=b.getUserById(l.id);this.fire({userTyping:{user:{id:j.id,isTyping:j.isTyping(),logged:j.logged(),name:j.name()}}})};this.login=function(j){if(!b.owner||(b.owner&&b.owner.logged())){return}b.owner.id=j.id;b.owner.name(j.name);b.owner.logged(true);b.users.push(b.owner);xRTML.Common.Cookie.setCookie({name:g,value:xRTML.JSON.stringify({id:b.owner.id,name:b.owner.name()})});b.fire({sendMessage:{action:"userLogin",data:{id:b.owner.id,name:b.owner.name(),logged:true}}});return};this.logout=function(){if(!b.owner||(b.owner&&!b.owner.logged())){return}b.owner.logged(false);xRTML.Common.Cookie.deleteCookie({name:g});if(a){a.fire({userLogout:{user:b.owner}})}b.fire({sendMessage:{action:"userLogout",data:{id:b.owner.id}}});b.owner.name("Write a username...");return}}});xRTML.TagManager.register({name:"Toast",struct:function(){var a=function(d){var f=(function(){var i={};i.box=function(){var o,l,k,q,n,r=0;return{show:function(j){n={opacity:70,close:1,animate:1,fixed:1,mask:1,maskid:"",boxid:"",topsplit:2,url:0,post:0,height:0,width:0,html:0,iframe:0};for(s in j){n[s]=j[s]}if(!r){o=document.createElement("div");o.className="xRTML-Toast-Banner";r=document.createElement("div");r.className="xRTML-Toast-Banner-Loading";k=document.createElement("div");k.className="xRTML-Toast-Banner-Content";l=document.createElement("div");l.className="xRTML-Toast-Banner-Mask";q=document.createElement("div");q.className="xRTML-Toast-Banner-Close";q.v=0;document.body.appendChild(l);document.body.appendChild(o);o.appendChild(r);r.appendChild(k);l.onclick=q.onclick=i.box.hide;window.onresize=i.box.resize}else{o.style.display="none";clearTimeout(r.ah);if(q.v){r.removeChild(q);q.v=0}}r.id=n.boxid;l.id=n.maskid;o.style.position=n.fixed?"fixed":"absolute";if(n.html&&!n.animate){r.style.backgroundImage="none";k.innerHTML=n.html;k.style.display="";r.style.width=n.width?n.width+"px":"auto";r.style.height=n.height?n.height+"px":"auto"}else{k.style.display="none";if(!n.animate&&n.width&&n.height){r.style.width=n.width+"px";r.style.height=n.height+"px"}else{r.style.width=r.style.height="100px"}}if(n.mask){this.mask();this.alpha(l,1,n.opacity)}else{this.alpha(o,1,100)}if(n.autohide){r.ah=setTimeout(i.box.hide,1000*n.autohide)}else{document.onkeyup=i.box.esc}},fill:function(A,v,t,p,m,z){if(v){if(n.image){var y=new Image();y.onload=function(){m=m||y.width;z=z||y.height;i.box.psh(y,p,m,z)};y.src=n.image}else{if(n.iframe){this.psh('<iframe src="'+n.iframe+'" width="'+n.width+'" frameborder="0" height="'+n.height+'"></iframe>',p,m,z)}else{var j=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");j.onreadystatechange=function(){if(j.readyState==4&&j.status==200){r.style.backgroundImage="";i.box.psh(j.responseText,p,m,z)}};if(t){j.open("POST",A,true);j.setRequestHeader("Content-type","application/x-www-form-urlencoded");j.send(t)}else{j.open("GET",A,true);j.send(null)}}}}else{this.psh(A,p,m,z)}},psh:function(v,p,m,t){if(typeof v=="object"){k.appendChild(v)}else{k.innerHTML=v}var j=r.style.width,u=r.style.height;if(!m||!t){r.style.width=m?m+"px":"";r.style.height=t?t+"px":"";k.style.display="";if(!t){t=parseInt(k.offsetHeight)}if(!m){m=parseInt(k.offsetWidth)}k.style.display="none"}r.style.width=j;r.style.height=u;this.size(m,t,p)},esc:function(j){j=j||window.event;if(j.keyCode==27){i.box.hide()}},hide:function(){if(xRTML.Sizzle("#xrtml-video-ytplayer").length>0){swfobject.removeSWF("xrtml-video-ytplayer")}i.box.alpha(o,-1,0,3);document.onkeypress=null;if(n.closejs){n.closejs()}xRTML.Sizzle(".xRTML-Toast-Banner")[0].parentNode.removeChild(xRTML.Sizzle(".xRTML-Toast-Banner")[0]);xRTML.Sizzle(".xRTML-Toast-Banner-Mask")[0].parentNode.removeChild(xRTML.Sizzle(".xRTML-Toast-Banner-Mask")[0])},resize:function(){i.box.pos();i.box.mask()},mask:function(){l.style.height=this.total(1)+"px";l.style.width=this.total(0)+"px"},pos:function(){var j;if(typeof n.top!="undefined"){j=n.top}else{j=(this.height()/n.topsplit)-(o.offsetHeight/2);j=j<20?20:j}if(!n.fixed&&!n.top){j+=this.top()}o.style.top=j+"px";o.style.left=typeof n.left!="undefined"?n.left+"px":(this.width()/2)-(o.offsetWidth/2)+"px"},alpha:function(m,p,j){clearInterval(m.ai);if(p){m.style.opacity=0;m.style.filter="alpha(opacity=0)";m.style.display="block";i.box.pos()}m.ai=setInterval(function(){i.box.ta(m,j,p)},20)},ta:function(m,j,t){var p=Math.round(m.style.opacity*100);if(p==j){clearInterval(m.ai);if(t==-1){m.style.display="none";m==o?i.box.alpha(l,-1,0,2):k.innerHTML=r.style.backgroundImage=""}else{if(m==l){this.alpha(o,1,100)}else{o.style.filter="";i.box.fill(n.html||n.url,n.url||n.iframe||n.image,n.post,n.animate,n.width,n.height)}}}else{var u=j-Math.floor(Math.abs(j-p)*0.5)*t;m.style.opacity=u/100;m.style.filter="alpha(opacity="+u+")"}},size:function(m,t,j){if(j){clearInterval(r.si);var p=parseInt(r.style.width)>m?-1:1,u=parseInt(r.style.height)>t?-1:1;r.si=setInterval(function(){i.box.ts(m,p,t,u)},20)}else{r.style.backgroundImage="none";if(n.close){r.appendChild(q);q.v=1}r.style.width=m+"px";r.style.height=t+"px";k.style.display="";this.pos();if(n.openjs){n.openjs()}}},ts:function(m,u,t,v){var j=parseInt(r.style.width),p=parseInt(r.style.height);if(j==m&&p==t){clearInterval(r.si);r.style.backgroundImage="none";k.style.display="block";if(n.close){r.appendChild(q);q.v=1}if(n.openjs){n.openjs()}}else{if(j!=m){r.style.width=(m-Math.floor(Math.abs(m-j)*0.6)*u)+"px"}if(p!=t){r.style.height=(t-Math.floor(Math.abs(t-p)*0.6)*v)+"px"}this.pos()}},top:function(){return document.documentElement.scrollTop||document.body.scrollTop},width:function(){return self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},height:function(){return self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},total:function(p){var j=document.body,m=document.documentElement;return p?Math.max(Math.max(j.scrollHeight,m.scrollHeight),Math.max(j.clientHeight,m.clientHeight)):Math.max(Math.max(j.scrollWidth,m.scrollWidth),Math.max(j.clientWidth,m.clientWidth))}}}();xRTML.Event.extend(this);var g=function(j){tyniboxObj={autohide:j.bannerAutoHide,animate:true,openjs:function(m){b.bannerActive=true;b.fire({bannerDisplay:{target:j}})},closejs:function(){b.bannerActive=false;b.fire({bannerClose:{target:j}})}};if(j.bannerWidth){tyniboxObj.width=j.bannerWidth}if(j.bannerHeight){tyniboxObj.height=j.bannerHeight}switch(j.bannerType){default:case"image":tyniboxObj.image=j.bannerUrl;break;case"html":tyniboxObj.html=j.bannerContent;break;case"iframe":tyniboxObj.iframe=j.bannerUrl;case"flash":var l='<object type="application/x-shockwave-flash" data="'+j.bannerUrl+'"';if(j.bannerWidth){l+='width="'+j.bannerWidth+'"'}if(j.bannerHeight){l+='height="'+j.bannerHeight+'"'}l+='><param name="movie" value="'+j.bannerUrl+'" />';l+="</object>";tyniboxObj.html=l;break;case"video":if(typeof j.bannerSource!="undefined"){if(xRTML.Common.Array.contains({items:xRTML.TagManager.getClasses(),obj:"Video"})){var l='<div id="xRTML-Toast-Banner-'+j.id+'" ';var k="";if(j.bannerWidth){k+="width:"+j.bannerWidth+"px;"}else{k+="width: 400px;"}if(j.bannerHeight){k+="height:"+j.bannerHeight+"px;"}else{k+="height: 400px;"}if(k!=""){l+='style="'+k+'"'}l+="></div>";tyniboxObj.html=l;tyniboxObj.openjs=xRTML.Common.Function.proxy(function(){var n={name:"Video",controlsBar:false,target:"#xRTML-Toast-Banner-"+this.id,width:this.bannerWidth||400,height:this.bannerHeight||400,keepRatio:false};var m=xRTML.TagManager.create(n);m.play(j.bannerSource);b.fire({bannerDisplay:{target:j}})},j)}else{xRTML.Console.error("The xRTML video tag must be added in order to create video banners.")}}break}i.box.show(tyniboxObj)};var h=function(){i.box.hide()};return{show:g,hide:h}})();this.id=xRTML.Common.Util.idGenerator();this.title=d.title;this.text=d.text;this.displayToast=d.displayToast;this.displayBanner=d.displayBanner;this.timeToLive=d.timeToLive;this.bannerType=d.bannerType;this.bannerUrl=d.bannerUrl;this.bannerContent=d.bannerContent;this.bannerWidth=d.bannerWidth;this.bannerHeight=d.bannerHeight;this.bannerAutoHide=d.bannerAutoHide;this.destinationUrl=d.destinationUrl;this.bannerSource=d.bannerSource;this.metaData=d.metaData;this.close=function(g){if(typeof g!="boolean"){b.destroy(this,false)}else{b.destroy(this,g)}clearTimeout(this.timeoutReference)};this.showBanner=function(){if(this.displayToast){this.close(false)}if(this.displayBanner){f.show(this)}else{this.openUrl()}};if(this.displayToast){this.timeoutReference=setTimeout(xRTML.Common.Function.proxy(function(){this.close(true)},this),this.timeToLive)}this.openUrl=function(){if(this.destinationUrl){window.open(this.destinationUrl,"_blank");b.fire({urlOpen:{target:this}})}}};var c=function(){xRTML.Event.extend(this);this.toasts=xRTML.Templating.observable(new Array());this.create=function(f){var d=new a(f);if(f.displayToast){if(f.index=="end"){this.toasts.push(d)}else{this.toasts.splice(0,0,d)}this.fire({toastDisplay:{target:d}})}else{d.showBanner()}};this.destroy=function(d,f){this.toasts.remove(d);this.fire({toastClose:{target:d,closedByTimeOut:!!f}})};this.bannerActive=false};var b=null;this.init=function(d){this._super(d);this.positionAt=d.attribute("positionAt");this.mediaUrls=d.attribute("mediaUrls");if(typeof this.mediaUrls!="undefined"){if(xRTML.Common.Array.contains({items:xRTML.TagManager.getClasses(),obj:"Audio"})){this.audioNotificationTag=xRTML.TagManager.create({name:"Audio",controlsbar:false})}else{xRTML.Console.error("The xRTML Audio tag must be added in order to play audio notifications.")}}this.effects=d.attribute("effects");xRTML.Effect.extend(this);b=new c();this.toastContainer;if(this.target[0].tagName=="BODY"){this.toastContainer=document.createElement("div");this.toastContainer.setAttribute("id","xRTML-Toast-target");document.body.appendChild(this.toastContainer)}else{this.toastContainer=this.target[0]}this.template=d.attribute("template");if(!this.template){var g=' <div class="xRTML-Toast" data-bind="attr: { id: id }">';g+='        <div class="xRTML-Toast-Close" data-bind="click: close">X</div>';g+='        <div class="xRTML-Toast-Content" data-bind="click: showBanner">';g+='            <h3 class="xRTML-Toast-Content-Title" data-bind="text: title"></h3>';g+='            <span class="xRTML-Toast-Content-Message" data-bind="text: text"></span>';g+="        </div>";g+="    </div>";xRTML.Templating.inject({id:"xRTML-Toast-Template",content:g});this.template="xRTML-Toast-Template"}try{xRTML.Templating.applyBindings({node:this.toastContainer,binding:{template:{name:this.template,foreach:b.toasts,afterRender:xRTML.Common.Function.proxy(function(l,k){for(var j=0;j<l.length;j++){if(l[j].nodeName!="#text"){this.runEffects({element:l[j]})}}},this)}}})}catch(h){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:h.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}var f=(function(k){var j=k.toastContainer;j.style.position="fixed";switch(k.positionAt){case"topleft":j.style.top=15+"px";j.style.left=15+"px";break;case"topright":j.style.top=15+"px";j.style.right=15+"px";break;case"bottomleft":j.style.bottom=30+"px";j.style.left=15+"px";break;case"bottomright":default:j.style.bottom=30+"px";j.style.right=15+"px";break}})(this);var i=xRTML.Common.Function.parse;this.bind({toastDisplay:i(d.attribute("onToastDisplay")),toastClose:i(d.attribute("onToastClose")),bannerDisplay:i(d.attribute("onBannerDisplay")),bannerClose:i(d.attribute("onBannerClose")),urlOpen:i(d.attribute("onUrlOpen"))});b.bind({toastDisplay:xRTML.Common.Function.proxy(function(j){this.fire({toastDisplay:{target:j}})},this),toastClose:xRTML.Common.Function.proxy(function(j){this.fire({toastClose:{target:j}})},this),bannerDisplay:xRTML.Common.Function.proxy(function(j){this.fire({bannerDisplay:{target:j}})},this),bannerClose:xRTML.Common.Function.proxy(function(j){this.fire({bannerClose:{target:j}})},this),urlOpen:xRTML.Common.Function.proxy(function(j){this.fire({urlOpen:{target:j}})},this)})};this.process=function(h){var d={title:h.title,text:h.text,destinationUrl:typeof h.destinationUrl!="undefined"?h.destinationUrl:false,timeToLive:h.timeToLive||10000,displayToast:typeof h.displayToast!="undefined"?h.displayToast:true,displayBanner:typeof h.displayBanner!="undefined"?h.displayBanner:true,metaData:h.metaData,bannerUrl:h.bannerUrl,bannerContent:h.bannerContent,bannerType:h.bannerType,bannerSource:h.bannerSource,bannerHeight:xRTML.Common.Converter.toNumber(h.bannerHeight),bannerWidth:xRTML.Common.Converter.toNumber(h.bannerWidth),bannerAutoHide:typeof h.bannerAutoHide!="undefined"?xRTML.Common.Converter.toNumber(h.bannerAutoHide):false};if(this.positionAt=="topleft"||this.positionAt=="topright"){d.index="begin"}else{d.index="end"}if(b.bannerActive){var g=xRTML.Common.Function.proxy(function(){this.unbind({bannerClose:g});this.process(h)},this);this.bind({bannerClose:g})}else{try{b.create(d)}catch(f){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:f.message,className:"xRTML.Tags."+this.name,methodName:"process"}})}if(typeof this.audioNotificationTag!="undefined"){this.audioNotificationTag.play({source:this.mediaUrls})}}}}});xRTML.TagManager.register({name:"Video",base:"Media",struct:function(){this.init=function(a){this.poster=a.attribute("poster")||null;this.keepRatio=xRTML.Common.Converter.toBoolean(a.attribute("keepRatio"));if(typeof this.keepRatio=="undefined"){this.keepRatio=true}a.type="video";a.formats={mp4:"video/mp4",ogg:"video/ogg",webm:"video/webm",avi:"video/divx"};a.keepratio=this.keepRatio;a.poster=this.poster;this._super(a);xRTML.Common.Validator.validateRequired({target:this,prop:"type"});xRTML.Common.Validator.validateRequired({target:this,prop:"formats"});var b=this;this.players.yt=function(d){xRTML.Event.extend(this);this.id=xRTML.Common.Util.idGenerator();this.config=d;this.supportedMedia={yt:true};this.player=null;var c=this;window.onYouTubePlayerReady=function(g){c.player=document.getElementById("xrtml-video-ytplayer");c.player.addEventListener("onStateChange","onYouTubePlayerStateChange");b.dispatchEvent("onYouTubePlayerReady",{playerId:g})};function f(g){b.fire({loadedmetadata:{event:g,target:c}})}this.bind({loadedmetadata:f});window.onYouTubePlayerStateChange=function(g){switch(g){case -1:b.dispatchEvent("unstarted");break;case 0:b.dispatchEvent("ended");break;case 1:b.dispatchEvent("playing");break;case 2:b.dispatchEvent("paused");break;case 3:b.dispatchEvent("buffering");break;case 5:b.dispatchEvent("videocued");break}}};this.players.yt.prototype={play:function(f){f.files.yt=f.files.yt.replace(/^[^v]+v.(.{11}).*/,"$1");var g="?autoplay="+(!!this.config.autoplay||!!f.autoplay?"1":"0");g+="&loop="+(!!this.config.loop||!!f.loop?"1":"0");g+="&controls="+(!!this.config.controls||!!f.controls?"1":"0");g+="&enablejsapi=1&playerapiid=ytplayer&version=3";if(typeof swfobject==="undefined"){xRTML.Common.DOM.loadScript({url:"http://code.xrtml.org/plugins/swfobject.js",callback:xRTML.Common.Function.proxy(function(){swfobject.removeSWF("xrtml-video-ytplayer");var i=document.createElement("span");i.id=this.id;b.target.appendChild(i);var h=xRTML.Common.Function.proxy(function(j){this.fire({loadedmetadata:j})},this);swfobject.embedSWF("http://www.youtube.com/v/"+f.files.yt+g,this.id,!!this.config.width?this.config.width:"425",!!this.config.height?this.config.height:"356","8",null,null,{allowScriptAccess:"always"},{id:"xrtml-video-ytplayer"},h)},this)})}else{swfobject.removeSWF("xrtml-video-ytplayer");var d=document.createElement("span");d.id=this.id;b.target.appendChild(d);var c=xRTML.Common.Function.proxy(function(h){this.fire({loadedmetadata:h})},this);swfobject.embedSWF("http://www.youtube.com/v/"+f.files.yt+g,this.id,!!this.config.width?this.config.width:"425",!!this.config.height?this.config.height:"356","8",null,null,{allowScriptAccess:"always"},{id:"xrtml-video-ytplayer"},c)}},stop:function(){if(!this.isPlaying()){return}this.player.stopVideo()},pause:function(){this.isPlaying()?this.player.pauseVideo():this.player.playVideo()},restart:function(){this.player.playVideo()},skip:function(c){this.player.seekTo(c,true)},mute:function(){this.player.isMuted()?this.player.unMute():this.player.mute()},volume:function(c){this.player.setVolume(c)},isPlaying:function(){if(this.player.getPlayerState){return this.player!=null&&this.player.getPlayerState()==1}return true},canPlayExtension:function(){},canPlayType:function(c){return c==="yt"},time:function(){return{current:this.player.getCurrentTime(),duration:this.player.getDuration()}},offset:function(){}}}}});